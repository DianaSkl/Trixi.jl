using OrdinaryDiffEq
using Trixi
using Plots

tau = 0.0001
equations = PerturbationMomentSystem1D(0.0, 1.0, tau)

initial_condition = initial_condition_constant
surface_flux = flux_lax_friedrichs

boundary_condition = BoundaryConditionDirichlet(initial_condition)
boundary_conditions = (x_neg=boundary_condition, x_pos=boundary_condition)
volume_flux  = flux_lax_friedrichs
basis = LobattoLegendreBasis(3)
shock_indicator_variable = density_pressure
indicator_sc = IndicatorHennemannGassner(equations, basis,
                                         alpha_max=0.5,
                                         alpha_min=0.001,
                                         alpha_smooth=true,
                                         variable=shock_indicator_variable)
volume_integral = VolumeIntegralShockCapturingHG(indicator_sc;
                                                 volume_flux_dg=volume_flux,
                                                 volume_flux_fv=surface_flux)
solver = DGSEM(basis, surface_flux, volume_integral)
coordinates_min = (-1.0,)
coordinates_max = ( 1.0,)

mesh = TreeMesh(coordinates_min, coordinates_max, initial_refinement_level=7, n_cells_max=10_000, periodicity=false)
semi = SemidiscretizationHyperbolic(mesh, equations, initial_condition, solver, boundary_conditions=boundary_conditions, source_terms=source_terms_convergence_test)

t = 0.4
tspan = (0.0, t)
ode = semidiscretize(semi, tspan)

# At the beginning of the main loop, the SummaryCallback prints a summary of the simulation setup
# and resets the timers
summary_callback = SummaryCallback()

analysis_interval = 100

# The AnalysisCallback allows to analyse the solution in regular intervals and prints the results
analysis_callback = AnalysisCallback(semi, interval=100)
alive_callback = AliveCallback(analysis_interval=analysis_interval)


# The SaveSolutionCallback allows to save the solution to a file in regular intervals
save_solution = SaveSolutionCallback(interval=100,solution_variables=cons2prim)

# The StepsizeCallback handles the re-calculcation of the maximum Î”t after each time step
#stepsize_callback = StepsizeCallback(cfl=0.9)

save_restart = SaveRestartCallback(interval=100,save_final_restart=true)

# Create a CallbackSet to collect all callbacks such that they can be passed to the ODE solver
callbacks = CallbackSet(summary_callback, analysis_callback, alive_callback, save_solution, save_restart)



###############################################################################
# run the simulation

sol = solve(ode, SSPRK43(), save_everystep=false, callback=callbacks);

euler = [3.0, 3.0000000000000004, 2.9999999999999996, 2.9999999999999996, 3.0, 2.9999999999999996, 3.0, 3.0, 3.0, 3.0000000000000004, 2.9999999999999996, 2.9999999999999996, 3.0, 2.9999999999999996, 3.0, 3.0, 3.0, 3.0000000000000004, 2.9999999999999996, 2.9999999999999996, 3.0, 2.9999999999999996, 3.0, 3.0, 3.0, 3.0000000000000004, 2.9999999999999996, 2.9999999999999996, 3.0, 2.9999999999999996, 3.0, 3.0, 3.0, 3.0000000000000004, 2.9999999999999996, 2.9999999999999996, 3.0, 2.9999999999999996, 3.0, 3.0, 3.0, 3.0000000000000004, 2.9999999999999996, 2.9999999999999996, 3.0, 2.9999999999999996, 3.0, 3.0, 3.0, 3.0000000000000004, 2.9999999999999996, 2.9999999999999996, 3.0, 2.9999999999999996, 3.0, 3.0, 3.0, 3.0000000000000004, 2.9999999999999996, 2.9999999999999996, 3.0, 2.9999999999999996, 3.0, 3.0, 3.0, 3.0000000000000004, 2.9999999999999996, 2.9999999999999996, 3.0, 2.9999999999999996, 3.0, 3.0, 2.9999999999999996, 2.9999999999999996, 2.9999999999999987, 2.9999999999999982, 2.9999999999999982, 2.9999999999999973, 2.9999999999999973, 2.999999999999996, 2.999999999999995, 2.999999999999994, 2.9999999999999916, 2.9999999999999885, 2.9999999999999827, 2.999999999999973, 2.9999999999999596, 2.99999999999994, 2.9999999999999236, 2.9999999999998996, 2.999999999999857, 2.9999999999997744, 2.9999999999996327, 2.999999999999409, 2.9999999999990843, 2.999999999998637, 2.999999999998262, 2.9999999999977014, 2.999999999996711, 2.999999999994877, 2.999999999991785, 2.999999999987019, 2.999999999980163, 2.9999999999708025, 2.999999999963183, 2.999999999951526, 2.99999999993139, 2.999999999895617, 2.9999999998370495, 2.999999999748526, 2.9999999996228888, 2.9999999994529785, 2.9999999993196385, 2.9999999991119357, 2.9999999987614108, 2.999999998165507, 2.999999997221666, 2.9999999958273302, 2.9999999938799427, 2.9999999912769457, 2.9999999893214215, 2.999999986235842, 2.9999999811618685, 2.999999972924599, 2.9999999603491316, 2.9999999422605663, 2.9999999174839997, 2.9999998848445295, 2.999999861567763, 2.9999998246079222, 2.9999997655461477, 2.999999674062587, 2.999999539837388, 2.9999993525506974, 2.999999101882663, 2.999998777513432, 2.9999985596785295, 2.9999982139184893, 2.99999767779185, 2.999996884316163, 2.9999957665089845, 2.999994257387867, 2.9999922899703653, 2.9999897972740306, 2.9999882294644924, 2.999985754367929, 2.999982030317478, 2.9999767467691436, 2.999969593178933, 2.9999602590028505, 2.9999484336969005, 2.99993380671709, 2.999925211787943, 2.9999117579014842, 2.999892094316264, 2.9998652449435097, 2.9998302336944493, 2.9997860844803097, 2.999731821212318, 2.9996664678017013, 2.999630586305583, 2.9995749936003846, 2.9994959395485035, 2.999391634559472, 2.999260289042823, 2.9991001134080864, 2.998909318064795, 2.998686113422479, 2.9985712777983253, 2.998395391787775, 2.9981515350637227, 2.9978393537961994, 2.997458494155234, 2.9970086023108577, 2.9964893244330986, 2.9959003066919867, 2.9956143675294955, 2.9951821002587957, 2.994596146592439, 2.9938650546631034, 2.9929973726034693, 2.992001648546216, 2.9908864306240206, 2.989660266969564, 2.989091846023665, 2.9882460366767827, 2.987120981732721, 2.9857460506378337, 2.9841506128384765, 2.982364037781003, 2.980415694911767, 2.9783349536771224, 2.977399261932134, 2.976034313269634, 2.9742451695230567, 2.972092438895177, 2.96963672958877, 2.96693864980661, 2.964058807751473, 2.9610578116261324, 2.9597282538487484, 2.9578345874650243, 2.9553783754889484, 2.9524548733954945, 2.9491593366596374, 2.94558702075635, 2.9418331811606047, 2.9379930733473754, 2.9362969015102784, 2.933944875543449, 2.9309155834964558, 2.9273351517928186, 2.923329706856052, 2.919025375109676, 2.914548282977206, 2.91002455688216, 2.9080174408623316, 2.905311695876165, 2.901842647757169, 2.8977597286573675, 2.893212370728786, 2.8883500061234475, 2.883322066993376, 2.878277985490594, 2.87602007564214, 2.8730630617083914, 2.8692829436790035, 2.8648443625110627, 2.859911959161654, 2.854650374587863, 2.849224249746775, 2.843798225595475, 2.8413411553462327, 2.8382168677262145, 2.8342308296719128, 2.8295559255392178, 2.8243650396840176, 2.8188310564621992, 2.8131268602296533, 2.8074253353422685, 2.8048085539826033, 2.8015800627036747, 2.797467328474193, 2.792646053717383, 2.78729194085647, 2.781580692314678, 2.7756880105152324, 2.769789597881357, 2.7670414854631074, 2.763754221558552, 2.759572409214812, 2.754670513356806, 2.7492229989094508, 2.7434043307976643, 2.7373889739463637, 2.731351393280467, 2.728491883465183, 2.7251781273422737, 2.7209688613490144, 2.7160343051222022, 2.710544678298633, 2.7046702005151024, 2.698581091408406, 2.6924475706153395, 2.6894907776162027, 2.6861736171474973, 2.681967413496035, 2.6770358847504734, 2.67154274899947, 2.6656517243316813, 2.659526528835764, 2.6533308806003753, 2.650287296442335, 2.6469836935994087, 2.6428037224621956, 2.637902871218066, 2.6324366280543923, 2.6265604811585432, 2.6204299187178908, 2.614200428919804, 2.611078713049351, 2.607801811439987, 2.6036667156682256, 2.5988193305012164, 2.593405560706108, 2.5875713110500493, 2.5814624863001896, 2.575224991223677, 2.5720335196138433, 2.5687944439374646, 2.5647205226299596, 2.559947001816188, 2.5546091276210108, 2.548842146169288, 2.5427813035858784, 2.536561845995643, 2.5333102187176864, 2.5301196138301543, 2.5261226688615137, 2.521443121484624, 2.516204709372345, 2.5105311701975355, 2.5045462416330544, 2.4983736613517613, 2.495074374374405, 2.4919439059881148, 2.488041012202823, 2.483477280123648, 2.478364296855713, 2.4728136495041353, 2.466936925174036, 2.460845710970535, 2.457516206782579, 2.454460225561295, 2.4506716532004282, 2.446249504877742, 2.4412927957710044, 2.4359005410579773, 2.4301717559164273, 2.424205455524118, 2.420870769105597, 2.417908316505127, 2.4142597948084794, 2.4100114881475694, 2.4052496806543138, 2.400060656460629, 2.3945306996984304, 2.388746094499634, 2.3854422560799233, 2.382599519915355, 2.3791249291253793, 2.3750922049485435, 2.370575068623393, 2.365647241388472, 2.3603824444823283, 2.3548543991435054, 2.3516325177261166, 2.3489456252707805, 2.3456899177187585, 2.3419271208477745, 2.3377189604355513, 2.3331271622598133, 2.3282134520982836, 2.323039555728685, 2.31996983572414, 2.317487307985057, 2.3145087673793774, 2.311084946970139, 2.307266579820375, 2.3031043989931193, 2.2986491375514078, 2.293951528558274, 2.291125005475336, 2.2889080440516296, 2.286277651175972, 2.2832749257217393, 2.2799409665623074, 2.2763168725710528, 2.27244374262135, 2.268362675586576, 2.2658861199817446, 2.264003236341269, 2.2617971293590253, 2.2593007001347187, 2.2565468497680543, 2.2535684793587345, 2.2503984900064657, 2.247069782810951, 2.2450475377367436, 2.243559334639667, 2.24184002910975, 2.2399154109295303, 2.237811269881545, 2.2355533957483296, 2.233167578312422, 2.230679607356358, 2.2291799547067725, 2.2281139959121403, 2.226901571109832, 2.2255618566399997, 2.2241140288427994, 2.2225772640583816, 2.220970738626901, 2.2193136288885102, 2.218331871516764, 2.2176592671174484, 2.216907248256462, 2.216088655299542, 2.215216328612425, 2.2143031085608484, 2.2133618355105487, 2.212405349827262, 2.2118525563383726, 2.211487633755973, 2.2110873335000463, 2.2106589681886066, 2.2102098504396688, 2.209747292871245, 2.2092786081013496, 2.2088111087479954, 2.20854792782964, 2.2083795201906122, 2.2081989967005216, 2.208009709097269, 2.207815009118751, 2.2076182485028677, 2.207422778987518, 2.207231952310598, 2.2071256378134985, 2.2070579133235766, 2.2069877553286887, 2.206916289642431, 2.2068446420783983, 2.206773938450186, 2.2067053045713902, 2.206639866255605, 2.206601015653851, 2.2065740551541597, 2.2065477841956147, 2.206522353896556, 2.2064979153753215, 2.206474619750248, 2.206452618139675, 
2.2064320616619404, 2.206415705666559, 2.206401210368227, 2.206388176202128, 2.206376414594968, 2.2063657369734524, 2.2063559547642857, 2.206346879394173, 2.206338322289819, 2.206327056970313, 2.20631467498153, 2.2063039251984735, 2.206294515390686, 
2.206286153327709, 2.206278546779085, 2.2062714035143545, 2.206264431303061, 2.2062530000729974, 2.2062397439126635, 2.2062282137791973, 2.2062180768913278, 2.2062090004677835, 2.206200651727291, 2.20619269788858, 2.206184806170377, 2.206171953449912, 2.2061570914307405, 2.206144080275628, 2.2061325548707083, 2.206122150102116, 2.206112500855986, 2.2061032420184534, 2.206094008475651, 2.206079435547333, 2.20606271034031, 2.206048004203543, 2.2060349144036877, 2.206023038207399, 2.206011972881331, 2.2060013156921396, 2.205990663906478, 2.205974172313043, 2.205955326977034, 2.2059387134767583, 2.205923882809344, 2.2059103859719174, 2.2058977739616044, 2.2058855977755303, 2.205873408410823, 2.205854710739215, 2.2058333818050375, 2.205814546741693, 2.2057976994541333, 2.2057823338473113, 2.2057679438261744, 2.2057540232956763, 2.2057400661607676, 2.205718737533626, 2.2056944125433353, 2.2056729027030446, 2.2056536309526114, 2.2056360202318928, 2.2056194934807447, 2.2056034736390244, 2.2055873836465887, 2.2055628152984283, 2.205534774166648, 2.2055099454769196, 2.2054876619142805, 2.2054672561637667, 2.2054480609104137, 2.2054294088392576, 2.2054106326353344, 2.2053819195327433, 2.205349086809226, 2.2053199657898688, 2.20529376589943, 
2.205269696562666, 2.2052469672043338, 2.2052247872491915, 2.2052023661219944, 2.2051678700665227, 2.2051282298796435, 2.205092944530573, 2.2050610169212583, 2.2050314499536494, 2.205003246529693, 2.2049754095513396, 2.2049469419205354, 2.2049022307754824, 2.2048500621207308, 2.204803146401232, 2.204759993834341, 2.2047191146374154, 2.20467901902781, 2.2046382172228807, 2.2045952194399834, 2.2045240740780216, 2.2044380597677997, 2.20435899856513, 2.204283893820976, 2.2042097488863, 2.204133567112064, 2.2040523518492314, 2.203963106448764, 2.203805546318413, 2.203607514887376, 2.2034216762646226, 2.2032403831411793, 2.2030559882080754, 2.2028608441563353, 2.202647303676987, 2.202407719461057, 2.2019730721669375, 2.201419520264671, 2.2008976129424145, 2.2003870214052546, 2.199867416858278, 2.199318470506572, 2.1987198535552217, 2.1980512372093144, 2.1968501834880456, 2.1953329746350323, 2.193911859374378, 2.1925373256427587, 2.19115986137685, 2.189729954513327, 2.1881980929888654, 2.18651476474014, 2.183571237615536, 2.179919066905664, 2.1765357777218215, 2.1733159519821093, 2.170154171604627, 2.1669450185074752, 2.163583074608752, 2.159962921826559, 2.153841750696005, 2.1464166471557737, 2.139625051671402, 2.133272956729135, 2.1271663548152224, 2.121111238415909, 2.1149136000174433, 2.1083794321060707, 2.097723680561621, 2.0851224715496666, 2.0737489526772483, 2.0632947139256492, 2.0534513452761556, 2.0439104367100493, 2.034363578208617, 2.024502359753141, 2.008999492191486, 1.991159578895373, 1.9752709492774767, 1.9609102957615177, 1.9476543107712174, 1.9350796867302942, 1.9227631160624703, 1.9102812911914646, 1.8913447845204607, 1.8701586199694367, 1.8515300656114253, 1.8349586309517723, 1.8199438254958227, 1.805985158748922, 1.7925821402164148, 1.7792342794036466, 1.7596529718289147, 1.7383488452972706, 1.7198390409358115, 1.7036146541032304, 1.6891667801582222, 1.6759865144594797, 1.6635649523656975, 1.6513931892355689, 1.6340889297867773, 1.615759028947764, 1.6000076716910012, 1.5863891728829795, 1.5744578473901891, 1.5637680100791198, 1.5538739758162616, 1.5443300594681042, 1.5311591926353592, 1.5175533488737702, 1.5059814804661091, 1.496106022191603, 1.4875894088294788, 1.4800940751589633, 1.4732824559592839, 1.4668169860096665, 1.4581506038377778, 1.449407093646166, 1.4420451103633096, 1.435842696165977, 1.4305778932309385, 1.4260287437349628, 1.4219732898548192, 1.4181895737672765, 1.4132656768735563, 1.4084102815608937, 1.4043636248304208, 1.400998963292895, 1.398189553559073, 1.3958086522397106, 1.3937295159455654, 1.391825401287393, 1.3894225509704066, 1.3871069186200977, 1.3851974289909257, 1.3836315061417253, 1.3823465741313319, 1.3812800570185793, 1.3803693788623024, 1.379551963721336, 1.3785534120339593, 1.3776139003795689, 1.3768478942180769, 1.376228920171282, 1.3757305048609845, 1.375326174908982, 1.374989456937074, 1.3746938775670592, 1.3743454321282662, 1.3740261897878494, 1.3737691846981617, 1.3735649632747724, 1.373404071933252, 1.3732770570891706, 1.3731744651580975, 1.3730868425556026, 1.3729880653491824, 1.3729006392307241, 1.3728314395837684, 1.3727777091903708, 1.3727366908325882, 1.3727056272924751, 1.3726817613520876, 1.3726623357934813, 1.3726422671115925, 1.372625759667812, 1.372613202065213, 1.3726040104891055, 1.372597601124798, 1.372593390157598, 1.372590793772815, 1.3725892281557568, 1.3725887606620435, 1.3725891994318553, 1.3725899045920404, 1.3725908541085423, 1.3725920259473041, 1.3725933980742686, 
1.3725949484553788, 1.3725966550565782, 1.3725993851413374, 1.3726022868857648, 1.372604797793343, 1.372606995109365, 1.372608956079123, 1.3726107579479092, 1.3726124779610165, 1.3726141933637368, 1.3726166689247048, 1.3726191407298067, 1.3726212293025775, 1.3726230087521234, 1.3726245531875514, 1.3726259367179678, 1.372627233452479, 1.3726285175001913, 1.372630359678311, 1.3726321517850995, 1.3726336527666776, 1.372634921912474, 1.3726360185119166, 1.3726370018544334, 1.372637931229452, 1.3726388659264006, 1.3726402294572908, 1.3726415227441973, 1.372642599176679, 1.37264350505767, 1.3726442866901056, 1.3726449903769193, 1.3726456624210466, 1.3726463491254208, 1.3726473837298585, 1.3726483377349505, 1.372649125242762, 1.3726497869742238, 1.3726503636502696, 1.3726508959918298, 1.3726514247198374, 1.3726519905552235, 1.37265285697103, 1.3726536230418103, 1.3726542477684587, 1.3726547648891476, 1.3726552081420484, 1.3726556112653328, 1.3726560079971717, 1.3726564320757373, 1.3726571409606918, 1.3726577504560245, 1.3726582437046182, 1.372658654423, 1.372659016327697, 1.3726593631352362, 1.3726597285621436, 1.372660146324947, 1.3726607509962563, 1.3726611728682199, 1.3726614703582276, 1.3726616701853291, 1.3726617990685763, 1.3726618837270177, 1.3726619508797047, 1.372662027245687, 1.3726622894401204, 1.3726623995006222, 1.3726624594169492, 1.3726624888331826, 1.3726625073934047, 1.372662534741697, 1.3726625905221401, 1.3726626943788165, 1.372662703049902, 1.372662374131829, 1.372661954422634, 1.372661474755665, 1.3726609659642706, 1.3726604588817992, 1.372659984341599, 1.3726595731770175, 1.3726594503076304, 1.3726592507046715, 1.3726591269462916, 1.372659062477753, 1.3726590407443184, 1.37265904519125, 1.3726590592638093, 1.3726590664072595, 1.3726587641356307, 1.372658011546858, 1.372657054505173, 1.3726560115955961, 1.3726550014031476, 1.3726541425128476, 1.3726535535097164, 1.3726533529787743, 1.3726539737006367, 1.3726545689620802, 1.3726547923130747, 1.3726546299423785, 1.3726540680387476, 1.37265309279094, 1.3726516903877122, 1.372649847017822, 1.372646712572078, 1.372642127455195, 1.3726325622625182, 1.3726196199551428, 1.3726049034941665, 1.3725900158406845, 1.372576559955793, 1.372566138800588, 1.372551261895716, 1.3725251174623117, 1.372455735408474, 1.3723539556331639, 1.3722306180353434, 1.372096562513973, 1.3719626289680134, 1.3718396572964258, 1.371672225208321, 1.371374405709323, 1.3707047377366748, 1.369763579252045, 1.3686512882171016, 1.367468222593512, 1.366314740342943, 1.3652911994270636, 1.3641237846687555, 1.3609749481619806, 1.3552885546803988, 1.3477611260054636, 1.3390891839186305, 1.329969250201352, 1.3210978466350833, 1.3131714950012774, 1.3061807157120313, 1.2798374285307834, 1.2495048784957012, 1.2169346187506527, 1.1838782024395058, 1.1520871827061285, 1.1233131126943878, 1.0993075455481522, 1.0781687652968426, 1.052139599313098, 1.0329814628868756, 1.0196093629082705, 1.010938306267378, 1.0058832998542937, 1.0033593505591116, 1.0022814652719274, 1.00160492504363, 1.001023339997524, 1.0006187318333488, 1.0003572478105622, 1.0002050351886242, 1.0001282412269925, 1.000093013185126, 1.0000654983224833, 1.0000391082869526, 1.000022520620152, 1.000011665052692, 1.0000053386015242, 1.0000023382836016, 1.000001461115876, 1.0000015041153, 1.0000012642988259, 1.0000007549864878, 1.0000004661705466, 1.0000002679782534, 1.0000001425318703, 1.0000000719536588, 1.0000000383658796, 1.0000000238907945, 1.0000000106506646, 1.0000000054449618, 1.0000000050518725, 1.0000000043071549, 1.0000000033409722, 1.0000000022834883, 1.000000001264866, 1.0000000004152685, 0.9999999998648591, 0.9999999999647885, 1.0000000000443432, 1.0000000000773945, 1.000000000076601, 1.0000000000546203, 1.000000000024111, 0.99999999999773, 0.9999999999881359, 0.9999999999993642, 1.000000000001875, 1.0000000000027032, 1.000000000002362, 1.0000000000013654, 1.0000000000002263, 0.999999999999458, 0.9999999999995741, 1.0000000000000921, 1.0000000000001077, 1.0000000000000933, 1.0000000000000608, 1.0000000000000229, 0.9999999999999906, 0.9999999999999765, 0.9999999999999921, 1.0000000000000087, 1.0000000000000049, 1.0000000000000022, 1.0000000000000002, 0.999999999999999, 0.9999999999999987, 0.9999999999999989, 0.9999999999999996, 0.9999999999999997, 0.9999999999999997, 0.9999999999999996, 0.9999999999999996, 0.9999999999999997, 0.9999999999999996, 0.9999999999999997, 0.9999999999999996, 0.9999999999999996, 0.9999999999999997, 0.9999999999999998, 0.9999999999999997, 0.9999999999999999, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 1.0, 1.0, 1.0, 1.0, 0.9999999999999998, 0.9999999999999997, 0.9999999999999994, 0.9999999999999994, 0.9999999999999997, 0.9999999999999998, 0.9999999999999998, 1.0, 0.9999999999999998, 0.9999999999999997, 0.9999999999999994, 0.9999999999999994, 0.9999999999999997, 0.9999999999999998, 0.9999999999999998, 1.0, 0.9999999999999998, 0.9999999999999997, 0.9999999999999994, 0.9999999999999994, 0.9999999999999997, 0.9999999999999998, 0.9999999999999997, 1.0, 1.0, 1.0, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 1.0, 0.9999999999999998, 0.9999999999999997, 0.9999999999999994, 0.9999999999999994, 0.9999999999999997, 0.9999999999999998, 0.9999999999999998, 1.0, 0.9999999999999998, 0.9999999999999997, 0.9999999999999994, 0.9999999999999994, 0.9999999999999997, 0.9999999999999998, 0.9999999999999997, 1.0, 1.0, 1.0, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 0.9999999999999999, 0.9999999999999998, 0.9999999999999997, 0.9999999999999996, 0.9999999999999996, 0.9999999999999997, 0.9999999999999998, 0.9999999999999998, 1.0, 0.9999999999999998, 0.9999999999999997, 0.9999999999999994, 0.9999999999999994, 0.9999999999999997, 0.9999999999999998, 0.9999999999999997, 1.0, 1.0, 1.0, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 0.9999999999999997, 0.9999999999999999, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 0.9999999999999998, 1.0, 1.0, 1.0000000000000002, 1.0, 1.0, 1.0, 0.9999999999999998, 0.9999999999999998, 1.0, 1.0, 1.0000000000000002, 1.0, 1.0, 1.0, 0.9999999999999998, 0.9999999999999998, 1.0, 1.0, 1.0000000000000002, 1.0, 1.0, 1.0, 0.9999999999999998]

# Print the timer summary
summary_callback()

pd = PlotData1D(sol; solution_variables=cons2prim)

#rho plot
#plot(pd.x, pd.data[:,1], xlims = (-1.0, 1.0), label = "DGSEM ad. ZV", title ="rho, t = "*string(t)*", tau = "*string(tau)*", B ="*string(1/tau), seriestype = :scatter, markersize=3)
plot(pd.x, pd.data[:,1], xlims = (-1.0, 1.0), label = "DGSEM ad. ZV", title ="rho, t = "*string(t)*", tau = "*string(tau), seriestype = :scatter, markersize=3)
plot!(pd.x, euler, label = "Euler")
#savefig("adaptive2.png")

