# x Anpassen !
# x = [-2.0, -1.9910714285714286, -1.9821428571428572, -1.9732142857142858, -1.9642857142857142, -1.9553571428571428, -1.9464285714285714, -1.9375, -1.9375, -1.9285714285714286, -1.9196428571428572, -1.9107142857142858, -1.9017857142857142, -1.8928571428571428, -1.8839285714285714, -1.875, -1.875, -1.8660714285714286, -1.8571428571428572, -1.8482142857142858, -1.8392857142857142, -1.8303571428571428, -1.8214285714285714, -1.8125, -1.8125, -1.8035714285714286, -1.7946428571428572, -1.7857142857142858, -1.7767857142857142, -1.7678571428571428, -1.7589285714285714, -1.75, -1.75, -1.7410714285714286, -1.7321428571428572, -1.7232142857142858, -1.7142857142857142, -1.7053571428571428, -1.6964285714285714, -1.6875, -1.6875, -1.6785714285714286, -1.6696428571428572, -1.6607142857142858, -1.6517857142857142, -1.6428571428571428, -1.6339285714285714, -1.625, -1.625, -1.6160714285714286, -1.6071428571428572, -1.5982142857142858, -1.5892857142857142, -1.5803571428571428, -1.5714285714285714, -1.5625, -1.5625, -1.5535714285714286, -1.5446428571428572, -1.5357142857142858, -1.5267857142857142, -1.5178571428571428, -1.5089285714285714, -1.5, -1.5, -1.4910714285714286, -1.4821428571428572, -1.4732142857142858, -1.4642857142857142, -1.4553571428571428, -1.4464285714285714, -1.4375, -1.4375, -1.4285714285714286, -1.4196428571428572, -1.4107142857142858, -1.4017857142857142, -1.3928571428571428, -1.3839285714285714, -1.375, -1.375, -1.3660714285714286, -1.3571428571428572, -1.3482142857142858, -1.3392857142857142, -1.3303571428571428, -1.3214285714285714, -1.3125, -1.3125, -1.3035714285714286, -1.2946428571428572, -1.2857142857142858, -1.2767857142857142, -1.2678571428571428, -1.2589285714285714, 
# -1.25, -1.25, -1.2410714285714286, -1.2321428571428572, -1.2232142857142858, -1.2142857142857142, -1.2053571428571428, -1.1964285714285714, -1.1875, -1.1875, -1.1785714285714286, -1.1696428571428572, -1.1607142857142858, -1.1517857142857142, -1.1428571428571428, -1.1339285714285714, -1.125, -1.125, -1.1160714285714286, -1.1071428571428572, -1.0982142857142858, -1.0892857142857142, -1.0803571428571428, -1.0714285714285714, -1.0625, -1.0625, -1.0535714285714286, -1.0446428571428572, 
# -1.0357142857142858, -1.0267857142857142, -1.0178571428571428, -1.0089285714285714, -1.0, -1.0, -0.9910714285714286, -0.9821428571428571, -0.9732142857142857, -0.9642857142857143, -0.9553571428571429, -0.9464285714285714, -0.9375, -0.9375, -0.9285714285714286, -0.9196428571428571, -0.9107142857142857, -0.9017857142857143, -0.8928571428571429, -0.8839285714285714, -0.875, -0.875, -0.8660714285714286, -0.8571428571428571, -0.8482142857142857, -0.8392857142857143, -0.8303571428571429, -0.8214285714285714, -0.8125, -0.8125, -0.8035714285714286, -0.7946428571428571, -0.7857142857142857, -0.7767857142857143, -0.7678571428571429, -0.7589285714285714, -0.75, -0.75, -0.7410714285714286, -0.7321428571428571, -0.7232142857142857, 
# -0.7142857142857143, -0.7053571428571429, -0.6964285714285714, -0.6875, -0.6875, -0.6785714285714286, -0.6696428571428571, -0.6607142857142857, -0.6517857142857143, -0.6428571428571429, -0.6339285714285714, -0.625, -0.625, -0.6160714285714286, -0.6071428571428571, -0.5982142857142857, -0.5892857142857143, -0.5803571428571429, -0.5714285714285714, -0.5625, -0.5625, -0.5535714285714286, -0.5446428571428571, -0.5357142857142857, -0.5267857142857143, -0.5178571428571429, -0.5089285714285714, -0.5, -0.5, -0.49107142857142855, -0.48214285714285715, -0.4732142857142857, -0.4642857142857143, -0.45535714285714285, -0.44642857142857145, -0.4375, -0.4375, -0.42857142857142855, -0.41964285714285715, -0.4107142857142857, -0.4017857142857143, -0.39285714285714285, -0.38392857142857145, -0.375, -0.375, -0.36607142857142855, -0.35714285714285715, -0.3482142857142857, -0.3392857142857143, -0.33035714285714285, -0.32142857142857145, -0.3125, -0.3125, -0.30357142857142855, -0.29464285714285715, -0.2857142857142857, -0.2767857142857143, -0.26785714285714285, -0.25892857142857145, -0.25, -0.25, -0.24107142857142858, -0.23214285714285715, -0.22321428571428573, -0.21428571428571427, -0.20535714285714285, -0.19642857142857142, -0.1875, -0.1875, -0.17857142857142858, -0.16964285714285715, -0.16071428571428573, -0.15178571428571427, -0.14285714285714285, -0.13392857142857142, -0.125, -0.125, -0.11607142857142858, -0.10714285714285714, -0.09821428571428571, -0.08928571428571429, -0.08035714285714286, -0.07142857142857142, -0.0625, -0.0625, -0.05357142857142857, -0.044642857142857144, -0.03571428571428571, -0.026785714285714284, -0.017857142857142856, -0.008928571428571428, 0.0, 0.0, 0.008928571428571428, 0.017857142857142856, 0.026785714285714284, 0.03571428571428571, 0.044642857142857144, 0.05357142857142857, 0.0625, 0.0625, 0.07142857142857142, 0.08035714285714286, 0.08928571428571429, 0.09821428571428571, 0.10714285714285714, 0.11607142857142858, 0.125, 0.125, 0.13392857142857142, 0.14285714285714285, 0.15178571428571427, 0.16071428571428573, 0.16964285714285715, 0.17857142857142858, 0.1875, 0.1875, 0.19642857142857142, 0.20535714285714285, 0.21428571428571427, 0.22321428571428573, 0.23214285714285715, 0.24107142857142858, 0.25, 0.25, 0.25892857142857145, 0.26785714285714285, 0.2767857142857143, 0.2857142857142857, 0.29464285714285715, 0.30357142857142855, 0.3125, 0.3125, 0.32142857142857145, 0.33035714285714285, 0.3392857142857143, 0.3482142857142857, 0.35714285714285715, 0.36607142857142855, 0.375, 0.375, 0.38392857142857145, 0.39285714285714285, 0.4017857142857143, 0.4107142857142857, 0.41964285714285715, 0.42857142857142855, 0.4375, 0.4375, 0.44642857142857145, 0.45535714285714285, 0.4642857142857143, 0.4732142857142857, 0.48214285714285715, 0.49107142857142855, 0.5, 0.5, 0.5089285714285714, 0.5178571428571429, 0.5267857142857143, 0.5357142857142857, 0.5446428571428571, 0.5535714285714286, 0.5625, 0.5625, 0.5714285714285714, 0.5803571428571429, 0.5892857142857143, 0.5982142857142857, 0.6071428571428571, 0.6160714285714286, 0.625, 0.625, 0.6339285714285714, 0.6428571428571429, 0.6517857142857143, 0.6607142857142857, 0.6696428571428571, 0.6785714285714286, 0.6875, 0.6875, 0.6964285714285714, 0.7053571428571429, 0.7142857142857143, 0.7232142857142857, 0.7321428571428571, 0.7410714285714286, 0.75, 0.75, 0.7589285714285714, 0.7678571428571429, 0.7767857142857143, 0.7857142857142857, 0.7946428571428571, 0.8035714285714286, 0.8125, 0.8125, 0.8214285714285714, 0.8303571428571429, 0.8392857142857143, 0.8482142857142857, 0.8571428571428571, 0.8660714285714286, 0.875, 0.875, 0.8839285714285714, 0.8928571428571429, 0.9017857142857143, 0.9107142857142857, 0.9196428571428571, 0.9285714285714286, 0.9375, 0.9375, 0.9464285714285714, 0.9553571428571429, 0.9642857142857143, 0.9732142857142857, 0.9821428571428571, 0.9910714285714286, 1.0, 1.0, 1.0089285714285714, 1.0178571428571428, 1.0267857142857142, 1.0357142857142858, 1.0446428571428572, 1.0535714285714286, 1.0625, 1.0625, 1.0714285714285714, 1.0803571428571428, 1.0892857142857142, 1.0982142857142858, 1.1071428571428572, 1.1160714285714286, 1.125, 1.125, 1.1339285714285714, 1.1428571428571428, 1.1517857142857142, 1.1607142857142858, 1.1696428571428572, 1.1785714285714286, 1.1875, 1.1875, 1.1964285714285714, 1.2053571428571428, 1.2142857142857142, 1.2232142857142858, 1.2321428571428572, 1.2410714285714286, 1.25, 1.25, 1.2589285714285714, 1.2678571428571428, 1.2767857142857142, 1.2857142857142858, 1.2946428571428572, 1.3035714285714286, 1.3125, 1.3125, 1.3214285714285714, 1.3303571428571428, 1.3392857142857142, 1.3482142857142858, 1.3571428571428572, 1.3660714285714286, 1.375, 1.375, 1.3839285714285714, 1.3928571428571428, 1.4017857142857142, 1.4107142857142858, 1.4196428571428572, 1.4285714285714286, 1.4375, 1.4375, 1.4464285714285714, 1.4553571428571428, 1.4642857142857142, 1.4732142857142858, 1.4821428571428572, 1.4910714285714286, 1.5, 1.5, 1.5089285714285714, 1.5178571428571428, 1.5267857142857142, 1.5357142857142858, 1.5446428571428572, 1.5535714285714286, 1.5625, 1.5625, 1.5714285714285714, 1.5803571428571428, 1.5892857142857142, 1.5982142857142858, 1.6071428571428572, 1.6160714285714286, 1.625, 1.625, 1.6339285714285714, 1.6428571428571428, 1.6517857142857142, 1.6607142857142858, 1.6696428571428572, 1.6785714285714286, 1.6875, 1.6875, 1.6964285714285714, 1.7053571428571428, 1.7142857142857142, 1.7232142857142858, 1.7321428571428572, 1.7410714285714286, 1.75, 1.75, 1.7589285714285714, 1.7678571428571428, 1.7767857142857142, 1.7857142857142858, 1.7946428571428572, 
# 1.8035714285714286, 1.8125, 1.8125, 1.8214285714285714, 1.8303571428571428, 1.8392857142857142, 1.8482142857142858, 1.8571428571428572, 1.8660714285714286, 1.875, 1.875, 1.8839285714285714, 1.8928571428571428, 1.9017857142857142, 1.9107142857142858, 1.9196428571428572, 1.9285714285714286, 1.9375, 1.9375, 1.9464285714285714, 1.9553571428571428, 1.9642857142857142, 1.9732142857142858, 1.9821428571428572, 1.9910714285714286, 2.0]

x = [0.0, 0.017857142857142856, 0.03571428571428571, 0.05357142857142857, 0.07142857142857142, 0.08928571428571429, 0.10714285714285714, 0.125, 0.125, 0.14285714285714285, 0.16071428571428573, 0.17857142857142858, 0.19642857142857142, 0.21428571428571427, 0.23214285714285715, 0.25, 0.25, 0.26785714285714285, 0.2857142857142857, 0.30357142857142855, 0.32142857142857145, 0.3392857142857143, 0.35714285714285715, 0.375, 0.375, 0.39285714285714285, 0.4107142857142857, 0.42857142857142855, 0.44642857142857145, 0.4642857142857143, 0.48214285714285715, 0.5, 0.5, 0.5178571428571429, 0.5357142857142857, 0.5535714285714286, 0.5714285714285714, 0.5892857142857143, 0.6071428571428571, 0.625, 0.625, 0.6428571428571429, 0.6607142857142857, 0.6785714285714286, 0.6964285714285714, 0.7142857142857143, 0.7321428571428571, 0.75, 0.75, 0.7678571428571429, 0.7857142857142857, 0.8035714285714286, 0.8214285714285714, 0.8392857142857143, 0.8571428571428571, 0.875, 0.875, 0.8928571428571429, 0.9107142857142857, 0.9285714285714286, 0.9464285714285714, 0.9642857142857143, 0.9821428571428571, 1.0, 1.0, 1.0178571428571428, 1.0357142857142858, 1.0535714285714286, 1.0714285714285714, 1.0892857142857142, 1.1071428571428572, 1.125, 1.125, 1.1428571428571428, 1.1607142857142858, 1.1785714285714286, 1.1964285714285714, 1.2142857142857142, 1.2321428571428572, 1.25, 1.25, 1.2678571428571428, 1.2857142857142858, 1.3035714285714286, 1.3214285714285714, 1.3392857142857142, 1.3571428571428572, 1.375, 1.375, 1.3928571428571428, 1.4107142857142858, 1.4285714285714286, 1.4464285714285714, 1.4642857142857142, 1.4821428571428572, 1.5, 1.5, 1.5178571428571428, 1.5357142857142858, 1.5535714285714286, 1.5714285714285714, 1.5892857142857142, 1.6071428571428572, 1.625, 1.625, 1.6428571428571428, 1.6607142857142858, 1.6785714285714286, 1.6964285714285714, 1.7142857142857142, 1.7321428571428572, 1.75, 1.75, 1.7678571428571428, 1.7857142857142858, 1.8035714285714286, 1.8214285714285714, 1.8392857142857142, 1.8571428571428572, 1.875, 1.875, 1.8928571428571428, 1.9107142857142858, 1.9285714285714286, 1.9464285714285714, 1.9642857142857142, 1.9821428571428572, 2.0]
y = x = [0.0, 0.017857142857142856, 0.03571428571428571, 0.05357142857142857, 0.07142857142857142, 0.08928571428571429, 0.10714285714285714, 0.125, 0.125, 0.14285714285714285, 0.16071428571428573, 0.17857142857142858, 0.19642857142857142, 0.21428571428571427, 0.23214285714285715, 0.25, 0.25, 0.26785714285714285, 0.2857142857142857, 0.30357142857142855, 0.32142857142857145, 0.3392857142857143, 0.35714285714285715, 0.375, 0.375, 0.39285714285714285, 0.4107142857142857, 0.42857142857142855, 0.44642857142857145, 0.4642857142857143, 0.48214285714285715, 0.5, 0.5, 0.5178571428571429, 0.5357142857142857, 0.5535714285714286, 0.5714285714285714, 0.5892857142857143, 0.6071428571428571, 0.625, 0.625, 0.6428571428571429, 0.6607142857142857, 0.6785714285714286, 0.6964285714285714, 0.7142857142857143, 0.7321428571428571, 0.75, 0.75, 0.7678571428571429, 0.7857142857142857, 0.8035714285714286, 0.8214285714285714, 0.8392857142857143, 0.8571428571428571, 0.875, 0.875, 0.8928571428571429, 0.9107142857142857, 0.9285714285714286, 0.9464285714285714, 0.9642857142857143, 0.9821428571428571, 1.0, 1.0, 1.0178571428571428, 1.0357142857142858, 1.0535714285714286, 1.0714285714285714, 1.0892857142857142, 1.1071428571428572, 1.125, 1.125, 1.1428571428571428, 1.1607142857142858, 1.1785714285714286, 1.1964285714285714, 1.2142857142857142, 1.2321428571428572, 1.25, 1.25, 1.2678571428571428, 1.2857142857142858, 1.3035714285714286, 1.3214285714285714, 1.3392857142857142, 1.3571428571428572, 1.375, 1.375, 1.3928571428571428, 1.4107142857142858, 1.4285714285714286, 1.4464285714285714, 1.4642857142857142, 1.4821428571428572, 1.5, 1.5, 1.5178571428571428, 1.5357142857142858, 1.5535714285714286, 1.5714285714285714, 1.5892857142857142, 1.6071428571428572, 1.625, 1.625, 1.6428571428571428, 1.6607142857142858, 1.6785714285714286, 1.6964285714285714, 1.7142857142857142, 1.7321428571428572, 1.75, 1.75, 1.7678571428571428, 1.7857142857142858, 1.8035714285714286, 1.8214285714285714, 1.8392857142857142, 1.8571428571428572, 1.875, 1.875, 1.8928571428571428, 1.9107142857142858, 1.9285714285714286, 1.9464285714285714, 1.9642857142857142, 1.9821428571428572, 2.0]
A = zeros(9, length(x)) #Ergebnis aus initial cond: w0,...w1y
B = zeros(9, length(x)) # source term: w0,....w1y
C = zeros(4, length(x)) #hier speichere ich rho,vx,theta
D = zeros(9, length(x)) 
tau = 0.1
equations = PerturbationMomentSystem2D(0.1, 0.0, 2/3, tau)
t = 0.4
for i=1:length(x)
        A[:,i] = initial_condition_convergence_test(x[i], t, equations)
        B[:,i] .= source_terms_convergence_test(A[:,i], x[i], t, equations)
        C[:,i] .= cons2prim(A[:,i], equations)
        D[:,i] .= flux(A[:,i], 1, equations)
end

#  p1 = plot(x, B[5,:], title = "du1", markersize=3)
#  p2 = plot(x, B[6,:], title = "du2", markersize=3)
#  p3 = plot(x, B[7,:], title = "du3", markersize=3)
#  p4 = plot(x, B[8,:], title = "du4", markersize=3)
#  p5 = plot(x, B[9,:], title = "du5", markersize=3)



plot(x, B[5,:], title = "du8", label = "mit", markersize=3)

# equation = EulerEquations1D(5/3)

# ax = [0.0, 0.017857142857142856, 0.03571428571428571, 0.05357142857142857, 0.07142857142857142, 0.08928571428571429, 0.10714285714285714, 0.125, 0.125, 0.14285714285714285, 0.16071428571428573, 0.17857142857142858, 0.19642857142857142, 0.21428571428571427, 0.23214285714285715, 0.25, 0.25, 0.26785714285714285, 0.2857142857142857, 0.30357142857142855, 0.32142857142857145, 0.3392857142857143, 0.35714285714285715, 0.375, 0.375, 0.39285714285714285, 0.4107142857142857, 0.42857142857142855, 0.44642857142857145, 0.4642857142857143, 0.48214285714285715, 0.5, 0.5, 0.5178571428571429, 0.5357142857142857, 0.5535714285714286, 0.5714285714285714, 0.5892857142857143, 0.6071428571428571, 0.625, 0.625, 0.6428571428571429, 0.6607142857142857, 0.6785714285714286, 0.6964285714285714, 0.7142857142857143, 0.7321428571428571, 0.75, 0.75, 0.7678571428571429, 0.7857142857142857, 0.8035714285714286, 0.8214285714285714, 0.8392857142857143, 0.8571428571428571, 0.875, 0.875, 0.8928571428571429, 0.9107142857142857, 0.9285714285714286, 0.9464285714285714, 0.9642857142857143, 0.9821428571428571, 1.0, 1.0, 1.0178571428571428, 1.0357142857142858, 1.0535714285714286, 1.0714285714285714, 1.0892857142857142, 1.1071428571428572, 1.125, 1.125, 1.1428571428571428, 1.1607142857142858, 1.1785714285714286, 1.1964285714285714, 1.2142857142857142, 1.2321428571428572, 1.25, 1.25, 1.2678571428571428, 1.2857142857142858, 1.3035714285714286, 1.3214285714285714, 1.3392857142857142, 1.3571428571428572, 1.375, 1.375, 1.3928571428571428, 1.4107142857142858, 1.4285714285714286, 1.4464285714285714, 1.4642857142857142, 1.4821428571428572, 1.5, 1.5, 1.5178571428571428, 1.5357142857142858, 1.5535714285714286, 1.5714285714285714, 1.5892857142857142, 1.6071428571428572, 1.625, 1.625, 1.6428571428571428, 1.6607142857142858, 1.6785714285714286, 1.6964285714285714, 1.7142857142857142, 1.7321428571428572, 1.75, 1.75, 1.7678571428571428, 1.7857142857142858, 1.8035714285714286, 1.8214285714285714, 1.8392857142857142, 1.8571428571428572, 1.875, 1.875, 1.8928571428571428, 1.9107142857142858, 1.9285714285714286, 1.9464285714285714, 1.9642857142857142, 1.9821428571428572, 2.0]
# E = zeros(3, length(ax))
# R = zeros(3, length(ax))
# for i=1:length(ax)
#         E[:,i] = initial_condition_convergence_test(ax[i], t, equation)
#         R[:,i] .= cons2prim(E[:,i], equation)
# end

# plot!(x, R[2,:], label = "Euler t = " *string(t), markersize=3)