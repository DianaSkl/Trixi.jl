using OrdinaryDiffEq
using Trixi
using Plots

equations = PerturbationMomentSystem2D(0.0, 0.0, 1.0)

initial_condition = initial_condition_constant
surface_flux = flux_lax_friedrichs

boundary_condition = BoundaryConditionDirichlet(initial_condition)
boundary_conditions = (x_neg=boundary_condition, x_pos=boundary_condition, y_neg=boundary_condition, y_pos=boundary_condition)
volume_flux  = flux_lax_friedrichs
basis = LobattoLegendreBasis(3)
shock_indicator_variable = density_pressure
indicator_sc = IndicatorHennemannGassner(equations, basis,
                                         alpha_max=0.5,
                                         alpha_min=0.001,
                                         alpha_smooth=true,
                                         variable=shock_indicator_variable)
volume_integral = VolumeIntegralShockCapturingHG(indicator_sc;
                                                 volume_flux_dg=volume_flux,
                                                 volume_flux_fv=surface_flux)
solver = DGSEM(basis, surface_flux, volume_integral)
coordinates_min = (-1, -1)
coordinates_max = ( 1, 1)

mesh = TreeMesh(coordinates_min, coordinates_max, initial_refinement_level=6, n_cells_max=10_000, periodicity=false)

semi = SemidiscretizationHyperbolic(mesh, equations, initial_condition, solver, boundary_conditions=boundary_conditions)

tspan = (0.0, 0.4)
ode = semidiscretize(semi, tspan)

# At the beginning of the main loop, the SummaryCallback prints a summary of the simulation setup
# and resets the timers
summary_callback = SummaryCallback()

analysis_interval = 100

# The AnalysisCallback allows to analyse the solution in regular intervals and prints the results
analysis_callback = AnalysisCallback(semi, interval=100)

# das hier sorgt für die Ausgabe!
alive_callback = AliveCallback(analysis_interval=analysis_interval)


# The SaveSolutionCallback allows to save the solution to a file in regular intervals
save_solution = SaveSolutionCallback(interval=100,solution_variables=cons2prim)

# The StepsizeCallback handles the re-calculcation of the maximum Δt after each time step
stepsize_callback = StepsizeCallback(cfl=0.9)

save_restart = SaveRestartCallback(interval=100,save_final_restart=true)

# Create a CallbackSet to collect all callbacks such that they can be passed to the ODE solver
callbacks = CallbackSet(summary_callback, analysis_callback, alive_callback, save_solution, stepsize_callback, save_restart)



###############################################################################
# run the simulation

sol = solve(ode, CarpenterKennedy2N54(williamson_condition=false), dt=1.0, save_everystep=false, callback=callbacks);

# Print the timer summary
summary_callback()

pd = PlotData1D(sol; solution_variables=cons2prim)


rho1d =[2.995960114428906, 2.9953763910827473, 2.994782367441759, 2.9941470248014537, 2.993439344457343, 2.99262830770494, 2.991682895839757, 2.9905720901573054, 2.9898468523789172, 2.989154988102953, 2.988266699703018, 2.9871810891259347, 2.9858972583185244, 2.9844143092276068, 2.982731343800003, 2.980847463982533, 2.979658204202071, 2.97854805624731, 2.9771415590701067, 2.975449220015638, 2.973481546429081, 2.971249045655611, 2.968762225040405, 2.966031591928637, 2.964371914592994, 2.9628624654959945, 2.9609745947594, 2.9587363264683324, 2.956175684707913, 2.953320693563261, 2.9501993771194974, 2.946839759461743, 2.9448740672857707, 2.9431320376247148, 2.9409800556555155, 2.93846393490822, 2.935629488912875, 2.9325225311995253, 2.929188875298216, 2.925674334738995, 2.9236952050328857, 2.921985974869284, 2.919899382343359, 2.9174916269471574, 2.9148189081727223, 2.9119374255121, 2.908903378457335, 2.90577296650047, 2.9040766635182313, 2.902649052214164, 2.9009258897466226, 2.8989621339885066, 2.896812742812713, 2.894532674092138, 2.89217688569968, 2.889800335508235, 2.8885611948361305, 2.887545254652612, 2.886332107246297, 2.884965773928057, 2.883490276008767, 2.8819496347992986, 2.880387871610524, 2.878849007753318, 2.878076569525884, 2.8774603664330405, 2.8767318392332943, 2.8759203295678195, 2.87505517907779, 2.8741657294043805, 2.8732813221887645, 2.8724312990721153, 2.8720195164822395, 2.8717011872771008, 2.8713279692809937, 2.8709163577304144, 2.870482847861859, 2.870043934911823, 2.8696161141168033, 2.869215880713294, 2.869026881898294, 2.868887260105875, 2.8687241897925184, 2.868545656144736, 2.868359644349042, 2.8681741395919484, 2.867997127059969, 2.8678365919396165, 2.867759439472965, 2.8677075893648563, 2.8676461998585756, 2.8675787074537347, 2.8675085486499445, 2.867439159946815, 2.8673739778439575, 2.8673164388409833, 2.8672816943128114, 2.8672625853396276, 2.8672380775584916, 2.867209226283719, 2.8671770868296305, 2.8671427145105417, 2.8671071646407724, 2.867071492534638, 2.8670321083568737, 2.8670080726888605, 2.8669762107226875, 2.8669349206615675, 2.8668826007087187, 2.8668176490673534, 2.8667384639406874, 2.866643443531935, 2.86652948935278, 2.8664422201676176, 2.866335107308804, 2.8661999398804903, 2.86602850698683, 2.8658125977319746, 2.8655440012200777, 2.86521450655529, 2.8648505667832365, 2.86455638136002, 2.864210782409108, 2.8637889511632633, 2.863266068855249, 2.8626173167178246, 2.8618178759837543, 2.8608429278857987, 2.8598206023471233, 2.8589990613628693, 2.8580614090486414, 2.856948156430592, 2.8555998145348767, 2.8539568943876463, 2.851959907015057, 2.8495493634432605, 2.8471108362040902, 2.8451986131402123, 2.843068112928877, 2.8406011279550536, 2.837679450603712, 2.8341848732598214, 2.8299991883083497, 2.825004188134267, 2.820099148031685, 2.8163703936796396, 2.8123081432837855, 2.807714836652985, 2.8023929135960994, 2.7961448139219884, 2.7887729774395145, 2.780079843957537, 2.771771064267014, 2.765664382597112, 2.7591548078931987, 2.7519625087942283, 2.7438076539391574, 2.73441041196694, 2.7234909515165318, 2.7107694412268875, 2.6989179664501783, 2.690507143563557, 2.681732188489055, 2.672255366304938, 2.66173894208947, 2.6498451809209125, 2.63623634787753, 2.6205747080375863, 2.6063390247820553, 2.5965907434674476, 2.5866358424988385, 2.5761255035425323, 2.5647109082648294, 2.552043238332033, 2.5377736754104454, 2.5215534011663685, 2.507154599891524, 2.497645857744164, 2.4881407393698067, 2.4783298984329445, 2.467903988598074, 2.456553663529687, 2.443969576892278, 2.4298423823503406, 2.4175775397993777, 2.4097699387222433, 2.4021289935832386, 2.3944182066698305, 2.3864010802694864, 2.3778411166696696, 2.3685018181578483, 2.3581466870214873, 2.3493231316427092, 2.3439041941103786, 2.338708070132623, 2.3335764256354103, 2.328350926544711, 2.3228732387864937, 2.316985028286729, 2.3105279609713847, 2.3050494347651043, 2.301766564961325, 2.2986705646866286, 2.29566012415647, 2.292633933586302, 2.289490683191578, 2.2861290631877518, 2.2824477637902767, 2.279133654303895, 2.277064538321547, 2.2751179508731694, 2.2732096057861595, 2.2712552168879174, 2.2691704980058383, 2.2668711629673206, 2.264272925599761, 2.2614146822036774, 2.2593123574542875, 2.2573124325052856, 2.255296432653559, 2.253145883195999, 2.2507423094294925, 2.24796723665093, 2.2447021901571986, 2.240464627954099, 2.2369875830403827, 2.233701332737961, 2.2304002895419828, 2.226878865947596, 2.2229314744499478, 2.2183525275441873, 2.212936437725461, 2.2057103684280404, 2.1996930273520268, 2.194107165714941, 2.1886224817689373, 2.1829086737661685, 2.176635439958789, 2.1694724785989514, 2.1610894879388085, 2.1500646153826377, 2.1410040880691135, 2.1327530757347537, 2.1248564562168015, 2.1168591073524965, 2.1083059069790786, 2.098741732933789, 2.0877114630538673, 2.0735005718056825, 2.062042715358014, 2.0517979842823015, 2.042235411525002, 2.032824030032573, 2.0230328727514713, 2.0123309726281544, 2.0001873626090783, 1.9848662334542873, 1.9727640102340949, 1.9621279256529274, 1.9524342861974247, 1.9431593983542252, 1.9337795686099684, 1.9237711034512937, 1.9126103093648392, 1.898813763191851, 1.888141800877705, 1.8789120111597142, 1.8706877194602087, 1.8630322512015187, 1.855508931805973, 1.8476810866959017, 1.839112041293634, 1.8287157062997665, 1.820835182134797, 1.814116500045832, 1.808251180401159, 1.8029307435690685, 1.7978467099178466, 1.7926905998157832, 1.7871539336311664, 1.7805110680709963, 1.7755331878811667, 1.7713286366116001, 1.7677095290203373, 1.76448797986542, 1.7614761039048892, 1.7584860158967857, 1.7553298305991507, 1.7514498156224252, 1.7484138993456004, 1.7458232167996752, 1.7435687898473677, 1.741541640351397, 1.7396327901744801, 1.7377332611793346, 1.7357340752286796, 1.7329367133068285, 1.730290630222773, 1.727930861398786, 1.7257737099240609, 1.7237354788877897, 1.7217324713791655, 1.7196809904873809, 1.7174973393016277, 1.7139447610276481, 1.7099218051742477, 1.706243238071701, 1.7028006929394404, 1.6994858029968982, 1.6961902014635062, 1.6928055215586968, 1.689223396501902, 1.6832574209844575, 1.676211444510057, 1.669795901165234, 1.6638402490907007, 1.6581739464271723, 1.6526264513153603, 1.6470272218959794, 1.6412057163097415, 1.6317808487455883, 1.6207449762818404, 1.6108116083964272, 
1.601730732561008, 1.593252336247242, 1.5851264069267867, 1.577102932071301, 1.5689318991524437, 1.5561750196127693, 1.5415295082011957, 1.528510630199835, 1.5167990339906021, 1.506075367955413, 1.4960202804761826, 1.486314419934826, 1.4766384347132584, 1.4620767636183882, 1.445733462715279, 1.431385562778235, 1.4186818213597838, 1.4072709960124525, 1.3968018442887684, 1.386923123741259, 1.3772835919224506, 1.3632938055357189, 1.347963140684515, 1.3346698466879285, 1.323082480953258, 1.3128696008878016, 1.3036997638988563, 1.2952415273937206, 1.2871634487796912, 1.2758516130020672, 1.2637595516339055, 1.2534023772392324, 1.2445127136176408, 1.2368231845687228, 1.2300664138920707, 1.2239750253872768, 1.2182816428539336, 
1.2105834720317572, 1.2025642045353846, 1.19577835702167, 1.1900423539185498, 1.1851726196539598, 1.1809855786558356, 1.1772976553521137, 1.1739252741707293, 1.1695163837848166, 1.1650473769070662, 1.1613104937638856, 1.1581990578100152, 1.155606392500196, 1.1534258212891673, 1.1515506676316702, 1.1498742549824448, 1.1477489839720825, 1.1456587989765554, 1.1439308606295293, 1.1425131188395545, 1.141353523515182, 1.1404000245649613, 1.1396005718974433, 1.1389031154211782, 1.1380394110359786, 1.1372208140313824, 1.1365508592732079, 1.136008559790239, 1.1355729286112606, 1.1352229787650572, 1.1349377232804132, 1.1346961751861122, 1.1343977565950787, 1.1341299235836946, 1.133911727032834, 1.133736537012824, 1.133597723593992, 1.1334886568466644, 1.1334027068411685, 1.1333332436478316, 1.1332414891958495, 1.1331653348987007, 1.1331011497200545, 1.1330478752959934, 1.1330044532625991, 1.1329698252559532, 1.1329429329121372, 1.132922717867233, 1.1328886241081728, 1.132854415781097, 1.1328189680284546, 1.132783610054423, 1.13274967106318, 1.1327184802589014, 1.1326913668457652, 1.1326696600279476, 1.1326322336282024, 1.132564788727179, 1.1324885798042086, 1.1324075162782272, 1.1323255075681697, 1.1322464630929718, 1.1321742922715679, 1.1321129045228937, 1.132024111904668, 1.1318364739046518, 1.1316307159366152, 1.1314158473089213, 1.1312008773299327, 1.1309948153080123, 1.130806670551523, 1.1306454523688274, 1.13042966364845, 1.1299728799262618, 1.1294867916852245, 1.1289896854949786, 1.1284998479251656, 1.128035565545425, 1.1276151249253985, 1.1272568126347262, 1.1267962081775393, 1.1258495368738524, 1.124868530166451, 1.1238849351986153, 1.1229304991136257, 1.122036969054762, 1.1212360921653046, 1.120559615588533, 1.119715704243231, 1.1180437870348305, 1.116353476787432, 1.1146910908979288, 1.1131029467632145, 1.111635361780182, 1.1103346533457246, 1.1092471388567353, 1.1079265360113697, 1.1054089428646927, 1.1029225919111554, 1.1005235378027047, 1.0982678351912893, 1.096211538728856, 1.0944107030673522, 1.092921382858726, 1.091159392556292, 1.0879279316955246, 1.0848072689826875, 1.0818527380727492, 1.0791196726206782, 1.076663406281442, 1.074539272710009, 1.072802605561347, 1.0708004414680696, 1.0672674900215278, 1.0639282141052637, 1.060825826402295, 1.0580035395956378, 1.0555045663683098, 1.0533721194033276, 1.0516494113837085, 1.0497141025445844, 1.0464276489282265, 1.0433848628629823, 1.0406105894238316, 1.0381296736857524, 1.0359669607237239, 1.034147295612724, 1.0326955234277317, 1.0311064429833767, 1.0285089648892622, 1.0261514107289544, 1.0240417993203434, 1.02218814948132, 1.020598480029774, 1.0192808097835953, 1.0182431575606743, 1.0171366513725377, 1.0153954028378869, 1.0138450005441042, 1.0124833259139945, 1.0113082603703645, 1.010317685336018, 1.0095094822337616, 1.0088815324864002, 1.0082265348114359, 1.0072301678444533, 1.0063835700455919, 1.0056594726315453, 1.0050306068190085, 1.0044697038246753, 1.003949494865239, 1.0034427111573945]
vx1d = [0.0028728649724130704, 0.0032886659524028914, 0.0037118598016839988, 0.004164670656132636, 0.0046693226516250465, 0.005248039924037473, 0.005923046609246159, 0.006716566843127346, 0.0072348951720348255, 0.007729798085645997, 0.008365358972998496, 0.009142606458465404, 0.010062569166419802, 0.011126275721234771, 0.012334754747283391, 0.01368903486893874, 0.014544655518503912, 0.015344310698156978, 0.01635802754754176, 0.01757901234188824, 0.01900047135642644, 0.020615610866386337, 
0.02241763714699794, 0.024399756473491237, 0.025605937004358374, 0.026704552940944856, 0.028079970772315967, 0.02971290421294753, 0.03158406697731537, 0.03367417277989528, 0.0359639353351631, 0.03843406835759464, 0.039881385559203966, 0.04116616348570095, 0.042755374882937285, 0.04461636768189964, 0.046716489813574666, 0.04902308920894901, 0.05150351379900931, 0.05412511151474223, 0.05560331703691775, 0.05688222670070468, 0.05844562790638432, 0.06025230874517678, 0.0622610573083022, 0.06443066168698067, 0.06671990997243228, 0.06908759025587716, 0.07037151798298592, 0.07145422363434788, 0.07276250053559477, 0.0742551487034371, 0.07589096815458525, 0.07762875890574973, 0.07942732097364097, 0.0812454543749694, 0.0821930560316152, 0.0829720156706029, 0.083902637147214, 0.08495145297089936, 0.08608499565110983, 0.08726979769729626, 0.0884723916189095, 0.08965930992540042, 0.09025356242998263, 0.09072983366971152, 0.09129262814198755, 0.09191953128482036, 0.09258812853621959, 0.09327600533419486, 0.09396074711675582, 0.09461993932191207, 0.09493683660036724, 0.09518448724516118, 0.09547408544884195, 0.09579312885335638, 0.09612911510065139, 0.0964695418326738, 0.09680190669137044, 0.09711370731868817, 
0.09725762099373336, 0.0973672542434553, 0.09749421204575555, 0.09763264804447051, 0.0977767158834366, 0.09792056920649013, 0.09805836165746751, 0.09818424688020509, 0.09824023426441213, 0.09828177729546171, 0.09832949883812413, 0.09838112796614472, 0.09843439375326872, 0.09848702527324149, 0.09853675159980826, 0.09858130180671433, 0.09860141865083066, 0.09861613514744044, 0.09863308673002431, 0.09865171338789694, 0.09867145511037319, 0.09869175188676776, 0.09871204370639544, 0.09873177055857098, 0.09874514328267364, 0.0987559235938572, 0.09876877702112054, 0.09878436976971032, 0.09880336804487333, 0.09882643805185616, 0.09885424599590553, 0.09888745808226813, 0.09892172548214188, 0.09895121498464093, 0.09898622606804336, 0.09902969585385396, 0.09908456146357757, 0.09915376001871899, 0.09924022864078305, 0.09934690445127455, 0.09945963134591809, 0.09955495280355198, 0.09966561451896475, 0.09979999267122974, 0.09996646343942027, 0.10017340300260962, 0.10042918753987104, 0.10074219323027787, 0.10106482602547047, 0.10132941387531083, 0.10162984302817063, 0.1019859545016473, 0.10241758931333834, 0.10294458848084115, 0.10358679302175317, 0.10436404395367183, 0.10514489667366053, 0.1057645704990728, 0.10645325276691267, 0.10725103077491835, 0.10819799182082801, 0.10933422320237982, 0.11069981221731193, 0.11233484616336253, 0.1139384631590107, 0.11516957630181018, 0.11650961287676609, 0.11802840475101527, 0.11979578379169466, 0.12188158186594113, 0.12435563084089152, 0.12728776258368277, 0.13009944521022807, 0.13218779853656992, 0.13441545954334655, 0.1368877436517235, 0.13970996628286655, 0.14298744285794115, 0.146825488798113, 0.15132941952454768, 0.15555568048984686, 0.15859181601672506, 0.16176684443446665, 0.16521773041907595, 0.16908143864655734, 0.17349493379291503, 0.17859518053415338, 0.18451914354627663, 0.18995763822801084, 0.1937327652280193, 0.19760227350615817, 0.20171828240484857, 0.20623291126651178, 0.21129827943356896, 0.21706650624844134, 0.22368971105354998, 0.22963136400640718, 0.23360987208804662, 0.2376036327034551, 0.24175569136937367, 0.24620909360254353, 0.2511068849197058, 0.2565921108376015, 0.2628078168729717, 0.26824858116116146, 0.2717568262164055, 0.2752019659012814, 0.27869781798772214, 0.2823582002476613, 0.2862969304530319, 0.2906278263757674, 0.295464705787801, 0.2995949618210978, 0.3021579194212454, 0.3046184547598916, 0.3070539493964716, 0.3095417848904207, 0.31215934280117413, 0.3149840046881669, 0.31809315211083444, 0.32069462451658054, 0.3222536896428484, 0.3237183621403748, 0.32513506432675565, 0.3265502185195869, 0.328010247036464, 0.32956157219498283, 0.33125061631273917, 0.3326687199846802, 0.3335104676870811, 0.3342892434424079, 0.3350332040750709, 0.33577050640948064, 0.3365293072700471, 0.3373377634811805, 0.33822403186729116, 0.3390467289384733, 0.3395822799776327, 0.34007976190631284, 0.3405638084745649, 0.34105905343244, 0.34159013052998904, 0.3421816735172633, 0.3428583161443136, 0.34364575062857444, 0.3442551241122202, 0.3448266096583263, 0.3453949568265622, 0.3459949151765975, 0.34666123426810164, 0.34742866366074426, 0.3483319529141947, 0.34951386334048373, 0.350492371190163, 0.3514016226816748, 0.3522968025532304, 0.35323309554304116, 0.3542656863893181, 0.3554497598302726, 0.35684050060411565, 0.3586802246519819, 0.3602055479318029, 0.3616006868947579, 0.3629454625409013, 0.3643196958702876, 0.36580320788297105, 0.36747581957900605, 0.369417351958447, 0.3719511446729569, 0.3740225280150366, 0.37588672270458673, 0.37764338919571, 0.3793921879425091, 0.3812327793990865, 0.38326482401954465, 0.3855879822579862, 0.38856420216905324, 
0.3909516348718951, 0.3930657492762917, 0.39501229954440187, 0.396897039838385, 0.3988257243204, 0.4009041071526059, 0.4032379424971618, 0.40616495430315064, 0.4084601040262214, 0.4104589054654194, 0.41225582018208334, 0.413945309737552, 0.415621835693164, 0.4173798596102579, 0.41931384305017255, 0.4216827284664059, 0.42348964660748006, 0.4250363339004664, 0.42639295575965463, 0.4276296775993344, 0.42881666483379505, 0.43002408287732613, 0.43132209714421726, 0.4328688946284876, 0.43400105477030587, 0.43495138988363835, 0.43576192327286045, 0.43647467824234737, 0.4371316780964742, 0.4377749461396163, 0.4384465056761489, 0.4392045280856298, 0.4396922825786871, 0.4400838871295053, 0.44039678620978917, 0.4406484242912434, 0.44085624584557276, 0.4410376953444819, 0.44121021725967546, 0.4413214293757335, 0.44123725788553564, 0.4411298935767245, 0.4409972830826857, 0.4408373730368054, 0.44064811007246896, 0.4404274408230622, 0.4401733119219707, 0.4396754405748326, 
0.4389649413933146, 0.43829912521165953, 0.4376583495884643, 0.437022972082326, 0.43637335025184154, 0.435689841655608, 0.43495280385222224, 0.4337120619818806, 0.4321611909389055, 0.43073900276376104, 0.42940655098139313, 0.42812488911674784, 0.4268550706947709, 0.4255581492404082, 0.42419517827860564, 0.4219901165773772, 0.4193299462183436, 0.41691343922138696, 0.4146799277120624, 0.4125687438159251, 0.41051921965852994, 0.4084706873654319, 0.40636247906218614, 0.4030529144049822, 0.39914741424603434, 0.39562839072349804, 0.39241398606397754, 0.3894223424940773, 0.38657160224040127, 0.38377990752955393, 0.3809654005881392, 0.3766818628692331, 0.3717339499893886, 0.3673181391782304, 0.36333684206096684, 0.35969247026280654, 0.35628743540895774, 0.3530241491246288, 0.34980502303502814, 0.34506947732825205, 0.33973101484408313, 0.3350255368913773, 0.3308497609510525, 0.3271004045040269, 0.32367418503121836, 0.32046782001354496, 0.31737802693192463, 0.31300007927642787, 0.3082016407611161, 0.3040366503974389, 0.30040924350212556, 0.29722355539190537, 0.29438372138350766, 0.29179387679366164, 0.28935815693909667, 0.2860429938030284, 0.28251876134688797, 0.2795110221798697, 0.2769442017435231, 0.2747427254793981, 0.27283101882904415, 0.2711335072340111, 0.26957461613584843, 0.2675388745344225, 0.26543968077087526, 0.26367765716715713, 0.262203793729108, 0.26096908046256817, 0.2599245073733776, 0.25902106446737627, 0.2582097417504043, 0.2571934234295685, 0.25617442987084205, 0.25533215466310044, 0.25464073086971056, 0.25407429155403927, 0.2536069697794534, 0.25321289860931967, 0.252866211107005, 0.25245019851513456, 0.2520426043796681, 0.25171040125705196, 0.25144238358823257, 
0.25122734581415596, 0.2510540823757681, 0.25091138771401533, 0.2507880562698437, 0.25064722757711205, 0.25051001674747736, 0.2503991316245937, 0.2503105989212584, 0.2502404453502682, 0.25018469762441997, 0.2501393824565109, 0.25010052655933773, 0.2500587748224726, 0.2500125188502888, 0.24997273211886453, 0.24993864582466918, 0.2499094911641721, 0.24988449933384255, 0.24986290153015, 0.24984392894956373, 0.24982246658539248, 0.24978031452220623, 0.24973528798722974, 0.24968891160992066, 0.2496427100197364, 0.24959820784613448, 0.2495569297185723, 0.2495204002665074, 0.2494727863792496, 0.24936040644117716, 0.24923531136408034, 0.24910308100382295, 0.24896929521626898, 0.24883953385728208, 0.24871937678272626, 0.24861440384846517, 0.24847545254346648, 0.24816080783227873, 0.24781784465892745, 0.24746077436071423, 0.24710380827494066, 0.2467611577389083, 0.2464470340899187, 0.2461756486652733, 0.2458221857590209, 0.2450579687288969, 0.24424560670537684, 0.2434151184754152, 0.24259652282596647, 0.24181983854398495, 0.24111508441642515, 0.24051227923024143, 0.2397444106337937, 0.2381529705191565, 0.23650159617366462, 0.23484375460373474, 0.23323291281578384, 0.2317225378162285, 0.23036609661148555, 0.2292170562079717, 0.2277876493437994, 0.22494167636889478, 0.2220549928503434, 0.21920807283436086, 0.21648139036716274, 0.21395541949496466, 0.21171063426398215, 0.20982750872043077, 0.20754081438904828, 0.20316149663193522, 0.19881472631143107, 0.1946024513583274, 0.1906266197034158, 0.18698917927748776, 0.1837920780113349, 0.1811372638357487, 0.17799143635760195, 0.17219265406485743, 0.16655716455412362, 0.16119213747402528, 0.15620474247318722, 0.15170214920023428, 0.14779152730379125, 0.14458004643248287, 0.14086825300341163, 0.13428242791191716, 0.1280156753857727, 0.12215847206082028, 0.11680129457290199, 0.11203461955785983, 0.10794892365153587, 0.10463468348977215, 0.10090072110115274, 0.09452614306209346, 0.08858839867311313, 0.08314463571731417, 0.078252001977799, 0.07396764523767001, 0.07034871328002958, 0.06745235388798011, 0.06427361145986409, 0.05905465140920632, 0.05429591328116137, 0.05001925642094405, 0.046246540173769154, 0.04299962388485147, 0.040300366899405804, 0.038170628562646955, 0.035894901364199344, 0.03230235278426354, 0.029094109783866468, 0.026268401208324854, 0.02382345590295544, 0.02175750271307496, 0.020068770484000152, 0.018755488061047758, 0.017383806885048127, 0.015292978998555216, 0.013514013021122295, 0.011990121268475063, 0.01066451605633923, 0.009480409700440496, 0.008381014516504557, 0.0073095428202571205]
theta1d = [0.9979453157277856, 0.9976474477442324, 0.9973442327871961, 0.9970196635895087, 0.9966577328840021, 0.9962424334035082, 0.9957577578808593, 0.9951876990488874, 0.9948150462264358, 0.994459069560895, 0.9940017615994959, 0.9934421218454984, 0.9927791498021623, 0.9920118449727481, 0.9911392068605155, 0.9901602349687244, 0.9895410015031446, 0.988961858996904, 0.9882271702146807, 0.9873413251931135, 0.9863087139688416, 0.9851337265785035, 0.9838207530587385, 0.9823741834461851, 0.9814924757739382, 0.9806886591011493, 0.9796811938389176, 0.9784834280490654, 0.977108709793415, 0.9755703871337879, 0.9738818081320069, 0.9720563208498936, 0.9709846598351681, 0.9700324208797009, 0.96885283955593, 0.9674693496187976, 0.9659053848232462, 0.9641843789242169, 0.9623297656766526, 0.9603649788354949, 0.9592549121107323, 0.958293712546472, 0.9571168592553065, 0.955754804427855, 0.9542380002547379, 0.9525968989265745, 0.9508619526339841, 0.9490636135675864, 0.9480866134117563, 0.9472623576377592, 0.9462649431574867, 0.9451255194513453, 0.9438752359997419, 0.9425452422830829, 0.941166687781775, 0.9397707219762246, 0.9390419012536773, 0.9384428965064711, 0.9377264084995613, 0.9369181568550642, 0.9360438611950952, 0.9351292411417702, 0.9342000163172054, 0.9332819063435162, 0.9328213228545297, 0.9324526808378525, 0.9320165962694738, 0.9315304876281045, 0.931011773392456, 0.9304778720412391, 0.9299462020531648, 0.9294341819069437, 0.9291871560233648, 0.9289948999180702, 0.9287697414340701, 0.9285214941495473, 0.9282599716426851, 0.9279949874916662, 0.9277363552746738, 0.9274938885698907, 0.9273809580075382, 0.9272959922598544, 0.9271972523964506, 0.9270894207046952, 0.9269771794719565, 0.9268652109856016, 0.9267581975329984, 0.9266608214015145, 0.9266164166101529, 0.9265848907122787, 0.9265482842881776, 0.9265085802145576, 0.9264677613681276, 0.9264278106255954, 0.9263907108636695, 0.9263584449590582, 0.9263434994021021, 0.9263347039386582, 0.9263241991636374, 0.9263129153908751, 0.9263017829342076, 0.9262917321074697, 0.9262836932244971, 0.9262785965991257, 0.9262770129169688, 0.9262790887882684, 0.9262810253188535, 0.926283752675429, 0.9262882010246991, 0.9262953005333688, 0.9263059813681425, 0.9263211736957245, 0.9263357732069591, 0.9263520938614184, 0.9263704936859293, 0.9263929992083918, 0.9264216369567051, 0.926458433458769, 0.9265054152424826, 0.9265646088357457, 0.9266230787178463, 0.92667678946668, 0.926737906739002, 0.9268114571435458, 0.9269024672890461, 0.9270159637842368, 0.927156973237852, 0.9273305222586254, 0.9275037923645667, 0.9276508394327425, 0.9278163501515885, 0.9280116353129007, 0.9282480057084759, 0.9285367721301107, 0.9288892453696014, 0.9293167362187446, 0.9297390285565407, 0.9300796431627797, 0.9304564758596675, 0.9308916244339536, 0.931407186672388, 0.93202526036172, 0.9327679432886993, 0.9336573332400755, 0.9345197232155906, 0.9351871141534612, 0.9359113445550553, 0.9367295723477714, 0.9376789554590084, 0.9387966518161642, 0.940119819346638, 0.9416856159778284, 0.9431717195548235, 0.9442791731397272, 0.9454571098467411, 0.9467591553454412, 0.948238935305404, 0.9499500753962046, 0.9519462012874196, 0.9542809386486248, 0.9564471120310587, 0.9580036277552362, 0.9596256692979768, 0.9613794266448871, 0.9633310897815748, 0.9655468486936455, 0.9680928933667067, 0.9710354137863647, 0.9737011456622575, 0.975548711478632, 0.9774338929212781, 0.9794263715307268, 0.981595828847509, 0.9840119464121548, 0.9867444057651955, 0.9898628884471615, 0.9926177796469225, 0.9944596726944991, 0.9962983057554188, 0.9981963498422447, 1.00021647596754, 1.0024213551438679, 1.0048736583837914, 1.0076360566998734, 1.010011885654164, 1.011544991061977, 1.013040787622302, 1.0145475577555567, 1.0161135838821598, 1.017787148422528, 1.0196165337970795, 1.0216500224262317, 1.023345668591097, 1.024401175483799, 1.0254060649044061, 1.026391585123451, 1.0273889844114665, 1.0284295110389845, 1.0295444132765377, 1.0307649393946585, 1.031729609119972, 1.0322990661518496, 1.0328240590325202, 1.0333189488043635, 1.0337980965097604, 1.0342758631910907, 1.0347666098907347, 1.0352846976510723, 1.0356027663104128, 1.0357378800770018, 1.0358455057233926, 1.0359221951879323, 1.0359645004089695, 1.035968973324851, 1.0359321658739251, 1.035850629994539, 1.0355475113217836, 1.0352260004993263, 1.0349027467471332, 1.034551031177357, 1.034144134902151, 1.033655339033667, 1.0330579246840579, 1.0323251729654759, 1.0312414322658359, 1.0302940092592725, 1.0293901350315517, 1.0284692170009169, 1.0274706625856114, 1.0263338792038776, 1.0249982742739592, 1.0234032552140988, 1.0212185843719244, 1.0193678625402984, 1.017642868186193, 1.0159373053744645, 1.014144878169969, 1.0121592906375623, 1.0098742468421, 1.0071834508484385, 1.0035966146812338, 1.0006101783647137, 0.9978766507858503, 0.9952390225868935, 0.992540284410094, 0.989623426897701, 0.986331440691965, 0.9825073164351354, 0.9775073186368425, 0.9734139893705877, 0.9697283434549595, 0.9662528863554937, 0.9627901235377251, 0.9591425604671889, 0.95511270260942, 0.9505030554299536, 0.9445908204944984, 0.9398429859942155, 0.9356365673644993, 0.9317608728940531, 0.9280052108715799, 0.9241588895857825, 0.9200112173253641, 0.9153515023790274, 0.9095013694092803, 0.9049093833585248, 0.90090829759349, 0.8973089923546519, 0.8939223478824863, 0.8905592444174683, 0.887030562200074, 0.8831471814707788, 0.8783858375297338, 0.874750081386736, 0.8716364297977799, 0.8689037082291574, 0.8664107421471604, 0.864016357018081, 0.8615793783082113, 0.858958631483843, 0.855830721729725, 0.8535353740150097, 0.8516068878261186, 0.8499600609260357, 0.8485096910777453, 0.8471705760442312, 0.8458575135884776, 0.8444853014734681, 0.8429250100081846, 0.8419027373263602, 0.8410766792043883, 0.8404102954213458, 0.8398670457563098, 0.8394103899883572, 0.8390037878965647, 0.8386106992600093, 0.8383067172353379, 0.8383772679083934, 0.8385011422675701, 0.8386794075027817, 0.8389131308039429, 0.8392033793609671, 0.8395512203637685, 0.8399577210022607, 0.8407782167929527, 0.8419838902908522, 0.8431161881458308, 0.844208492380842, 0.8452941850188389, 0.8464066480827745, 0.8475792635956023, 0.848845413580275, 0.850976968200166, 0.853652163034844, 0.856104394898043, 0.8584010661471523, 0.8606095791395609, 0.8627973362326583, 0.8650317397838336, 0.8673801921504759, 0.871172974078557, 0.875750739752992, 0.8799053132975684, 0.8837415326557289, 0.8873642357709157, 0.8908782605865715, 0.8943884450461388, 0.8979996270930599, 0.9036573665573882, 0.9103289248132268, 0.9163324022409289, 0.9218085586199574, 0.9268981537297748, 0.9317419473498434, 0.936480699259626, 0.9412551692385851, 0.9485058030694743, 0.9568691940406469, 0.964321071788145, 0.9710281182266017, 0.9771570152706499, 0.9828744448349221, 0.9883470888340509, 0.9937416291826687, 1.0016588573903562, 1.0105689587490974, 1.0184089851749212, 1.0253536975320081, 1.0315778566845395, 1.0372562234966953, 1.0425635588326565, 1.0476746235566037, 1.0548998720880005, 1.0628070140600432, 1.0696597082577568, 1.0756181433905998, 1.0808425081680306, 1.0854929912995064, 1.0897297814944857, 1.0937130674624262, 1.0991231953561447, 1.104869141249398, 1.1097673572179696, 1.1139424403534584, 1.1175189877474643, 1.120621596491586, 1.1233748636774232, 1.125903386396575, 1.129198988052087, 1.13259704353423, 1.1354471594222344, 1.137829295908902, 1.139823413187035, 1.1415094714494345, 1.142967430888903, 1.144277251698242, 1.145914430703021, 1.147557529626435, 1.148914890764101, 1.1500285050727195, 1.150940363508992, 1.151692457029619, 1.152326776591301, 1.1528853131507393, 1.1535530898649309, 1.1542087727666888, 1.1547425092532746, 1.1551725579633245, 1.1555171775354753, 1.1557946266083632, 1.1560231638206242, 1.1562210478108943, 1.1564448553376576, 1.1566620405201713, 1.1568356722230448, 1.1569725599409837, 1.1570795131686926, 1.1571633414008762, 1.1572308541322396, 1.1572888608574874, 1.1573479723625186, 1.1574046003316214, 1.157447123717176, 1.1574780919660757, 1.1575000545252154, 1.1575155608414875, 1.157527160361787, 1.1575374025330067, 1.157542179101623, 1.157539114671981, 1.1575294787745496, 1.1575151214540864, 1.1574978927553472, 1.157479642723089, 1.1574622214020682, 1.1574474788370412, 1.1574222583685134, 1.1573655072096838, 1.1573001434448784, 1.1572296759562977, 1.1571576136261417, 1.1570874653366106, 1.1570227399699045, 1.156966946408224, 1.1568889034858993, 1.1567178535114224, 1.1565303732411063, 1.1563345506762204, 1.1561384738180336, 1.1559502306678153, 1.155777909226834, 1.1556295974963593, 1.1554332749659812, 1.1550134058739436, 1.1545659482771835, 1.1541077193518396, 1.1536555362740506, 1.1532262162199545, 1.1528365763656907, 1.152503433887397, 1.1520764515645734, 1.1511941068525244, 1.1502758916999414, 1.1493520213844726, 1.1484527111837683, 1.1476081763754764, 1.1468486322372462, 1.146204294046727, 1.1453999812633913, 1.1437977202497245, 1.1421656306700885, 1.1405504305937904, 1.1389988380901364, 1.1375575712284318, 1.1362733480779834, 1.1351928867080967, 1.1338769192960254, 1.131349803937977, 1.1288267022819602, 1.1263695703988283, 1.1240403643594354, 1.1219010402346346, 1.1200135540952791, 1.118439862012223, 1.1165689315576273, 1.1131054102270623, 1.1097155296587038, 1.1064686419453573, 1.103434099179828, 1.1006812534549202, 1.0982794568634393, 1.09629806149819, 1.0939996479631007, 1.0899007540123125, 1.0859718932199927, 1.08227613541825, 1.078876550439194, 1.0758362081149329, 1.0732181782775758, 1.071085530759232, 1.0686740582393586, 1.0645365929493256, 1.0606578924561185, 1.0570812475300837, 1.0538499489415665, 1.0510072874609115, 1.0485965538584643, 1.0466610389045703, 1.0445299862390103, 1.04101674514226, 1.037797958879503, 1.0348923917942534, 1.032318808230026, 1.0300959725303354, 1.0282426490386951, 1.0267776020986203, 1.0252082173385018, 1.022723690959704, 1.0204982100697113, 1.0185324122281871, 1.016826934994794, 1.0153824159291942, 1.0141994925910507, 1.013278802540026, 1.012315538633775, 1.0108446831943076, 1.0095914722964465, 1.0085162750242151, 1.007579460461636, 1.006741397692731, 1.0059624558015234, 1.0052030038720356]


#rho plot
plot(pd.x, pd.data[:,1], xlims = (-1.1,1.1), label = "2D", title ="rho, t = 0.4")
plot!(pd.x, rho1d, label = "1D")
savefig("rho.png")

#vx plot
plot(pd.x, pd.data[:,2], xlims = (-1.1,1.1), label = "2D", title ="vx, t = 0.4")
plot!(pd.x, vx1d, label = "1D")
savefig("vx.png")

#theta plot
plot(pd.x, pd.data[:,3], xlims = (-1.1,1.1), ylims = (0.5, 1.5), label = "2D", title ="theta, t = 0.4")
plot!(pd.x, theta1d, label = "1D")
savefig("theta.png")
