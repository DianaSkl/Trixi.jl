using OrdinaryDiffEq
using Trixi
using Plots

tau = 0.4
equations = PerturbationMomentSystem2D(0.0, 0.0, 1.0, tau)

initial_condition = initial_condition_constant
surface_flux = flux_lax_friedrichs

boundary_condition = BoundaryConditionDirichlet(initial_condition)
boundary_conditions = (x_neg=boundary_condition, x_pos=boundary_condition, y_neg=boundary_condition, y_pos=boundary_condition)
volume_flux  = flux_lax_friedrichs
basis = LobattoLegendreBasis(3)
shock_indicator_variable = density_pressure
indicator_sc = IndicatorHennemannGassner(equations, basis,
                                         alpha_max=0.5,
                                         alpha_min=0.001,
                                         alpha_smooth=true,
                                         variable=shock_indicator_variable)
volume_integral = VolumeIntegralShockCapturingHG(indicator_sc;
                                                 volume_flux_dg=volume_flux,
                                                 volume_flux_fv=surface_flux)
solver = DGSEM(basis, surface_flux, volume_integral)
coordinates_min = (-1, -1)
coordinates_max = ( 1, 1)


mesh = TreeMesh(coordinates_min, coordinates_max, initial_refinement_level=6, n_cells_max=10_000, periodicity=false)

semi = SemidiscretizationHyperbolic(mesh, equations, initial_condition, solver, boundary_conditions=boundary_conditions, source_terms=source_terms_convergence_test)

tspan = (0.0, 0.4)
ode = semidiscretize(semi, tspan)

# At the beginning of the main loop, the SummaryCallback prints a summary of the simulation setup
# and resets the timers
summary_callback = SummaryCallback()

analysis_interval = 100

# The AnalysisCallback allows to analyse the solution in regular intervals and prints the results
analysis_callback = AnalysisCallback(semi, interval=100)

# das hier sorgt für die Ausgabe!
alive_callback = AliveCallback(analysis_interval=analysis_interval)


# The SaveSolutionCallback allows to save the solution to a file in regular intervals
save_solution = SaveSolutionCallback(interval=100,solution_variables=cons2prim)

# The StepsizeCallback handles the re-calculcation of the maximum Δt after each time step
stepsize_callback = StepsizeCallback(cfl=0.9)

save_restart = SaveRestartCallback(interval=100,save_final_restart=true)

# Create a CallbackSet to collect all callbacks such that they can be passed to the ODE solver
callbacks = CallbackSet(summary_callback, analysis_callback, alive_callback, save_solution, stepsize_callback, save_restart)



###############################################################################
# run the simulation

sol = solve(ode, CarpenterKennedy2N54(williamson_condition=false), dt=1.0, save_everystep=false, callback=callbacks);

# Print the timer summary
summary_callback()

pd = PlotData1D(sol; solution_variables=cons2prim)


rho1d = [2.9982919649469792, 2.998016340212291, 2.9977448878604878, 2.997460518780894, 2.9971461438628317, 2.9967846739956228, 2.996359020068591, 2.995852092971057, 2.9955238784989184, 2.9951999705057415, 2.9947951439734943, 2.9943038275861786, 2.993720450027797, 2.993039439982351, 2.9922552261338424, 2.991362237166273, 2.990783391643621, 2.9902416029740158, 2.9895716850921343, 2.988770060855632, 2.987833153122163, 2.9867573847493825, 2.985539178594946, 2.984174957516507, 2.9832951316158676, 2.9825117175124305, 2.981555746300679, 2.9804275867629673, 2.97912760768165, 2.977656177839081, 2.9760136660176144, 2.9742004409996032, 2.973035169200773, 2.9720436546103954, 2.97085197204087, 2.9694644853688654, 2.967885558471051, 2.966119555224093, 2.9641708395046606, 2.962043775189421, 2.96067066855159, 2.9595533627515014, 2.9582325192332752, 2.9567140346854406, 2.9550038057965273, 2.953107729255061, 2.95103170174957, 2.948781619968583, 2.947303151272071, 2.9461535787375, 2.9448177686428663, 2.9432993525031694, 2.9416019618334093, 2.9397292281485816, 2.9376847829636867, 2.9354722577937222, 2.933968487757702, 2.9328516080686424, 2.931575085361221, 2.9301372712279057, 2.928536517261165, 2.9267711750534646, 2.9248395961972733, 2.922740132285058, 2.9212432522127365, 2.920179520278011, 2.918980386472333, 2.917638071355783, 2.916144795488444, 2.9144927794303945, 2.9126742437417166, 2.9106814089824904, 2.909181722606577, 2.9081581248236064, 2.9070145935092704, 2.905738382394428, 2.904316745209943, 2.902736935686674, 2.9009862075554813, 2.899051814547226, 2.8975202742398385, 2.8965120565622997, 2.895389885218689, 2.8941381399132227, 2.8927412003501214, 2.8911834462336015, 2.8894492572678803, 2.887523013157175, 2.8859305660887022, 2.884916991259975, 2.883788198424901, 2.8825276886695805, 2.881118963080115, 2.8795455227426037, 2.877790868743147, 2.8758385021678436, 2.874163114914611, 2.873131525486181, 2.871978546288366, 2.8706881401254587, 2.869244269801755, 2.867630898121547, 2.8658319878891287, 2.8638315019087948, 2.8620527680948795, 2.8609923962157664, 2.859800273141801, 2.8584611004342926, 2.8569595796545495, 2.8552804123638795, 2.8534083001235904, 2.8513279444949897, 2.8494075035975808, 2.8482922298413063, 2.8470287047144818, 2.845600724356874, 2.8439920849082507, 2.842186582508376, 2.840168013297018, 2.837920173413942, 2.835758518102314, 2.8345120872144585, 2.833089545242438, 2.8314686291825493, 2.8296270760310875, 2.827542622784348, 2.825193006438629, 2.8225559639902236, 2.8199189236194937, 2.8183605563694587, 2.8165800935004555, 2.814538942265476, 2.8121985099175117, 2.8095202037095515, 2.806465430894587, 2.802995598725608, 2.799437583181921, 2.7972338051741223, 2.794742615369016, 2.791894063502604, 2.7886181993108905, 2.784845072529875, 2.7805047328955608, 2.7755272301439486, 2.770398814460793, 2.767088216090776, 2.763420935698206, 2.759280247221888, 2.754549424600627, 2.7491117417732256, 2.7428504726784886, 2.7356488912552197, 2.728294858208534, 2.723450850098623, 2.71821260793956, 2.712408598659931, 2.7058672891883226, 2.6984171464533198, 2.689886637383509, 2.6801042289074752, 2.670240703260804, 2.6637373168595064, 2.656872943794313, 2.649427252514846, 2.641179911470731, 2.6319105891115924, 2.621398953887054, 2.6094246742467395, 2.597466791263983, 2.589668544216101, 2.5816238410840855, 2.5730836716453727, 2.5637990256774037, 2.553520892957614, 2.5420002632634433, 2.5289881263723286, 2.51601959088003, 2.507702056000501, 2.4992984018276396, 2.4905575416772834, 2.4812283888652686, 2.471059856707431, 2.4598008585196087, 2.4472003076176363, 2.4345182824959433, 2.4265259928398617, 2.4185928830919576, 2.410488292745919, 2.4019815612954347, 2.392842028234192, 2.382839033055878, 2.371741915254182, 2.3602840371871308, 2.3531654201225187, 2.3461924519104365, 2.3391661113016124, 2.331887377046778, 2.324157227896662, 2.3157766426019943, 2.3065465999135037, 2.29659880970149, 2.290461428155396, 2.2844948374309673, 2.2785304489026985, 2.272399673945083, 2.2659339239326126, 2.2589646102397825, 2.251323144241084, 2.2426166591117562, 2.2372235582001743, 2.2319935582459665, 2.2267778592951317, 2.22142766139367, 2.21579416458758, 2.2097285689228614, 2.2030820744455117, 2.1950667383129723, 2.1900113766830436, 2.1851141218176537, 2.1802297976024603, 2.175213227923123, 2.1699192366652977, 2.1642026477146437, 2.157918284956818, 2.149980389021807, 2.1448112626526, 2.139827153508542, 2.1348688336969577, 2.129777075325173, 2.1243926505005106, 2.118556331330297, 2.112108889921855, 2.103711564459987, 2.0980284283397, 2.092608091718606, 2.0872636664624498, 2.0818082644369738, 2.0760549975079217, 2.069816977541035, 2.062907316402058, 2.053761192092575, 2.0473621163569202, 2.041353899122513, 2.035519706855798, 2.0296427060232243, 2.023506063091235, 2.016892944526278, 2.009586516794798, 1.999852216272657, 1.9929014648453478, 1.9864863715171408, 1.9803739367464643, 1.9743311609917467, 1.9681250447114145, 1.961522588363895, 1.954290792407616, 1.944628029702024, 1.9376794577798404, 1.931366911127253, 1.9254675130085424, 1.919758386687991, 1.9140166554298805, 1.9080194424984915, 1.9015438711581056, 1.8928407360828958, 1.8865985627783557, 1.8809962765921695, 1.8758476317171346, 1.8709663823460494, 1.866166282671709, 1.8612610868869115, 1.856064549184454, 1.8489629629048834, 1.8438984082691023, 1.8393796766742159, 1.8352704194765863, 1.831434288032577, 1.8277349336985493, 1.8240360078308666, 1.8202011617858913, 1.8147592793662755, 1.8108527944143038, 1.8073533961470059, 1.8041689673321213, 1.8012073907373924, 1.7983765491305586, 1.7955843252793608, 1.7927386019515394, 1.7884262589699196, 1.7851587181826158, 1.7821875879143643, 1.7794441391650868, 1.7768596429347032, 1.7743653702231357, 1.7718925920303046, 1.7693725793561308, 1.7652654919018003, 1.7617363565518283, 1.7584811542346142, 1.7554262385593276, 1.7524979631351378, 1.7496226815712144, 1.746726747476727, 1.7437365144608445, 1.7387034662772163, 1.7337568514268884, 1.729193403617194, 1.7249056205144382, 1.7207859997849255, 1.7167270390949607, 1.7126212361108493, 1.708361088498895, 1.7012725930901345, 1.693732468955096, 1.6868423638842862, 1.6804376898140752, 1.6743538586808338, 1.668426282420931, 1.662490372970737, 1.6563815422666224, 1.646506241107321, 1.6356743874997848, 1.6258963913325652, 1.6169409555119714, 1.6085767829443145, 1.6005725765359018, 1.5926970391930437, 1.58471887382205, 1.5722403292675238, 1.558492375031489, 1.5462354188014598, 1.5351828086561952, 1.5250478926744542, 1.5155440189349951, 1.506384535516578, 1.4972827904979606, 1.4835160662644626, 1.468476839668657, 1.455229912796156, 1.443466071450765, 1.4328761014362896, 1.4231507885565342, 1.4139809186153043, 1.4050572774164045, 1.3919955293288413, 1.377934352205149, 1.3656903597622247, 1.3549752305953326, 
1.3455006432997352, 1.3369782764706957, 1.3291198087034777, 1.3216369185933434, 1.3110172222411018, 1.2997783430360887, 1.2900929991367422, 1.2817300074373712, 1.2744581848322833, 1.2680463482157867, 1.2622633144821898, 1.2568779005258, 1.2494367091497567, 1.24168601495267, 1.2350608963208605, 1.2294025060694345, 1.2245519970135, 1.2203505219681634, 1.2166392337485317, 1.2132592851697122, 1.208672402366867, 1.2039370599070933, 1.1999031417846813, 1.1964770585326785, 1.1935652206841345, 1.191074038772097, 1.1889099233296148, 1.186979284889736, 1.184360966993038, 1.1816320078065456, 1.1792938240032473, 1.1772985182171865, 1.1755981930824075, 1.1741449512329538, 1.172890895302869, 1.1717881279261964, 1.1702542868302206, 1.1685878816200472, 1.167134663728327, 1.1658722472525345, 1.164778246290143, 1.1638302749386256, 1.1630059472954564, 1.1622828774581084, 1.1612358174468291, 1.1600213337383432, 1.1589392853116616, 1.1579787078082528, 1.157128636869585, 1.1563781081371254, 1.1557161572523424, 1.155131819856704, 1.1542650878778524, 1.153200623916282, 1.152239255908209, 1.1513741567281035, 1.1505984992504348, 1.1499054563496725, 1.1492882009002863, 1.148739905776746, 1.1479269960301606, 1.1468892695463502, 1.145945555090366, 1.1450905952524801, 1.1443191326229636, 1.143625909792088, 1.143005669350124, 1.1424531538873435, 1.1416442006855796, 1.1405758274059836, 1.1395969940953958, 1.1387041902871806, 1.1378939055147015, 1.1371626293113215, 1.1365068512104042, 1.135923060745313, 1.1350830711729993, 1.1339233364698278, 1.1328471465036491, 1.1318546966076175, 1.1309461821148874, 1.1301217983586123, 1.1293817406719469, 1.1287262043880446, 1.1278041435711559, 1.126452234601513, 1.1251761687503183, 1.1239829978635578, 1.1228797737872172, 1.121873548367282, 1.120971373449738, 1.1201803008805706, 1.1191003150071108, 1.1174117745998835, 1.1157952379117846, 1.1142676857288427, 1.1128460988370856, 1.1115474580225413, 1.1103887440712377, 1.1093869377692023, 1.1080668243136909, 1.1058996594244757, 1.1038145576173193, 1.1018391615521475, 1.100001113888885, 1.098328057287456, 1.0968476344077862, 1.0955874879098, 1.0939871634139728, 1.0912965436388147, 1.0887196903595415, 1.086291306075386, 1.084046093285582, 1.0820187544893618, 1.0802439921859581, 1.0787565088746043, 1.0769336678408123, 1.0738628612012404, 1.0709546334883742, 1.0682432327526843, 1.0657629070446417, 1.0635479044147162, 1.0616324729133786, 1.0600508605910994, 1.0581767368913213, 1.0550599389979642, 1.0521516351375453, 1.0494777121504613, 1.047064056877109, 1.0449365561578852, 1.0431210968331863, 1.0416435657434093, 1.0399475286830746, 1.037188120117727, 1.0346556331952272, 1.0323635780234353, 1.0303254647102116, 1.0285548033634162, 1.02706510409091, 1.0258698770005528, 1.0245389277545043, 1.022431898683077, 1.020531240636543, 1.0188395548174534, 1.0173594424283583, 1.0160935046718067, 1.0150443427503488, 1.0142145578665342, 1.0133172495195322, 1.011939528111044, 1.0107182382356825, 1.0096499032765955, 1.0087310466169312, 1.007958191639837, 1.0073278617284611, 1.006836580265951, 1.006318060666979, 1.0055445137684964, 1.0048888534342628, 1.0043290245269634, 1.0038429719092823, 1.003408640443904, 1.003003974993513, 1.0026069204207932]
vx1d = [0.0011764794577839503, 0.0013586279772530689, 0.0015419656397444076, 0.0017366354644345328, 0.0019527804705000138, 0.0022005436771174156, 0.0024900681034633076, 0.0028314967687142556, 0.003053868821027656, 0.0032762173885380968, 0.0035560736744425126, 0.0038953909535750218, 0.004296122500769741, 0.004760221590860789, 0.005289641498682284, 0.005886335499068342, 0.006268050588492085, 0.006638837338549545, 0.0070999348680582585, 0.00765078529117623, 0.008290830722061469, 0.009019513274871977, 0.009836275063765765, 0.010740558202900834, 0.011307151449565683, 0.01184237673352061, 0.012498604937608323, 0.01327094634559094, 0.014154511241230572, 0.01514440990828934, 0.016235752630529357, 0.017423649691712728, 0.01815405427575107, 0.018828810085664487, 0.01964351030861391, 0.020588475609958665, 0.021654026655058056, 0.022830484109271396, 0.024108168637957998, 0.025477400906477158, 0.02630822011370936, 0.02706294411260562, 0.027959337709538262, 0.028984501298634346, 0.030125535274020968, 0.031369540029825164, 0.03270361596017403, 0.03411486345919462, 0.034968099942944725, 0.03573509020328073, 0.0366303540376321, 0.03764069073599708, 0.038752899588373954, 0.039953779884760926, 0.041230130915156274, 0.042568751969558234, 0.043386067352073635, 0.044118377545605575, 0.04495820406630765, 0.045894766497463796, 0.046917284422357916, 0.04801497742427395, 0.0491770650864958, 0.05039276699230738, 0.05115320641345594, 0.051836920478841676, 0.05260821931294482, 0.053460084816359006, 0.0543854988896779, 0.055377443433495106, 0.05642890034840428, 0.05753285153499905, 0.058246923396270724, 0.058893470014093306, 0.05961306288020168, 0.06040232714742373, 0.06125788796858743, 0.06217637049652061, 0.06315439988405125, 0.0641886012840072, 0.06488013238826304, 0.0655101103005587, 0.06620447390961456, 0.06696260864772019, 0.0677838999471651, 0.06866773324023882, 0.06961349395923087, 0.07062056753643078, 0.07131153252187486, 0.0719425808922933, 0.0726335579691907, 0.07338569392940722, 0.07420021894978311, 0.07507836320715856, 0.07602135687837379, 0.07703043014026897, 0.07773530936917396, 0.07837832920471881, 0.07907919508631864, 0.07984041268753311, 0.08066448768192185, 0.08155392574304447, 0.0825112325444606, 0.08353891375972987, 0.08426702374482942, 0.08492871008228231, 0.08564759372259499, 0.08642737051683148, 0.08727173631605586, 0.08818438697133207, 0.08916901833372418, 0.09022932625429617, 0.09099279464071396, 0.09168241264396702, 0.09243033727023221, 0.09324205431133645, 0.09412304955910662, 0.0950788088053696, 0.09611481784195229, 0.09723656246068156, 0.09806536329935943, 0.0988066843027535, 0.09961091025850509, 0.10048704140016092, 0.1014440779612677, 0.10249102017537207, 0.10363686827602077, 0.10489062249676047, 0.10585691447818976, 0.10670611239165055, 0.1076289789686943, 0.10864138057294517, 0.10975918356802733, 0.11099825431756495, 0.11237445918518219, 0.1139036645345032, 0.1151484043660198, 0.11621088518930281, 0.11736556821073632, 0.11864015915398586, 0.12006236374271703, 0.1216598877005954, 0.12346043675128648, 0.12549171661845582, 0.12722864785859775, 0.12865560243178495, 0.13019821809065055, 0.1319014724000512, 0.13381034292484362, 0.13596980722988447, 0.13842484288003037, 0.14122042744013805, 0.14368507279591872, 0.1456293939584163, 0.14770855068242367, 0.1499882335807767, 0.15253413326631127, 0.15541194035186312, 0.15868734545026808, 0.16242603917436196, 0.16576351925354843, 0.1682982482669108, 0.17097016395873002, 0.1738642777512539, 0.17706560106673028, 0.18065914532740698, 0.18472992195553178, 0.18936294237335247, 0.19350314729912688, 0.19654365917435654, 0.19969898123753987, 0.20306597262944354, 0.2067414924908344, 0.21082239996247912, 0.2154055541851443, 0.2205878142995967, 0.2251994306254125, 0.22849183495566092, 0.23185655889684756, 0.23539094140715477, 0.23919232144476493, 0.24335803796786032, 0.2479854299346232, 0.2531718363032359, 0.25776659063260493, 0.2609779227736409, 0.26421623978140313, 0.26756894899989314, 0.27112345777311275, 0.2749671734450636, 0.2791875033597473, 0.2838718548611654, 0.28802234489690837, 0.2908891706036794, 0.2937534600465299, 0.29668722201402375, 0.2997624652947247, 0.3030511986771966, 0.3066254309500032, 0.3105571709017083, 0.3140739628881103, 0.3165018785435379, 0.3189197767029566, 0.3213843941376612, 0.3239524676189467, 0.3266807339181078, 0.32962592980643945, 0.3328447920552364, 0.33578674131918623, 0.33783586102366103, 0.33988133021710765, 0.34196849686045816, 0.3441427089146446, 0.34644931434059895, 0.3489336610992533, 0.35164109715153946, 0.3541970444486287, 0.35599798722516934, 0.35780242399073403, 
0.35964974174791353, 0.36157932749929866, 0.36363056824748013, 0.36584285099504876, 0.36825556274459526, 0.3706252933801488, 0.3723077330685617, 0.3739918110611985, 0.37571641074982, 0.37752041552618704, 0.3794427087820601, 0.38152217390920007, 0.38379769429936744, 0.3861339429078854, 0.3877941789113302, 0.3894402430639974, 0.3911148984020883, 0.39286090796180445, 0.3947210347793475, 0.39673804189091866, 0.3989546923327194, 0.4013381339322719, 0.40302042930996745, 0.4046586927426395, 0.40630154098583554, 0.4079975907951036, 0.40979545892599106, 0.41174376213404573, 0.4138911171748153, 0.4163031273166846, 0.4179765973224694, 0.4195689348607321, 0.4211328973913788, 0.4227212423743156, 0.42438672726944837, 0.42618210953668323, 0.428160146635926, 0.4304687417560319, 0.43201923160681655, 0.43345842471153806, 0.4348379568306603, 0.43620946372464686, 0.43762458115396147, 0.4391349448790677, 0.4407921906604291, 0.44279591221042175, 0.44406636369561675, 0.4452174747303179, 0.446293308271358, 0.44733792727556926, 0.4483953946997845, 0.449509773500836, 0.4507251266355564, 0.45225711490192644, 0.4531295634219879, 0.4539017571838652, 0.4546058041149955, 0.4552738121428159, 0.4559378891947633, 0.4566301431982749, 0.4573826820807875, 0.45839687117386146, 0.4588486623755348, 0.45923662243485736, 0.4595802101681491, 0.4598988843917301, 0.46021210392192036, 0.4605393275750398, 0.46090001416740833, 0.46145522764236013, 0.46152858716389156, 0.46157680816800006, 0.4616084937664807, 0.46163224707112877, 0.46165667119373877, 0.46169036924610596, 0.46174194434002525, 0.4618983916578665, 0.46160566552221166, 0.46132270651478585, 0.4610488030719836, 0.4607832436301997, 0.46052531662582885, 0.4602743104952658, 0.460029513674905, 0.459750224873854, 0.4589940436337232, 0.45828636493477365, 0.45761650871776133, 0.4569737949234426, 0.4563475434925732, 0.4557270743659093, 0.4551017074842068, 0.4542306811041093, 0.4527994650265006, 0.45147358146048466, 0.45022971977810544, 0.44904456935140663, 0.44789481955243193, 0.4467571597532251, 0.44560827932582975, 0.44393748309584813, 0.44158899216333747, 0.43943037126695667, 0.43742304755176925, 0.43552844816283853, 0.4337080002452281, 0.4319231309440012, 0.43013526740422126, 0.42753408523434666, 0.42414296969363624, 0.421050401404518, 0.41820247813564243, 0.41554529765566006, 0.4130249577332213, 0.41058755613697645, 0.4081791906355761, 0.40474062303963826, 0.4004576427070017, 0.39658530808774684, 0.39305831632665333, 0.389811364568501, 0.3867791499580694, 0.3838963696401382, 0.3810977207594868, 0.3772222590085625, 0.3725460523074612, 0.36835844335422446, 0.3645903590478217, 0.3611727262872218, 0.35803647197139393, 0.3551125229993071, 0.3523318062699304, 0.3486325095693816, 0.344262825469607, 0.34038473512023326, 0.33693530918970693, 0.3338516183464745, 0.3310707332589823, 0.32852972459567675, 0.3261656630250043, 0.32317126892926334, 0.31965524263925504, 
0.31654894977001213, 0.31380491837538677, 0.3113756765092319, 0.30921375222539976, 0.3072716735777429, 0.30550196862011375, 0.3033856337137263, 0.300848480882203, 0.2985947649114264, 0.2965967311357292, 0.29482662488944433, 0.2932566915069046, 0.2918591763224426, 0.29060632467039127, 0.2891977672355231, 0.2874079588358494, 0.2857878311360447, 0.28432681968851814, 0.28301436004567904, 0.2818398877599364, 0.2807928383836994, 0.27986264746937717, 0.27887008533246094, 0.2774986664086648, 0.2762243941510893, 0.27504789009981967, 0.2739697757949413, 0.2729906727765391, 0.2721112025846983, 0.27133198675950393, 0.2705226977144892, 0.2693237739853036, 0.26818681085584034, 0.26711829503320905, 0.2661247132245195, 0.26521255213688133, 0.26438829847740414, 0.2636584389531975, 0.26290340744380997, 0.2617443359196885, 0.260633521171864, 0.2595803481929833, 0.2585942019756934, 0.25768446751264074, 0.2568605297964723, 0.25613177381983476, 0.25537246693184196, 0.2541881006602315, 0.2530463513745795, 0.25195876739136297, 0.2509368970270594, 0.24999228859814604, 0.24913649042110003, 0.24838105081239867, 0.24758342542150832, 0.2463189190793606, 0.24509131386302987, 0.2439155511391315, 0.2428065722742812, 0.24177931863509433, 0.24084873158818645, 0.24002975250017303, 0.2391468070085996, 0.2377060759915147, 0.23629253087079177, 0.23492781593505724, 0.2336335754729374, 0.2324314537730584, 0.23134309512404666, 0.23039014381452844, 0.22933317988253912, 0.22753703637753073, 0.2257556913830626, 0.22402267976843573, 0.2223715364029514, 0.22083579615591073, 0.21944899389661482, 0.21824466449436483, 0.21687101775817114, 0.21444920167963302, 0.21203684465304992, 0.20968470532561553, 0.2074435423445236, 
0.20536411435696772, 0.20349718001014164, 0.20189349795123895, 0.200032823266159, 0.19669194573547474, 0.19338019947067506, 0.19016741505121013, 0.1871234230565302, 0.18431805406608545, 0.18182113865932603, 0.17970250741570212, 0.17723709197214904, 0.17281926611111048, 0.16849221439294396, 0.16433938226457406, 0.16044421517292534, 0.15689015856492228, 0.15376065788748944, 0.15113915858755125, 0.14811359818948988, 0.14278075981106264, 0.13764162102610114, 0.1327797993636112, 0.1282789123525989, 0.12422257752207005, 0.12069441240103065, 0.11777803451848662, 0.11446395243997179, 0.10876855567477814, 0.1033809420076306, 0.09836834869864602, 0.0937980130079412, 0.08973717219563292, 0.08625306352183797, 0.08341292424667313, 0.08024943222776872, 0.0749760459008109, 0.0700852452365012, 0.06561694280984266, 0.06161105119583839, 0.058107482969491406, 0.055146150705804795, 0.052766966979781615, 0.050176696270756084, 0.046001110020347104, 0.04220566364801346, 0.038803634731846705, 0.03580830084993848, 0.03323293958038034, 0.03109082850126385, 0.029395245190680624, 0.027593957115570108, 0.024790605855324825, 0.02229249304878624, 0.02009623886832242, 0.018198463486301424, 0.016595787075091305, 0.01528482980706013, 0.01426221185457595, 0.013198856706161171, 0.011596424510144443, 0.010233653558947333, 0.009066715949406374, 0.008051783778358081, 0.007145029142638975, 0.006302624139085579, 0.005480740864534412]
theta1d = [0.999163142541414, 0.999034438154652, 0.9989038343433592, 0.9987647081191735, 0.9986104364937337, 0.9984343964786769, 0.9982299650856417, 0.9979905193262659, 0.9978232291987399, 0.9976678317659298, 0.9974696903741116, 0.9972282974618393, 0.9969431454676673, 0.9966137268301495, 0.9962395339878398, 0.9958200593792925, 0.9955351820602624, 0.9952737507370799, 0.9949462351686895, 0.9945539630774409, 0.994098262185684, 0.9935804602157678, 0.9930018848900425, 0.9923638639308571, 0.991942121018967, 0.9915618114095945, 0.9910939029245195, 0.9905427769887654, 0.9899128150273558, 0.9892083984653143, 0.9884339087276638, 0.987593727239428, 0.9870483986862485, 0.9865656399764327, 0.9859823743664989, 0.9853063990956847, 0.9845455114032284, 0.983707508528368, 0.9828001877103407, 0.9818313461883846, 0.9812067882535666, 0.9806636347582081, 0.9800196489172125, 0.9792850256447786, 0.9784699598551045, 0.9775846464623877, 0.9766392803808268, 0.9756440565246196, 0.9749968264190543, 0.9744427045118985, 0.973798493308889, 0.973074810669746, 0.9722822744541892, 0.9714315025219383, 0.970533112732713, 0.9695977229462328, 0.9689715335604613, 0.9684421414191218, 0.9678386485289532, 0.9671702543375045, 0.9664461582923259, 0.9656755598409672, 0.9648676584309777, 0.964031653509907, 0.9634431682001761, 0.9629505446417269, 0.9623987757887289, 0.9617948102915644, 0.9611455968006167, 0.960458083966268, 0.9597392204389013, 0.9589959548688988, 0.9584379160139227, 0.9579751615613705, 0.9574635980002566, 0.956908176408637, 0.9563138478645679, 0.9556855634461043, 0.955028274231303, 0.9543469312982192, 0.9538010690690746, 0.9533539125882037, 0.9528632163421137, 0.9523327587787992, 0.9517663183462549, 0.9511676734924757, 0.950540602665456, 0.9498888843131909, 0.9493373475017151, 0.9488932701834131, 0.948407119604067, 0.9478823623519498, 0.9473224650153349, 0.9467308941824948, 0.946111116441703, 0.9454665983812325, 0.9448969767435612, 0.9444487042398558, 0.9439575328397326, 0.9434272879531393, 0.9428617949900229, 0.9422648793603302, 0.9416403664740085, 0.9409920817410049, 0.9403981607963734, 0.9399439069497119, 0.939444829995115, 0.9389056738815825, 0.9383311825581148, 0.9377260999737105, 0.9370951700773693, 0.9364431368180909, 0.9358262014377187, 0.935370647643274, 0.9348683374447836, 0.9343256433344576, 0.9337489378045083, 0.9331445933471463, 0.9325189824545832, 0.9318784776190298, 0.9312532648699982, 0.9308122388998447, 0.9303239269261556, 0.9297975175021839, 0.9292421991811817, 0.9286671605164015, 0.9280815900610957, 0.9274946763685167, 0.9269009972796428, 0.9265100275028263, 0.926074346133797, 0.9256078365926632, 0.9251243822995319, 0.9246378666745106, 0.9241621731377075, 0.9237111851092298, 0.9232253159599343, 0.9229467603192958, 0.9226301037439568, 0.9222962941884061, 0.921966279607132, 0.9216610079546227, 0.9214014271853666, 0.9212084852538521, 0.9209392263446965, 0.9208565154587038, 0.9207447595252414, 0.9206339789726006, 0.9205541942290734, 0.9205354257229509, 0.9206076938825246, 0.9208010191360863, 0.9208545670103925, 0.9210436544813815, 0.9212103814909676, 0.9213941697003203, 0.921634440770611, 0.921970616363009, 0.9224421181386853, 
0.9230883677588098, 0.9235057800677948, 0.9239900582556968, 0.9244504577322505, 0.9249334523344771, 0.9254855158993982, 0.9261531222640349, 0.9269827452654087, 0.9280208587405406, 0.9287244283330017, 0.9294413701388325, 0.930122347502739, 0.9308161614570446, 0.9315716130340725, 0.9324375032661456, 0.9334626331855875, 0.9346958038247207, 0.935494077171687, 0.9363060977050933, 0.9370635751069746, 0.9378123277260345, 0.9385981739109777, 0.9394669320105077, 0.9404644203733283, 0.9416364573481436, 0.9423027440966607, 0.9430554809309948, 0.9437368001768238, 0.9443857313719913, 0.9450413040543415, 0.9457425477617174, 0.9465284920319631, 0.947438166402922, 0.9478112762917146, 0.9483989181560013, 0.9489059467059371, 0.949363158062763, 0.9498013483477207, 0.9502513136820502, 0.9507438501869927, 0.951309753983789, 0.9513390041064428, 0.9517267981982045, 0.9520324254771327, 0.9522785984834716, 0.9524880297574652, 0.9526834318393563, 0.9528875172693896, 0.953122998587808, 0.9528312344555471, 0.9530250271508098, 0.9531393619707534, 0.9531889446152549, 0.9531884807841914, 0.9531526761774399, 0.9530962364948775, 0.953033867436381, 0.9524413309860823, 0.9524362621317314, 0.9523576080447078, 0.9522105791464857, 0.9520003858585385, 0.9517322386023398, 0.9514113477993635, 0.9510429238710832, 0.950112721597307, 0.9498607456048498, 0.9495485144053314, 0.9491683803708526, 0.9487126958735157, 0.9481738132854208, 0.9475440849786698, 0.9468158633253638, 0.9454591976118631, 0.9448804642943501, 0.9442698791555212, 0.9436032392780835, 0.9428563417447449, 0.9420049836382122, 0.941024962041193, 0.9398920740363943, 0.9380403819307057, 0.9370825814085021, 0.9361403416420498, 0.9351720329884856, 0.9341360258049459, 0.9329906904485668, 0.9316943972764846, 0.9302055166458353, 0.9279177534363525, 0.9266368733554425, 0.9254301352898288, 0.924243440900582, 0.9230226918487731, 0.9217137897954725, 0.9202626364017505, 0.9186151333286778, 0.9161444234126356, 0.9147467702037293, 0.9134716857869839, 0.9122634152917819, 0.9110662038475068, 0.9098242965835402, 0.9084819386292655, 0.9069833751140649, 0.9047201576629121, 0.9035056181121843, 0.9024278854246733, 0.9014420209075019, 0.9005030858677925, 0.8995661416126678, 0.8985862494492498, 0.8975184706846615, 0.8958123046487839, 0.8950329484249074, 0.8943622484023683, 0.8937744798851515, 0.8932439181772429, 0.8927448385826263, 0.8922515164052874, 0.8917382269492107, 0.8907388406398389, 
0.8904925417312681, 0.8902996935417544, 0.8901554791850251, 0.8900550817748074, 0.8899936844248276, 0.8899664702488133, 0.8899686223604909, 0.889641402210402, 0.8899141531832523, 0.8901811695096301, 0.8904559918101969, 0.890752160705614, 0.8910832168165421, 0.8914627007636429, 0.8919041531675772, 0.8922043385576353, 0.8930305258770223, 0.893794674048907, 0.8945269541841978, 0.8952575373938022, 0.8960165947886278, 0.8968342974795829, 0.8977408165775745, 0.8987852081294762, 0.900385927170566, 0.9018542071315278, 0.9032393476956337, 0.9045906485461571, 0.9059574093663699, 0.9073889298395443, 0.9089345096489532, 0.911034444456226, 0.9138162260834584, 0.9163535270080329, 0.9187208085081062, 0.9209925318618365, 0.9232431583473805, 0.9255471492428953, 0.9279789658265379, 0.9315023860319398, 0.9358842702862471, 0.9398520739024089, 0.9435107295694187, 0.9469651699762701, 0.9503203278119557, 0.9536811357654695, 0.9571525265258042, 0.962265946990509, 0.9683856432543058, 0.9738775206347894, 0.978876451849334, 0.9835173096153146, 0.9879349666501046, 0.9922642956710783, 0.9966401693956097, 1.0030378507445556, 1.0104619639963122, 1.0170503618519566, 1.0229587849385313, 1.0283429738830778, 1.033358669312638, 1.038161611854254, 1.0429075421349674, 1.0497045248638035, 1.0573578945042874, 1.0640538281200838, 1.0699522977603275, 1.0752132754741535, 1.079996733310697, 1.0844626433190923, 1.0887709775484746, 1.0947686675422879, 1.1013068910970694, 1.1069264924973146, 1.1117711152505392, 1.115984402864259, 1.1197099988459882, 1.123091546703243, 1.126272689943538, 1.1305610811107398, 1.135068758833379, 1.1388581968997524, 1.1420390673637884, 1.1447210422794147, 1.147013793700559, 1.149026993681149, 1.1508703142751124, 1.1532775890250484, 1.1556928926768248, 1.1576586146813912, 1.1592443610434857, 1.16051973776785, 1.161554350859222, 1.162417806322343, 1.1631797101619517, 1.1641511910415376, 1.16503851541075, 1.1657037588472252, 1.1661835719069638, 1.1665146051459658, 1.1667335091202315, 1.1668769343857608, 1.1669815314985539, 1.1671238263838988, 1.1671554760028624, 1.1671053343697186, 1.1669898165251742, 1.1668253375099351, 1.1666283123647074, 1.166415156130197, 1.1662022838471098, 1.165963760248951, 1.1656071827293089, 1.1652361727294913, 1.1648574704336543, 1.1644778160259537, 1.164103949690545, 1.1637426116115839, 1.163400541973226, 1.163015304318583, 1.1625033851344924, 1.162003308180664, 1.1615182246031315, 1.1610512855479287, 1.1606056421610889, 1.160184445588645, 1.159790846976631, 1.159350009817553, 1.1587665588455522, 1.158203123050148, 1.1576622340351925, 1.1571464234045385, 1.1566582227620377, 1.1562001637115427, 1.1557747778569052, 1.1552985303082741, 1.1546501096284254, 1.1540221401801705, 1.1534184430704322, 1.152842839406133, 1.152299150294195, 1.151791196841541, 1.1513228001550933, 1.1507941567183413, 1.1500353804215386, 1.1492928439172196, 1.1485739858612554, 1.1478862449095175, 1.1472370597178774, 1.1466338689422064, 1.146084111238376, 1.1454535692121663, 1.1444821585037221, 1.1435199947471895, 1.1425814565394221, 1.1416809224772742, 1.1408327711575983, 1.1400513811772488, 1.1393511311330788, 1.1385339692418726, 1.1371874266248188, 1.1358454942729406, 1.134533198420858, 1.1332755653031896, 1.132097621154555, 1.1310243922095728, 1.1300809047028626, 1.1289694226213756, 1.1270572120198248, 1.1251571957309239, 1.1233072672350743, 1.1215453200126781, 
1.1199092475441361, 1.1184369433098502, 1.1171663007902213, 1.11567193924362, 1.1130611247297637, 1.1104935940008285, 1.108018369452892, 1.1056844734820315, 1.1035409284843232, 1.1016367568558454, 1.1000209809926744, 1.0981412925831717, 1.094874670968648, 1.0917104871392733, 1.088701697157677, 1.085901257086487, 1.0833621229883317, 1.0811372509258401, 1.0792795969616404, 1.0771552223393592, 1.0735313345220527, 1.070084982672466, 1.0668619905179315, 1.0639081817857812, 1.061269380203346, 1.058991409497958, 1.0571200933969487, 1.0550250910576524, 1.0515458984435078, 1.0483042242106932, 1.0453293442006704, 1.0426505342549022, 1.0402970702148495, 1.0382982279219743, 1.0366832832177386, 1.0349181709247475, 1.0320786334554033, 1.0294890003763875, 1.0271601467972091, 1.0251029478273792, 1.0233282785764073, 1.0218470141538032, 1.0206700296690767, 1.0194162879775632, 1.0174678119510996, 1.0157280856635211, 1.0141955006657155, 1.0128684485085713, 1.0117453207429763, 1.010824508919818, 1.0101044045899847, 1.0093543251016002, 1.0082249491768889, 1.0072635578837383, 1.0064393213721456, 1.0057214097921097, 1.005078993293627, 1.0044812420266953, 1.0038973261413122]


#rho plot
plot(pd.x, pd.data[:,1], xlims = (-1.1,1.1), ylims = (1.0, 3.0), label = "2D", title ="rho, t = 0.4, tau = "*string(tau)*", B ="*string(1/tau))
plot!(pd.x, rho1d, label = "1D")
#savefig("rho.png")

#vx plot
plot(pd.x, pd.data[:,2], xlims = (-1.1,1.1), label = "2D", title ="vx, t = 0.4, tau = "*string(tau)*", B ="*string(1/tau))
plot!(pd.x, vx1d, label = "1D")
#savefig("vx.png")

#theta plot
# plot(pd.x, pd.data[:,3], xlims = (-1.1,1.1), ylims = (0.5, 1.5), label = "2D", title ="theta, t = 0.4, tau = "*string(tau)*", B ="*string(1/tau))
# plot!(pd.x, theta1d, label = "1D")
#savefig("theta.png")


