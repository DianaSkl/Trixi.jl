using OrdinaryDiffEq
using Trixi
using Plots

equations = PerturbationMomentSystem1D(0.0, 1.0)

initial_condition = initial_condition_constant
surface_flux = flux_lax_friedrichs

boundary_condition = BoundaryConditionDirichlet(initial_condition)
boundary_conditions = (x_neg=boundary_condition, x_pos=boundary_condition)
volume_flux  = flux_lax_friedrichs
basis = LobattoLegendreBasis(3)
shock_indicator_variable = density_pressure
indicator_sc = IndicatorHennemannGassner(equations, basis,
                                         alpha_max=0.5,
                                         alpha_min=0.001,
                                         alpha_smooth=true,
                                         variable=shock_indicator_variable)
volume_integral = VolumeIntegralShockCapturingHG(indicator_sc;
                                                 volume_flux_dg=volume_flux,
                                                 volume_flux_fv=surface_flux)
solver = DGSEM(basis, surface_flux, volume_integral)

coordinates_min = (-1,)
coordinates_max = ( 1,)

mesh = TreeMesh(coordinates_min, coordinates_max, initial_refinement_level=9, n_cells_max=10_000, periodicity=false)
#semi = SemidiscretizationHyperbolic(mesh, equations, initial_condition, solver)
semi = SemidiscretizationHyperbolic(mesh, equations, initial_condition, solver, boundary_conditions=boundary_conditions)

tspan = (0.0, 0.8)
ode = semidiscretize(semi, tspan)

# At the beginning of the main loop, the SummaryCallback prints a summary of the simulation setup
# and resets the timers
summary_callback = SummaryCallback()

analysis_interval = 100

# The AnalysisCallback allows to analyse the solution in regular intervals and prints the results
analysis_callback = AnalysisCallback(semi, interval=100)

# das hier sorgt für die Ausgabe!
alive_callback = AliveCallback(analysis_interval=analysis_interval)


# The SaveSolutionCallback allows to save the solution to a file in regular intervals
save_solution = SaveSolutionCallback(interval=100,solution_variables=cons2prim)

# The StepsizeCallback handles the re-calculcation of the maximum Δt after each time step
stepsize_callback = StepsizeCallback(cfl=0.9)

save_restart = SaveRestartCallback(interval=100,save_final_restart=true)

# Create a CallbackSet to collect all callbacks such that they can be passed to the ODE solver
callbacks = CallbackSet(summary_callback, analysis_callback, alive_callback, save_solution, stepsize_callback, save_restart)



###############################################################################
# run the simulation

sol = solve(ode, CarpenterKennedy2N54(williamson_condition=false), dt=1.0, save_everystep=false, callback=callbacks);

# Print the timer summary
summary_callback()

pd = PlotData1D(sol; solution_variables=cons2prim)

# t = 0.4
x =[-0.9966666666666667, -0.99, -0.9833333333333333, -0.9766666666666667, -0.97, -0.9633333333333334, -0.9566666666666667, -0.95, -0.9433333333333334, -0.9366666666666666, -0.9299999999999999, -0.9233333333333333, -0.9166666666666666, -0.91, -0.9033333333333333, -0.8966666666666666, -0.89, -0.8833333333333333, -0.8766666666666667, -0.87, -0.8633333333333333, -0.8566666666666667, -0.85, -0.8433333333333333, -0.8366666666666667, -0.83, -0.8233333333333334, -0.8166666666666667, -0.81, -0.8033333333333333, -0.7966666666666666, -0.79, -0.7833333333333333, -0.7766666666666666, -0.77, -0.7633333333333333, -0.7566666666666666, -0.75, -0.7433333333333333, -0.7366666666666666, -0.73, -0.7233333333333334, -0.7166666666666667, -0.71, -0.7033333333333334, -0.6966666666666667, -0.69, -0.6833333333333333, -0.6766666666666666, -0.6699999999999999, -0.6633333333333333, -0.6566666666666666, -0.6499999999999999, -0.6433333333333333, -0.6366666666666667, -0.6299999999999999, -0.6233333333333333, -0.6166666666666667, -0.61, -0.6033333333333333, -0.5966666666666667, -0.59, -0.5833333333333333, -0.5766666666666667, -0.57, -0.5633333333333332, -0.5566666666666666, -0.55, -0.5433333333333332, -0.5366666666666666, -0.53, -0.5233333333333333, -0.5166666666666666, -0.51, -0.5033333333333333, -0.4966666666666666, -0.49, -0.4833333333333333, -0.4766666666666667, -0.47, -0.46333333333333326, -0.45666666666666667, -0.44999999999999996, -0.44333333333333325, -0.43666666666666665, -0.42999999999999994, -0.42333333333333334, -0.41666666666666663, -0.4099999999999999, -0.4033333333333333, -0.3966666666666666, -0.39, -0.3833333333333333, -0.3766666666666666, -0.37, -0.3633333333333333, -0.3566666666666666, -0.35, -0.34333333333333327, -0.33666666666666667, -0.32999999999999996, -0.32333333333333325, -0.31666666666666665, -0.30999999999999994, -0.30333333333333334, -0.29666666666666663, -0.2899999999999999, -0.2833333333333333, -0.2766666666666666, -0.2699999999999999, -0.2633333333333333, -0.2566666666666666, -0.25, -0.2433333333333333, -0.23666666666666658, -0.22999999999999998, -0.22333333333333327, -0.21666666666666656, -0.20999999999999996, -0.20333333333333325, -0.19666666666666666, -0.18999999999999995, -0.18333333333333324, -0.17666666666666664, -0.16999999999999993, -0.16333333333333333, -0.15666666666666662, -0.1499999999999999, -0.1433333333333333, -0.1366666666666666, -0.1299999999999999, -0.1233333333333333, -0.11666666666666659, -0.10999999999999999, -0.10333333333333328, -0.09666666666666657, -0.08999999999999997, -0.08333333333333326, -0.07666666666666666, -0.06999999999999995, -0.06333333333333324, -0.05666666666666664, -0.04999999999999993, -0.043333333333333224, -0.036666666666666625, -0.029999999999999916, -0.023333333333333317, -0.016666666666666607, -0.009999999999999898, -0.0033333333333332993, 0.0033333333333334103, 0.010000000000000009, 0.01666666666666683, 0.023333333333333428, 0.030000000000000027, 0.036666666666666625, 0.043333333333333446, 0.050000000000000044, 0.05666666666666664, 0.06333333333333346, 0.07000000000000006, 0.07666666666666666, 0.08333333333333348, 0.09000000000000008, 0.09666666666666668, 0.1033333333333335, 0.1100000000000001, 0.1166666666666667, 0.1233333333333333, 0.13000000000000012, 0.13666666666666671, 0.1433333333333333, 0.15000000000000013, 0.15666666666666673, 0.16333333333333333, 0.17000000000000015, 0.17666666666666675, 0.18333333333333335, 0.19000000000000017, 0.19666666666666677, 0.20333333333333337, 0.2100000000000002, 0.21666666666666679, 0.22333333333333338, 0.22999999999999998, 0.2366666666666668, 0.2433333333333334, 0.25, 0.2566666666666668, 0.2633333333333334, 0.27, 0.27666666666666684, 0.28333333333333344, 0.29000000000000004, 0.29666666666666686, 0.30333333333333345, 0.31000000000000005, 0.31666666666666665, 0.3233333333333335, 0.33000000000000007, 0.33666666666666667, 0.3433333333333335, 0.3500000000000001, 0.3566666666666667, 0.3633333333333335, 0.3700000000000001, 0.3766666666666667, 0.3833333333333335, 0.3900000000000001, 0.3966666666666667, 0.4033333333333333, 0.41000000000000014, 0.41666666666666674, 0.42333333333333334, 0.43000000000000016, 0.43666666666666676, 0.44333333333333336, 0.4500000000000002, 0.4566666666666668, 0.4633333333333334, 0.4700000000000002, 0.4766666666666668, 0.4833333333333334, 0.49, 0.4966666666666668, 0.5033333333333334, 0.51, 0.5166666666666668, 0.5233333333333334, 0.53, 0.5366666666666668, 0.5433333333333334, 0.55, 0.5566666666666669, 0.5633333333333335, 0.5700000000000001, 0.5766666666666667, 0.5833333333333335, 0.5900000000000001, 0.5966666666666667, 0.6033333333333335, 0.6100000000000001, 0.6166666666666667, 0.6233333333333335, 0.6300000000000001, 0.6366666666666667, 0.6433333333333335, 0.6500000000000001, 0.6566666666666667, 0.6633333333333333, 0.6700000000000002, 0.6766666666666667, 0.6833333333333333, 0.6900000000000002, 0.6966666666666668, 0.7033333333333334, 0.7100000000000002, 0.7166666666666668, 0.7233333333333334, 0.7300000000000002, 0.7366666666666668, 0.7433333333333334, 0.7500000000000002, 0.7566666666666668, 0.7633333333333334, 0.77, 0.7766666666666668, 0.7833333333333334, 0.79, 0.7966666666666669, 0.8033333333333335, 0.81, 0.8166666666666669, 0.8233333333333335, 0.8300000000000001, 0.8366666666666669, 0.8433333333333335, 0.8500000000000001, 0.8566666666666667, 0.8633333333333335, 0.8700000000000001, 0.8766666666666667, 0.8833333333333335, 0.8900000000000001, 0.8966666666666667, 0.9033333333333335, 0.9100000000000001, 0.9166666666666667, 0.9233333333333336, 0.9300000000000002, 0.9366666666666668, 0.9433333333333334, 0.9500000000000002, 0.9566666666666668, 0.9633333333333334, 0.9700000000000002, 0.9766666666666668, 0.9833333333333334, 0.9900000000000002, 0.9966666666666668];
rho = [2.867092151974337, 2.8671180148956505, 2.8671514952970543, 2.8671716343335514, 2.8671756887844704, 2.867172984445533, 2.86714515650005, 2.867098009219905, 2.867060351008143, 2.8670458226559274, 2.867044871458485, 2.867061150333786, 2.8671173027089574, 2.867173958852563, 2.867201175497854, 2.8672020663674673, 2.8671924909094484, 2.867136457466426, 2.867056686061923, 2.867011907820869, 2.8670134338873137, 2.8670289717867856, 2.867096655509468, 2.867221847244562, 2.86733511600457, 2.8673616731560028, 2.867350658437551, 2.8672945311412574, 2.867132610671212, 2.8669339262697795, 2.866781099478093, 2.8667309787631576, 2.8667327305832773, 2.8668265374081985, 2.867027487364155, 2.8672670381812866, 2.8674975760374517, 2.8676561085482053, 2.86775336881478, 2.867745722919303, 2.867690782842947, 2.867574734821834, 2.8674453848969974, 2.8673280895024864, 2.8670323799158526, 2.866028176186909, 2.862338559036995, 2.850841202886505, 2.824528882097027, 2.7794384369987917, 2.7178505691876413, 2.6440095807449433, 2.563603476754713, 2.4831757884695604, 2.409424631663613, 2.3484155306970034, 2.3048493041310056, 2.28152811726114, 2.2720124590980486, 2.2678154340083507, 2.266304677886037, 2.2659126479833622, 2.265689087151069, 2.265457578839754, 2.2652924970921564, 2.26522283426036, 2.265347748206013, 2.265655586963299, 2.265995068768939, 2.2663142682849964, 2.2664970998162897, 2.2665846278004116, 2.266675737237983, 2.2667575740556245, 2.2667945116760877, 2.2668007856350236, 2.266767585349317, 2.266739832985937, 2.2667355250578387, 2.266753687274271, 2.266772791978786, 2.2667744583752745, 2.266758185115136, 2.2667326159991923, 2.2667165180588027, 2.2667127131203415, 2.266724300598045, 2.266735283952273, 2.2667346107149524, 2.2667321791269863, 2.2667247185268136, 2.266712744556755, 2.2666988635087106, 2.266687194575148, 2.2666797697619607, 2.266676652896206, 2.266676948611706, 2.2666865864545405, 2.2666965370579892, 2.2667011677082765, 2.266696527263564, 2.266681011803626, 2.266661148773726, 2.266644295400556, 2.2666374719501254, 2.266636121863443, 2.2666456130379258, 2.2666659312939084, 2.2666865295487364, 2.266698863735031, 2.266701715804434, 2.2666954154810983, 2.266673313514797, 2.2666362051958684, 2.2666000879929973, 2.2665725096311404, 2.2665635318805735, 2.266564232016382, 2.2665753228526797, 2.266614299430806, 2.266686344349031, 2.266767715084654, 2.266844050035732, 2.2668844564923045, 2.2669000992813158, 2.266901801787193, 2.2668739351582943, 2.266779092554339, 2.26661689459738, 2.2664524973652114, 2.2663453300719025, 2.266300396035362, 2.2662923322901474, 2.2663274190155476, 2.26647384821488, 2.266781616094736, 2.2671572258855055, 2.2674336592949316, 2.2675422388784385, 2.2675588287080246, 2.2675131134512907, 2.2673067943790337, 2.2666627646110014, 2.2648143464166446, 2.2597072296278764, 2.2458657064043552, 2.2159153879899622, 2.1685859901218336, 2.1072578225059715, 2.036806934231497, 1.9631930657688559, 1.8927421774945934, 1.8314140098788598, 1.7840846120104925, 1.7541342935956246, 1.740292770371609, 1.7351856535828043, 1.733337235388059, 1.7326932056200164, 1.7324868865477967, 1.7324411712909158, 1.7324577611205019, 1.7325663407041512, 1.7328427741139858, 1.7332183839052027, 1.7335261517858167, 1.7336725809857783, 1.73370766771149, 1.7336996039662842, 1.7336546699299114, 1.7335475026365896, 1.7333831054040525, 1.7332209074473184, 1.7331260648432019, 1.7330981982142006, 1.7330999007199082, 1.7331155435088095, 1.73315594996552, 1.7332322849164319, 1.7333136556516155, 1.733385700569607, 1.7334246771477098, 1.7334357679837349, 1.7334364681188288, 1.7334274903675242, 1.7333999120047627, 1.7333637948014502, 1.7333266864821133, 1.733304584516061, 1.7332982841932718, 1.733301136262968, 1.7333134704500703, 1.7333340687060397, 1.733354386962668, 1.7333638781372347, 1.733362528050675, 1.7333557045998729, 1.7333388512264092, 1.7333189881961946, 1.733303472735677, 1.7332988322905536, 1.7333034629412274, 1.7333134135444768, 1.7333230513867004, 1.7333233471018037, 1.7333202302363615, 1.7333128054230547, 1.7333011364896482, 1.733287255442318, 1.733275281473349, 1.7332678208741596, 1.7332653892862457, 1.7332647160484291, 1.7332756994021885, 1.7332872868792635, 1.7332834819405907, 1.733267383999908, 1.733241814884102, 1.7332255416240412, 1.733227208020651, 1.7332463127254132, 1.7332644749424657, 1.7332601670147638, 1.7332324146518276, 1.7331992143651689, 1.7332054883231922, 1.7332424259436483, 1.7333242627609073, 1.7334153721991985, 1.7335029001840891, 1.7336857317150633, 1.7340049312309653, 1.7343444130365417, 1.7346522517937015, 1.7347771657411528, 1.73470750291095, 1.7345424211630274, 1.7343109128501626, 1.7340873520120794, 1.7336953221137437, 1.732184565994742, 1.7279875409077923, 1.7184718827354253, 1.6951506958651874, 1.6515844693010513, 1.5905753683357793, 1.5168242115313961, 1.4363965232468643, 1.3559904192565688, 1.2821494308129981, 1.2205615630012732, 1.1754711179026067, 1.1491587971123671, 1.137661440962936, 1.133971823813707, 1.1329676200847731, 1.1326719104978482, 1.1325546151028678, 1.1324252651772322, 1.1323092171561562, 1.1322542770800457, 1.13224663118511, 1.1323438914522992, 1.132502423963563, 1.1327329618202362, 1.132972512637701, 1.1331734625937502, 1.1332672694181527, 1.1332690212380656, 1.1332189005225979, 1.1330660737300886, 1.1328673893278274, 1.1327054688573344, 1.132649341560989, 1.1326383268425442, 1.1326648839939915, 1.132778152754004, 1.1329033444891254, 1.1329710282118317, 1.1329865661112883, 1.1329880921777458, 1.132943313936834, 1.1328635425326734, 1.132807509090024, 1.132797933632124, 1.1327988245017848, 1.1328260411472642, 1.1328826972910273, 1.1329388496662176, 1.1329551285414146, 1.1329541773439493, 1.1329396489916215, 1.1329019907796782, 1.1328548434993602, 1.1328270155538243, 1.1328243112148666, 1.1328283656657403, 1.1328485047022792, 1.1328819851038576, 1.1329078480254609]
v = [0.09876219155507335, 0.09874177140595572, 0.09871534994596631, 0.0986999972462401, 0.09869748394654447, 0.09870004441908271, 0.09872247818880384, 0.09876033070546249, 0.09879045860929254, 0.09880110842073166, 0.09880135940306355, 0.09878770792437043, 0.09874191197851648, 0.09869491468513113, 0.09867022208232434, 0.09866808395588646, 0.0986747502393847, 0.09871787137342904, 0.09878180679552123, 0.09882454007954843, 0.09883175548278894, 0.09882411937653758, 0.09878521800855969, 0.098696621389252, 0.09861297589278996, 0.09858044736292645, 0.0985824874686222, 0.09861381180303075, 0.0987197125116777, 0.098844423608966, 0.09893481527962363, 0.09895950898709296, 0.09895508612510857, 0.09888415929824583, 0.09874468615564005, 0.09860126453243005, 0.09848846049503492, 0.09844397256417467, 0.09846566372872466, 0.0985361843842998, 0.0986424242839101, 0.0987453443088669, 0.09881758834140407, 0.09882343613633938, 0.09877977836345975, 0.09896063496943118, 0.100038718115809, 0.10399718375239624, 0.11256001528302204, 0.1274928561876307, 0.14879119511610925, 0.17565519242057884, 0.20665514284765218, 0.23967043194113735, 0.27189416949459494, 0.30010391145940557, 0.32116405843224877, 0.3328526190157823, 0.33787468700003986, 0.33945813884251314, 0.3402501428685174, 0.340771141962787, 0.3410169602981004, 0.3410453051408382, 0.3408994628275844, 0.34080316437746727, 0.3407458533406724, 0.3407052812394056, 0.3406519422128642, 0.34056598813739175, 0.3404284970082828, 0.34031367169087734, 0.3402514817468296, 0.3402336872956563, 0.34022622574758904, 0.34020098278522076, 0.34016421052454, 0.3401477592865888, 0.34015324551469894, 0.3401849467333897, 0.34021557018287, 0.3402295488407128, 0.3402338245169942, 0.34022674349101656, 0.34022368889385435, 0.3402335486770006, 0.3402476373789678, 0.3402576057508215, 0.34026122067126396, 0.34025857280992006, 0.34025157981243215, 0.3402449700282905, 0.34023958479466165, 0.34023582468981534, 0.34023341944144414, 0.34023310573461824, 0.3402372476609966, 0.3402442818749031, 0.34025407129004126, 0.34026018750722287, 0.34026077848926733, 0.3402595968278752, 0.34025688343025157, 0.34025397025644166, 0.3402529822504264, 0.340255784606576, 0.34025809632578585, 0.34026004478084265, 0.34026128139962986, 0.34026245121053106, 0.3402640819897064, 0.3402668201681924, 0.34027267999825517, 0.3402781509094596, 0.34028454692376053, 0.3402875311558686, 0.34028568170457346, 0.340279997577706, 0.34027073663777696, 0.3402564269112766, 0.3402362129913965, 0.3402181882302729, 0.34020569957102903, 0.34020229317914125, 0.34020980273272233, 0.340212355964135, 0.3402210938445139, 0.3402467997435876, 0.3402771897781046, 0.3403022909618741, 0.3403158481563463, 0.3403159700599442, 0.3403192539624721, 0.34031337910880666, 0.34028297400013446, 0.340230742043351, 0.3401733298246239, 0.34013373290807203, 0.3401235230220662, 0.340124644485447, 0.340138685791246, 0.3401838956609814, 0.3402896478789136, 0.3405690060466643, 0.34133416985637455, 0.343422688186837, 0.3480439445382087, 0.3556226675598319, 0.36596110798657033, 0.3786136394817188, 0.3928105186071101, 0.4074376408503535, 0.4210944824481518, 0.4322866343924207, 0.4396933809539152, 0.44321007618665714, 0.44452048646656594, 0.4449923871038661, 0.4451458893422686, 0.4451802414293838, 0.4451825858490888, 0.44517359799420436, 0.4451377454014025, 0.44506428066546316, 0.44496919629854237, 0.4448980828881772, 0.4448715118374569, 0.44486330086217746, 0.4448626601528125, 0.4448828515840195, 0.4449136675153903, 0.44495531587462867, 0.4449890539933244, 0.44499840229210114, 0.44499959870650885, 0.4449954877214112, 0.44497857823729403, 0.44496472800267334, 0.44494648056075087, 0.4449331921717039, 0.4449269902594014, 0.4449280461513564, 0.44493513150313957, 0.4449422466624563, 0.44494873178802563, 0.4449573226896414, 0.44496532060787575, 0.4449749773545992, 0.4449773272403796, 0.44497660068291645, 0.4449731759776578, 0.4449660584904218, 0.44495511004491584, 0.44494335788420963, 0.4449360355268891, 0.44493298258875386, 0.44493736549502033, 0.44494880947771526, 0.44496135591049973, 0.4449699300181144, 0.4449712594134501, 0.44496116323448187, 0.44494385366884254, 0.44493028908235577, 0.4449247387083238, 0.44492656082121657, 0.4449330695213249, 0.4449432726592486, 0.44495660336300874, 0.4449706718390402, 0.4449831970132229, 0.44498776145176516, 0.4449833389260909, 0.4449653267143578, 0.4449416528103769, 0.4449304822252236, 0.44494176918511974, 0.4449626128070293, 0.4449643931361105, 0.4449453564595442, 0.44489665242690796, 0.444846967509779, 0.44484174375393587, 0.44487582830353484, 0.44493895950305795, 0.4449691317339752, 0.4449621565265611, 0.4449483543314901, 0.44498840223564995, 0.4450988810465917, 0.4451957722721333, 0.4451634521452948, 0.44507931535912043, 0.44499285132218874, 0.44501110873672894, 0.4451684183683916, 0.4454337131398112, 0.44550166856431933, 0.44528185950543214, 0.4447785493826825, 0.4444263166694062, 0.4442482832176589, 0.4419115708752933, 0.4366778472194892, 0.4267227620465309, 0.4118688885968263, 0.3923617577346037, 0.36882701546758967, 0.34250537841236617, 0.3154017968729101, 0.29032418820336503, 0.2704694392680291, 0.25799694277931196, 0.2516958648234536, 0.25011553391519775, 0.24996727005358724, 0.25016883681023866, 0.250190175253605, 0.25004710088008303, 0.24982219223265148, 0.24957001889108782, 0.24939375494137783, 0.24930894351608948, 0.24937290708068804, 0.24958764797128224, 0.24987696196130704, 0.25016799401653916, 0.250318518773883, 0.25032916698751634, 0.2502821461900142, 0.25010053520922815, 0.24984610707588895, 0.24962786094819292, 0.24956581880954146, 0.24956403980800126, 0.24963822280001657, 0.24981511905545603, 0.2500008227013713, 0.2500784276968261, 0.25009296591553865, 0.2500742374492994, 0.24997988526729006, 0.24984263098811602, 0.2497507305150763, 0.24973680283425903, 0.24974194060040192, 0.249796066631791, 0.24989757987626815, 0.24999619317892066, 0.25002572796922545, 0.2500253857007892, 0.2500029080885328, 0.2499382557889422, 0.24985696693660323, 0.24980875017625218, 0.24980310160512478, 0.2498082154275242, 0.24984087636705077, 0.24989744328460195, 0.24994116230490174]
theta = [0.9262086194374227, 0.9262248330865116, 0.9262458037476562, 0.9262575011909162, 0.9262589634282559, 0.9262564539308011, 0.926238105132853, 0.9262075786959122, 0.9261833197207485, 0.9261755778875946, 0.926175823363971, 0.9261873733955234, 0.9262250433412281, 0.926264563534676, 0.9262869628517972, 0.9262900369345703, 0.9262855918499426, 0.9262525871332635, 0.9262010602789917, 0.9261613126099649, 0.9261456072571309, 0.9261457328567829, 0.9261691708391249, 0.9262288290464789, 0.9262884599792475, 0.9263213220853002, 0.9263285006855533, 0.9263149295698894, 0.9262538886707178, 0.9261806050855282, 0.9261370807205569, 0.9261310036549231, 0.9261386345049667, 0.9261940430804863, 0.9262914192546063, 0.9263522308701112, 0.9263733361292739, 0.926340292769812, 0.926260590865608, 0.9261238210769507, 0.9259732590891181, 0.9258949662699743, 0.9258836869669601, 0.9259612710996119, 0.9262047352376407, 0.9267022985936664, 0.9275170618267476, 0.9291206283031329, 0.9336629489216972, 0.9418066714394234, 0.9529784392618245, 0.9666339908952893, 0.9818248431642137, 0.9972911946760729, 1.0116643243912333, 1.0236639210897784, 1.0322994932921814, 1.0369988709151867, 1.039004237423532, 1.0395048648710559, 1.0397766109076598, 1.040035405230772, 1.0401458500482077, 1.040160609451647, 1.040105521598217, 1.0400559512454701, 1.0400308372599765, 1.0400272573659168, 1.0400115802108434, 1.0399761740852913, 1.0399054651876956, 1.039846564910275, 1.0398219962487962, 1.0398242740479426, 1.039833246817243, 1.039830890904493, 1.0398192992644293, 1.039814243612151, 1.039819886168579, 1.0398362098382072, 1.0398434336867743, 1.0398434638770815, 1.0398278667198313, 1.0398104837548106, 1.039800452052654, 1.0397975536609854, 1.0398030852016373, 1.0398163136632994, 1.0398278484711536, 1.0398378131847525, 1.0398459310190729, 1.0398513580494504, 1.0398547672027805, 1.0398529905700187, 1.039847368096859, 1.0398431772428227, 1.03984012819434, 1.0398394650559535, 1.0398420076425552, 1.0398441031385863, 1.0398442825269716, 1.0398457515461288, 1.0398458664962527, 1.0398448674498442, 1.0398449624427877, 1.039845972011601, 1.0398479312316833, 1.0398483582174736, 1.0398452831582028, 1.0398419132844068, 1.039835972616438, 1.039828264624052, 1.039819934200981, 1.03981422425038, 1.0398135271556963, 1.0398159834097584, 1.0398243807586798, 1.0398337956171633, 1.0398414160134493, 1.0398505578675075, 1.0398628675791217, 1.0398743262083663, 1.0398806824199867, 1.0398799203992999, 1.03987738715491, 1.0398773746922678, 1.0398737153732471, 1.0398553569234181, 1.0398196400039577, 1.0397816681253376, 1.0397622875629107, 1.0397561458404265, 1.0397530900454426, 1.0397596667851199, 1.0397966844646336, 1.0398784768268123, 1.0399792255462013, 1.0400469948886337, 1.0400713235151846, 1.0400739090088102, 1.0400607590098094, 1.040004788737646, 1.0398265873399546, 1.0392964264185822, 1.0378049097323492, 1.033700528735592, 1.024612674658906, 1.0096983656306133, 0.9893117390985419, 0.9642729756463366, 0.9360588397131017, 0.9068623707212665, 0.8794923506280292, 0.8569877627971192, 0.8420753150962579, 0.8350057201321006, 0.8323797168106293, 0.8314377758956869, 0.8311231639881965, 0.8310315294877134, 0.8310129990661714, 0.8310211220060296, 0.8310719491912576, 0.8311996185860628, 0.8313818574057518, 0.8315265479872538, 0.8315890808004747, 0.8316020298709251, 0.8315983583862916, 0.8315796913015782, 0.8315380564567454, 0.8314663424327775, 0.8314017038451289, 0.8313726376164194, 0.8313671769937302, 0.831369315618641, 0.8313748806787902, 0.8313812038898726, 0.8313992003146288, 0.8314212804166181, 0.8314407454368732, 0.8314522115858556, 0.8314584850925284, 0.8314670720388031, 0.8314746425951147, 0.8314733124174398, 0.8314681555017482, 0.8314555731184561, 0.8314434129506323, 0.8314337029009915, 0.8314277316072938, 0.8314270711917269, 0.8314288156237184, 0.8314355598907992, 0.8314419707368506, 0.8314448867360037, 0.8314427052890272, 0.8314353801903569, 0.8314289295990538, 0.8314263363823557, 0.8314258673186166, 0.831433900557756, 0.8314463031351351, 0.8314525524128487, 0.8314514709464584, 0.8314450315445568, 0.8314342595291402, 0.8314265756612107, 0.8314240324780015, 0.8314237451792874, 0.8314277922749879, 0.8314384304540567, 0.8314558295569376, 0.8314825763695396, 0.8315022214155197, 0.8315042720423174, 0.8314852186608349, 0.8314515325725682, 0.8314301752025657, 0.8314401822606262, 0.8314751542212951, 0.8315225357634379, 0.8315326416048234, 0.8315081457458295, 0.8314598879093397, 0.8314410236273022, 0.831456470972918, 0.8314668092986932, 0.8314138671655465, 0.831279152437495, 0.8311362785299276, 0.8311074951718691, 0.8311316897806831, 0.831172852147906, 0.8311307143178941, 0.8309834350022706, 0.8307721262431189, 0.8307553476887396, 0.8310144673949296, 0.8316156234155511, 0.832153038585968, 0.8328970708824888, 0.8367527188301473, 0.8457723523945144, 0.8629673803080924, 0.8884571500097088, 0.9217728009794319, 0.9616869228354227, 1.0059018978045207, 1.050872043708542, 1.0920825552368019, 1.12486811077707, 1.1447069163952415, 1.15285590274497, 1.1561512826222913, 1.157684234171922, 1.158324695205771, 1.158544430762504, 1.1585803601140807, 1.1584623507715353, 1.158152807685344, 1.1578491280583476, 1.1576435925046284, 1.157507072948421, 1.1574554197144349, 1.1574846951847988, 1.1576151808336723, 1.157697786482105, 1.157714189285413, 1.1577218049630418, 1.157690659744643, 1.1576120628940787, 1.1575470980834288, 1.1575406055316153, 1.1575618330197102, 1.1576214338540582, 1.1577041085414796, 1.1577818706811878, 1.1578068740910665, 1.1578000766738201, 1.1577643241809696, 1.157696436982253, 1.1576170878101117, 1.1575683495614801, 1.157562630846648, 1.1575690045252711, 1.1576065946106024, 1.1576694292555483, 1.157728353690577, 1.1577468045875383, 1.15774773385705, 1.1577368587158274, 1.1576995414783895, 1.1576524965536101, 1.1576239393098142, 1.1576195491295025, 1.1576210889563918, 1.1576382725546095, 1.1576701640876845, 1.1576948255829678]


# p1 = plot(pd["rho"], ylims = (0.8,3.5), xguide="x", yguide="y", seriestype = :scatter, markersize=2);
# p2 = plot!(x,rho, label = "FVM");
# p3 = plot(pd["vx"], seriestype = :scatter, markersize=2)
# p4 = plot!(x,v)
# p5 = plot(pd["theta"], seriestype = :scatter, markersize=2)
# p6 = plot!(x,theta)

# pp1 = plot(p1, p2)
# pp2 = plot(p3,p4)
# pp3 = plot(p5, p6)
# p = plot(pp1,pp2, pp3, size=(1000,1000))

#plot(pd)




#rho plot
# plot(pd.x, pd.data[:,1], xlims = (-1.2,1.2), label = "DGSEM", title ="rho, t = 0.8", seriestype = :scatter, markersize=1, size=(1000,1000))
# plot!(x,rho, label = "FVV")

#vx plot

plot(pd.x, pd.data[:,2], xlims = (-1.2,1.2), label = "DGSEM", title ="vx, t = 0.8", seriestype = :scatter, markersize=2)
plot!(x,v, label = "FVV")

# #theta plot
plot(pd.x, pd.data[:,3], xlims = (-1.2,1.2), ylims = (0.5, 1.5), label = "DGSEM", title ="theta, t = 0.8", seriestype = :scatter, markersize=2)
plot!(x,theta, label = "FVV")

#theta allein
#plot(pd.x, pd.data[:,3], xlims = (-1.0,1.0), ylims = (-0.5 , 2.0), label = "DGSEM", title ="theta, t = 0.4", seriestype = :scatter, markersize=2)



#plot(pd["rho"], ylims = (0.8,3.5), xguide="x", yguide="y", seriestype = :scatter, markersize=2, size=(1000,1000))

# plot(pd["vx"], seriestype = :scatter, markersize=2)
# plot!(x,v)

#plot(pd["theta"], ylims = (-130,18),seriestype = :scatter, markersize=2, size=(1000,1000))
#plot!(x,theta)

#plot!(getmesh(pd))



# minimum(pd.data[:,3])


#savefig("vx.png")