using OrdinaryDiffEq
using Trixi
using Plots

equations = PerturbationMomentSystem2D(0.0, 0.0, 1.0, 0.0)

initial_condition = initial_condition_constant
surface_flux = flux_lax_friedrichs

boundary_condition = BoundaryConditionDirichlet(initial_condition)
boundary_conditions = (x_neg=boundary_condition, x_pos=boundary_condition, y_neg=boundary_condition, y_pos=boundary_condition)
volume_flux  = flux_lax_friedrichs
basis = LobattoLegendreBasis(3)
shock_indicator_variable = density_pressure
indicator_sc = IndicatorHennemannGassner(equations, basis,
                                         alpha_max=0.5,
                                         alpha_min=0.001,
                                         alpha_smooth=true,
                                         variable=shock_indicator_variable)
volume_integral = VolumeIntegralShockCapturingHG(indicator_sc;
                                                 volume_flux_dg=volume_flux,
                                                 volume_flux_fv=surface_flux)
solver = DGSEM(basis, surface_flux, volume_integral)

coordinates_min = (-1, -1)
coordinates_max = ( 1, 1)

mesh = TreeMesh(coordinates_min, coordinates_max, initial_refinement_level=6, n_cells_max=10_000, periodicity=false)
#semi = SemidiscretizationHyperbolic(mesh, equations, initial_condition, solver)
semi = SemidiscretizationHyperbolic(mesh, equations, initial_condition, solver, boundary_conditions=boundary_conditions)

tspan = (0.0, 0.4)
ode = semidiscretize(semi, tspan)

# At the beginning of the main loop, the SummaryCallback prints a summary of the simulation setup
# and resets the timers
summary_callback = SummaryCallback()

analysis_interval = 100

# The AnalysisCallback allows to analyse the solution in regular intervals and prints the results
analysis_callback = AnalysisCallback(semi, interval=100)

# das hier sorgt für die Ausgabe!
alive_callback = AliveCallback(analysis_interval=analysis_interval)


# The SaveSolutionCallback allows to save the solution to a file in regular intervals
save_solution = SaveSolutionCallback(interval=100,solution_variables=cons2prim)

# The StepsizeCallback handles the re-calculcation of the maximum Δt after each time step
stepsize_callback = StepsizeCallback(cfl=0.9)

save_restart = SaveRestartCallback(interval=100,save_final_restart=true)

# Create a CallbackSet to collect all callbacks such that they can be passed to the ODE solver
callbacks = CallbackSet(summary_callback, analysis_callback, alive_callback, save_solution, stepsize_callback, save_restart)


###############################################################################
# run the simulation

sol = solve(ode, CarpenterKennedy2N54(williamson_condition=false), dt=1.0, save_everystep=false, callback=callbacks);

# Print the timer summary
summary_callback()


rho1d = [2.995960114428906, 2.9953763910827473, 2.994782367441759, 2.9941470248014537, 2.9934393444573435, 2.9926283077049405, 2.9916828958397574, 2.990572090157306, 2.9898468523789172, 2.9891549881029538, 2.988266699703019, 
2.9871810891259356, 2.985897258318525, 2.9844143092276068, 2.9827313438000025, 2.9808474639825335, 2.9796582042020714, 2.97854805624731, 2.9771415590701067, 2.975449220015638, 2.973481546429082, 2.9712490456556115, 2.968762225040405, 2.9660315919286364, 2.9643719145929937, 2.9628624654959945, 2.9609745947594, 2.9587363264683333, 2.9561756847079126, 2.953320693563261, 2.9501993771194974, 2.9468397594617426, 2.9448740672857703, 2.9431320376247143, 2.940980055655515, 2.9384639349082198, 2.9356294889128747, 2.932522531199525, 2.929188875298217, 2.925674334738996, 2.9236952050328866, 2.9219859748692847, 2.9198993823433597, 2.9174916269471574, 2.914818908172723, 2.9119374255121007, 2.908903378457335, 2.90577296650047, 2.904076663518232, 2.902649052214164, 2.900925889746623, 2.8989621339885074, 2.8968127428127133, 2.894532674092139, 2.892176885699681, 2.8898003355082365, 2.8885611948361323, 2.887545254652614, 2.8863321072462984, 2.8849657739280588, 2.883490276008768, 2.8819496347992994, 2.8803878716105253, 2.8788490077533186, 2.8780765695258848, 2.8774603664330414, 2.8767318392332952, 2.875920329567819, 2.875055179077791, 2.8741657294043814, 2.873281322188765, 2.872431299072116, 2.8720195164822404, 2.8717011872771026, 2.8713279692809954, 2.8709163577304158, 2.8704828478618603, 2.8700439349118243, 2.8696161141168046, 2.8692158807132957, 2.869026881898295, 2.868887260105877, 2.86872418979252, 2.8685456561447373, 2.8683596443490433, 2.86817413959195, 2.86799712705997, 2.8678365919396174, 2.867759439472966, 2.867707589364857, 2.867646199858576, 2.8675787074537347, 2.867508548649944, 2.867439159946815, 2.867373977843958, 2.8673164388409837, 2.867281694312812, 2.867262585339629, 2.8672380775584925, 2.8672092262837205, 2.8671770868296322, 2.867142714510543, 2.8671071646407733, 2.867071492534639, 2.8670321083568746, 2.8670080726888614, 2.8669762107226884, 2.8669349206615684, 2.8668826007087196, 2.8668176490673543, 2.8667384639406883, 
2.866643443531936, 2.8665294893527804, 2.866442220167618, 2.8663351073088044, 2.8661999398804907, 2.8660285069868303, 2.8658125977319755, 2.8655440012200777, 2.8652145065552896, 2.8648505667832356, 2.864556381360019, 
2.864210782409107, 2.863788951163263, 2.863266068855248, 2.8626173167178237, 2.8618178759837534, 2.8608429278857987, 2.8598206023471233, 2.8589990613628693, 2.858061409048642, 2.856948156430593, 2.8555998145348767, 2.8539568943876468, 2.8519599070150576, 2.8495493634432614, 2.8471108362040907, 2.8451986131402127, 2.843068112928877, 2.840601127955054, 2.8376794506037126, 2.8341848732598214, 2.8299991883083506, 2.825004188134267, 2.8200991480316855, 2.816370393679639, 2.8123081432837855, 2.8077148366529854, 2.8023929135960994, 2.796144813921989, 2.788772977439515, 2.7800798439575374, 2.7717710642670146, 2.765664382597112, 2.7591548078931982, 2.751962508794228, 2.7438076539391574, 2.73441041196694, 2.7234909515165318, 2.7107694412268875, 2.6989179664501783, 2.6905071435635577, 2.6817321884890557, 2.672255366304939, 2.6617389420894706, 2.649845180920913, 2.6362363478775306, 2.620574708037587, 2.6063390247820566, 2.5965907434674484, 2.5866358424988403, 2.5761255035425332, 2.564710908264831, 2.5520432383320344, 2.5377736754104467, 2.5215534011663685, 2.5071545998915243, 2.497645857744164, 2.4881407393698067, 2.4783298984329454, 2.4679039885980742, 2.456553663529688, 2.4439695768922785, 2.4298423823503406, 2.417577539799378, 2.4097699387222438, 2.402128993583239, 2.394418206669831, 2.3864010802694864, 2.3778411166696705, 2.368501818157849, 2.358146687021488, 2.3493231316427106, 2.3439041941103804, 2.338708070132624, 2.3335764256354112, 2.328350926544712, 2.322873238786494, 2.3169850282867293, 2.3105279609713847, 2.3050494347651047, 2.3017665649613255, 2.298670564686629, 2.2956601241564707, 2.2926339335863024, 2.2894906831915782, 2.286129063187752, 2.282447763790277, 2.279133654303896, 2.277064538321547, 2.27511795087317, 2.2732096057861604, 2.2712552168879174, 2.2691704980058383, 2.266871162967321, 2.264272925599762, 2.2614146822036783, 2.259312357454289, 2.257312432505288, 2.2552964326535614, 2.2531458831960007, 2.2507423094294947, 2.247967236650932, 2.2447021901572, 2.240464627954101, 2.2369875830403845, 2.2337013327379625, 2.230400289541984, 2.2268788659475973, 2.2229314744499495, 2.2183525275441878, 2.2129364377254612, 2.2057103684280417, 2.199693027352028, 2.1941071657149425, 2.1886224817689386, 2.1829086737661707, 2.176635439958791, 2.1694724785989528, 2.16108948793881, 2.1500646153826395, 2.1410040880691144, 2.1327530757347555, 2.1248564562168033, 2.1168591073524987, 2.108305906979081, 2.0987417329337914, 2.087711463053869, 2.0735005718056847, 2.062042715358016, 2.0517979842823038, 2.0422354115250037, 2.0328240300325753, 2.0230328727514735, 2.0123309726281566, 2.00018736260908, 1.984866233454289, 1.972764010234097, 1.9621279256529294, 1.9524342861974258, 1.9431593983542266, 1.9337795686099692, 1.923771103451294, 1.9126103093648397, 1.8988137631918516, 1.8881418008777056, 1.8789120111597148, 1.8706877194602098, 1.8630322512015192, 1.8555089318059734, 1.8476810866959021, 1.8391120412936341, 1.8287157062997668, 1.8208351821347972, 1.8141165000458321, 1.8082511804011594, 1.8029307435690685, 1.797846709917847, 1.7926905998157836, 1.7871539336311661, 1.7805110680709963, 1.775533187881167, 1.7713286366116003, 1.7677095290203375, 1.7644879798654203, 1.761476103904889, 1.7584860158967857, 1.755329830599151, 1.7514498156224252, 1.7484138993456004, 1.7458232167996752, 1.7435687898473675, 1.7415416403513966, 1.7396327901744797, 1.7377332611793348, 1.7357340752286792, 1.7329367133068287, 1.7302906302227732, 1.7279308613987867, 1.725773709924061, 1.7237354788877903, 1.7217324713791657, 1.7196809904873809, 1.7174973393016277, 1.7139447610276484, 1.7099218051742477, 1.7062432380717008, 1.7028006929394406, 1.6994858029968982, 1.6961902014635064, 1.6928055215586966, 1.6892233965019017, 1.6832574209844573, 1.6762114445100569, 1.6697959011652337, 1.663840249090701, 1.658173946427172, 1.6526264513153601, 1.647027221895979, 1.641205716309741, 1.6317808487455878, 1.6207449762818398, 1.610811608396427, 1.601730732561008, 1.5932523362472417, 1.5851264069267867, 1.577102932071301, 1.5689318991524435, 1.5561750196127688, 1.5415295082011955, 1.5285106301998344, 1.5167990339906015, 1.5060753679554122, 1.4960202804761817, 1.4863144199348248, 1.4766384347132573, 1.4620767636183871, 1.445733462715278, 1.4313855627782341, 1.418681821359783, 1.407270996012452, 1.3968018442887677, 1.386923123741258, 1.37728359192245, 1.3632938055357184, 1.347963140684515, 1.3346698466879285, 1.323082480953258, 1.3128696008878014, 1.3036997638988557, 1.29524152739372, 1.287163448779691, 1.275851613002067, 1.263759551633905, 
1.253402377239232, 1.2445127136176404, 1.2368231845687223, 1.2300664138920703, 1.2239750253872763, 1.218281642853933, 1.2105834720317565, 1.2025642045353842, 1.1957783570216696, 1.1900423539185494, 1.1851726196539594, 1.1809855786558354, 1.1772976553521133, 1.1739252741707291, 1.1695163837848161, 1.1650473769070662, 1.161310493763886, 1.1581990578100156, 1.155606392500196, 1.1534258212891675, 1.1515506676316705, 1.1498742549824452, 1.147748983972082, 1.145658798976555, 1.1439308606295289, 1.142513118839554, 1.141353523515181, 1.1404000245649608, 1.1396005718974425, 1.138903115421177, 1.1380394110359773, 1.1372208140313815, 1.136550859273207, 1.136008559790238, 1.1355729286112601, 1.1352229787650567, 1.1349377232804128, 1.134696175186112, 1.134397756595078, 1.1341299235836944, 1.1339117270328336, 1.1337365370128234, 1.1335977235939911, 1.1334886568466636, 1.1334027068411678, 1.133333243647831, 1.1332414891958489, 1.1331653348987, 1.1331011497200543, 1.1330478752959932, 1.1330044532625985, 1.1329698252559526, 1.1329429329121368, 1.1329227178672328, 1.1328886241081726, 1.1328544157810967, 1.1328189680284544, 1.132783610054423, 1.13274967106318, 1.1327184802589012, 1.1326913668457648, 1.1326696600279471, 1.1326322336282018, 1.1325647887271781, 1.132488579804208, 1.1324075162782266, 1.1323255075681693, 1.1322464630929712, 1.1321742922715676, 1.1321129045228933, 1.1320241119046677, 1.1318364739046518, 1.1316307159366152, 1.131415847308921, 1.1312008773299327, 1.130994815308012, 1.1308066705515227, 1.130645452368827, 1.1304296636484494, 1.1299728799262614, 1.129486791685224, 1.1289896854949784, 1.128499847925165, 1.1280355655454246, 1.127615124925398, 1.1272568126347262, 1.1267962081775391, 1.1258495368738526, 1.1248685301664512, 1.1238849351986155, 1.1229304991136257, 1.122036969054762, 1.1212360921653044, 1.1205596155885327, 1.119715704243231, 1.1180437870348303, 1.1163534767874317, 1.1146910908979286, 1.1131029467632143, 1.1116353617801817, 1.1103346533457241, 1.1092471388567349, 1.1079265360113695, 1.1054089428646925, 1.1029225919111552, 1.1005235378027045, 1.0982678351912891, 1.0962115387288556, 1.0944107030673518, 1.0929213828587256, 1.091159392556292, 1.0879279316955244, 1.0848072689826875, 1.0818527380727492, 1.0791196726206782, 1.076663406281442, 1.074539272710009, 1.0728026055613467, 1.0708004414680692, 1.0672674900215275, 1.0639282141052637, 1.0608258264022952, 1.058003539595638, 1.05550456636831, 1.053372119403328, 1.051649411383709, 1.0497141025445846, 1.0464276489282265, 1.0433848628629823, 1.0406105894238313, 1.0381296736857522, 1.0359669607237236, 1.0341472956127238, 1.0326955234277315, 1.0311064429833765, 1.028508964889262, 1.0261514107289542, 1.0240417993203434, 1.0221881494813199, 1.0205984800297738, 1.0192808097835955, 1.0182431575606745, 1.0171366513725377, 1.0153954028378873, 1.0138450005441046, 1.012483325913995, 1.0113082603703645, 1.010317685336018, 1.0095094822337616, 1.0088815324864002, 1.0082265348114356, 1.007230167844453, 1.0063835700455916, 1.0056594726315449, 1.005030606819008, 1.0044697038246748, 1.0039494948652388, 1.0034427111573945]

vx1d = [0.0028728649724133605, 0.0032886659524029326, 0.003711859801683904, 0.004164670656132489, 0.004669322651624904, 0.005248039924037366, 0.005923046609246087, 0.006716566843127286, 0.007234895172034876, 0.007729798085646026, 0.008365358972998501, 0.009142606458465393, 0.010062569166419792, 0.011126275721234787, 0.01233475474728347, 0.013689034868938927, 0.014544655518503894, 0.01534431069815696, 0.016358027547541718, 0.01757901234188817, 0.01900047135642632, 0.020615610866386178, 0.022417637146997738, 0.024399756473490998, 0.025605937004358356, 0.026704552940944776, 0.028079970772315832, 0.029712904212947363, 0.03158406697731519, 0.033674172779895116, 0.035963935335162976, 0.038434068357594574, 0.03988138555920403, 0.04116616348570086, 0.042755374882937104, 0.044616367681899416, 0.04671648981357444, 0.04902308920894879, 0.05150351379900909, 0.05412511151474196, 0.05560331703691743, 0.056882226700704294, 0.05844562790638396, 0.06025230874517648, 0.06226105730830195, 0.06443066168698038, 0.06671990997243185, 0.0690875902558764, 0.07037151798298576, 0.07145422363434763, 0.07276250053559442, 0.07425514870343665, 0.07589096815458475, 0.07762875890574918, 0.07942732097364039, 0.08124545437496884, 0.08219305603161463, 0.08297201567060246, 0.08390263714721365, 0.08495145297089904, 0.08608499565110951, 0.08726979769729595, 0.08847239161890914, 0.08965930992540001, 0.09025356242998221, 0.0907298336697112, 0.09129262814198728, 0.09191953128482006, 0.09258812853621924, 0.09327600533419445, 0.09396074711675537, 0.09461993932191157, 0.094936836600367, 0.09518448724516096, 0.09547408544884173, 0.09579312885335615, 0.09612911510065114, 0.0964695418326735, 0.09680190669137012, 0.09711370731868785, 0.09725762099373327, 0.0973672542434552, 0.09749421204575544, 0.09763264804447042, 0.09777671588343653, 0.09792056920649014, 0.09805836165746762, 0.09818424688020534, 0.09824023426441263, 0.09828177729546195, 0.09832949883812415, 0.09838112796614457, 0.0984343937532685, 0.09848702527324121, 0.09853675159980799, 0.09858130180671408, 0.09860141865083062, 0.09861613514744036, 0.09863308673002416, 0.09865171338789679, 0.09867145511037304, 0.09869175188676763, 0.09871204370639539, 0.09873177055857102, 0.09874514328267381, 0.0987559235938573, 0.09876877702112065, 0.09878436976971047, 0.09880336804487348, 0.09882643805185634, 0.09885424599590568, 0.09888745808226815, 0.09892172548214212, 0.09895121498464121, 0.09898622606804364, 0.09902969585385424, 0.09908456146357784, 0.09915376001871923, 0.09924022864078322, 0.0993469044512746, 0.09945963134591845, 0.09955495280355219, 0.0996656145189649, 0.09979999267122987, 0.0999664634394204, 0.10017340300260974, 0.10042918753987116, 0.10074219323027794, 0.1010648260254703, 0.10132941387531062, 0.10162984302817048, 0.10198595450164723, 0.1024175893133383, 0.10294458848084108, 0.10358679302175289, 0.10436404395367117, 0.10514489667366045, 0.10576457049907272, 0.10645325276691257, 0.10725103077491818, 0.10819799182082779, 0.10933422320237952, 0.11069981221731162, 0.11233484616336223, 0.11393846315901074, 0.11516957630181004, 0.11650961287676585, 0.11802840475101498, 0.11979578379169437, 0.12188158186594088, 0.12435563084089132, 0.12728776258368266, 0.13009944521022807, 0.13218779853656992, 0.13441545954334652, 0.13688774365172351, 0.1397099662828665, 0.1429874428579411, 0.1468254887981129, 0.15132941952454754, 0.15555568048984705, 0.15859181601672512, 0.16176684443446662, 0.16521773041907586, 0.16908143864655725, 0.1734949337929149, 0.17859518053415321, 0.18451914354627644, 0.18995763822801082, 0.19373276522801933, 0.1976022735061581, 0.20171828240484851, 0.20623291126651175, 0.21129827943356894, 0.21706650624844137, 0.2236897110535502, 0.22963136400640735, 0.23360987208804665, 0.23760363270345503, 0.2417556913693735, 0.24620909360254337, 0.2511068849197056, 0.25659211083760136, 0.26280781687297167, 0.26824858116116146, 0.2717568262164053, 0.27520196590128104, 0.27869781798772175, 0.282358200247661, 0.2862969304530317, 0.29062782637576723, 0.29546470578780076, 0.2995949618210978, 0.30215791942124526, 0.30461845475989136, 0.3070539493964714, 0.30954178489042067, 0.31215934280117413, 0.314984004688167, 0.3180931521108345, 0.3206946245165808, 0.3222536896428486, 0.32371836214037497, 0.3251350643267559, 0.326550218519587, 0.32801024703646414, 0.32956157219498294, 0.3312506163127392, 0.3326687199846804, 0.33351046768708115, 0.334289243442408, 0.33503320407507103, 0.3357705064094807, 0.33652930727004704, 0.3373377634811804, 0.33822403186729083, 0.339046728938473, 0.3395822799776326, 0.3400797619063128, 0.34056380847456486, 0.3410590534324399, 0.34159013052998893, 0.3421816735172632, 0.34285831614431367, 0.34364575062857444, 0.3442551241122202, 0.3448266096583263, 0.3453949568265621, 0.3459949151765975, 0.3466612342681017, 0.3474286636607445, 0.3483319529141952, 0.34951386334048373, 0.35049237119016297, 0.35140162268167474, 0.35229680255323037, 0.3532330955430411, 0.3542656863893181, 0.3554497598302726, 0.3568405006041157, 0.3586802246519818, 0.3602055479318029, 0.3616006868947579, 0.3629454625409013, 0.3643196958702875, 0.3658032078829708, 0.36747581957900594, 0.369417351958447, 0.371951144672957, 0.37402252801503655, 0.37588672270458673, 0.3776433891957101, 0.3793921879425093, 0.3812327793990866, 0.38326482401954476, 0.3855879822579861, 0.38856420216905335, 0.39095163487189527, 0.3930657492762918, 0.3950122995444019, 0.39689703983838515, 0.39882572432040014, 0.4009041071526064, 0.40323794249716255, 0.4061649543031513, 0.4084601040262219, 0.41045890546541974, 0.4122558201820836, 0.41394530973755234, 0.4156218356931643, 0.4173798596102582, 0.4193138430501728, 0.4216827284664062, 0.4234896466074804, 0.42503633390046675, 0.42639295575965486, 0.4276296775993345, 0.4288166648337952, 0.4300240828773263, 0.43132209714421754, 0.4328688946284877, 0.434001054770306, 0.4349513898836385, 0.4357619232728606, 0.43647467824234754, 0.4371316780964744, 0.4377749461396164, 0.43844650567614873, 0.43920452808562976, 0.43969228257868714, 0.4400838871295053, 0.4403967862097892, 0.44064842429124346, 0.4408562458455728, 0.4410376953444819, 0.4412102172596756, 0.4413214293757331, 0.44123725788553536, 0.4411298935767244, 0.4409972830826857, 0.44083737303680537, 0.44064811007246896, 0.4404274408230622, 0.4401733119219707, 0.439675440574833, 0.43896494139331504, 0.43829912521165976, 0.43765834958846445, 0.4370229720823261, 0.4363733502518416, 0.4356898416556081, 0.4349528038522225, 0.4337120619818811, 0.43216119093890604, 0.4307390027637615, 0.42940655098139346, 0.42812488911674806, 0.426855070694771, 0.42555814924040836, 0.42419517827860603, 0.4219901165773775, 0.41932994621834396, 0.4169134392213873, 0.41467992771206275, 0.41256874381592534, 0.41051921965853005, 0.408470687365432, 0.40636247906218625, 0.40305291440498237, 0.39914741424603467, 0.3956283907234985, 0.39241398606397804, 0.38942234249407776, 0.38657160224040177, 0.38377990752955427, 0.3809654005881394, 0.37668186286923316, 0.37173394998938886, 0.36731813917823075, 0.3633368420609672, 0.3596924702628069, 0.3562874354089579, 0.35302414912462876, 0.3498050230350279, 0.345069477328252, 0.3397310148440832, 0.3350255368913775, 0.33084976095105273, 0.3271004045040271, 0.3236741850312184, 0.3204678200135449, 0.31737802693192435, 0.31300007927642776, 0.3082016407611163, 0.3040366503974391, 0.3004092435021257, 0.2972235553919055, 0.29438372138350777, 0.2917938767936618, 0.2893581569390971, 0.28604299380302917, 0.28251876134688825, 0.2795110221798698, 0.27694420174352324, 0.2747427254793983, 0.2728310188290444, 0.2711335072340111, 0.26957461613584793, 0.2675388745344224, 0.26543968077087515, 0.2636776571671571, 0.26220379372910807, 0.2609690804625683, 0.2599245073733777, 0.25902106446737644, 0.2582097417504044, 0.25719342342956936, 0.25617442987084277, 0.255332154663101, 0.25464073086971095, 0.2540742915540396, 0.2536069697794537, 0.25321289860932, 0.2528662111070054, 0.25245019851513467, 0.2520426043796682, 0.25171040125705213, 0.2514423835882327, 0.25122734581415596, 0.2510540823757681, 0.2509113877140152, 0.2507880562698434, 0.2506472275771125, 0.2505100167474775, 0.2503991316245938, 0.2503105989212584, 0.25024044535026824, 0.2501846976244201, 0.2501393824565111, 0.25010052655933795, 0.2500587748224727, 0.250012518850289, 0.2499727321188648, 0.2499386458246694, 0.2499094911641722, 0.2498844993338426, 0.24986290153015, 0.24984392894956364, 0.2498224665853926, 0.2497803145222064, 0.24973528798722996, 0.24968891160992082, 0.2496427100197366, 0.2495982078461346, 0.24955692971857243, 0.24952040026650754, 0.2494727863792503, 0.24936040644117763, 0.24923531136408061, 0.24910308100382317, 0.2489692952162691, 0.24883953385728222, 0.24871937678272624, 0.24861440384846503, 0.24847545254346673, 0.24816080783227876, 0.24781784465892742, 0.24746077436071423, 0.24710380827494083, 0.24676115773890842, 0.2464470340899188, 0.24617564866527325, 0.24582218575902132, 0.24505796872889737, 0.2442456067053773, 0.24341511847541553, 0.24259652282596667, 0.24181983854398506, 0.2411150844164251, 0.24051227923024118, 0.2397444106337939, 0.2381529705191567, 0.2365015961736648, 0.2348437546037349, 0.23323291281578395, 0.23172253781622862, 0.2303660966114856, 0.22921705620797164, 0.2277876493437997, 0.22494167636889487, 0.22205499285034344, 0.21920807283436083, 0.21648139036716277, 0.2139554194949647, 0.21171063426398212, 0.20982750872043057, 0.20754081438904828, 0.20316149663193508, 0.19881472631143082, 0.19460245135832704, 0.19062661970341543, 0.1869891792774874, 0.18379207801133457, 0.1811372638357485, 0.17799143635760203, 0.17219265406485726, 0.16655716455412328, 0.16119213747402483, 0.1562047424731868, 0.15170214920023392, 0.147791527303791, 0.14458004643248282, 0.1408682530034112, 0.13428242791191677, 0.12801567538577238, 0.12215847206082006, 0.11680129457290185, 0.11203461955785975, 0.10794892365153577, 0.10463468348977194, 0.10090072110115277, 0.09452614306209348, 0.08858839867311318, 0.08314463571731424, 0.07825200197779907, 0.07396764523767002, 0.07034871328002945, 0.0674523538879798, 0.06427361145986402, 0.0590546514092062, 0.054295913281161276, 0.05001925642094401, 0.04624654017376915, 0.04299962388485145, 0.040300366899405665, 0.038170628562646566, 0.03589490136419898, 0.032302352784263355, 0.029094109783866385, 0.026268401208324823, 0.023823455902955405, 0.021757502713074858, 0.020068770483999927, 0.018755488061047338, 0.017383806885048172, 0.015292978998555131, 0.013514013021122127, 0.01199012126847485, 0.010664516056338983, 0.009480409700440208, 0.008381014516504212, 0.007309542820256681]

theta1d = [0.9979453157277857, 0.9976474477442325, 0.9973442327871961, 0.9970196635895087, 0.9966577328840018, 0.9962424334035084, 0.9957577578808594, 0.9951876990488873, 0.9948150462264358, 0.9944590695608951, 0.9940017615994959, 0.9934421218454982, 0.9927791498021625, 0.9920118449727481, 0.9911392068605156, 0.9901602349687244, 0.9895410015031446, 0.988961858996904, 0.9882271702146805, 0.9873413251931135, 0.9863087139688416, 0.9851337265785035, 0.9838207530587385, 0.9823741834461851, 0.9814924757739382, 0.9806886591011494, 0.9796811938389177, 0.9784834280490656, 0.9771087097934149, 0.975570387133788, 0.9738818081320069, 0.9720563208498937, 0.9709846598351682, 0.9700324208797011, 0.9688528395559302, 0.9674693496187977, 0.9659053848232461, 0.9641843789242172, 0.9623297656766528, 0.9603649788354952, 0.9592549121107325, 0.9582937125464721, 0.9571168592553068, 0.9557548044278554, 0.9542380002547384, 0.9525968989265747, 0.9508619526339843, 0.9490636135675866, 0.9480866134117565, 0.9472623576377592, 0.9462649431574868, 0.9451255194513453, 0.9438752359997421, 0.9425452422830829, 0.941166687781775, 0.9397707219762246, 0.9390419012536773, 0.9384428965064712, 0.9377264084995613, 0.9369181568550642, 0.9360438611950952, 0.9351292411417702, 0.9342000163172053, 0.9332819063435162, 0.9328213228545297, 0.9324526808378526, 0.9320165962694738, 0.9315304876281045, 0.931011773392456, 0.9304778720412392, 0.9299462020531648, 0.9294341819069437, 0.9291871560233647, 0.9289948999180702, 0.9287697414340701, 0.9285214941495471, 0.9282599716426849, 0.9279949874916663, 0.9277363552746739, 0.9274938885698907, 0.9273809580075383, 0.9272959922598544, 0.9271972523964507, 0.9270894207046957, 0.9269771794719565, 0.9268652109856015, 0.9267581975329982, 0.9266608214015146, 0.926616416610153, 0.9265848907122787, 0.9265482842881776, 0.9265085802145576, 0.9264677613681276, 0.9264278106255954, 0.9263907108636695, 0.9263584449590582, 0.9263434994021021, 0.9263347039386584, 0.9263241991636375, 0.9263129153908753, 0.9263017829342076, 0.9262917321074697, 0.9262836932244973, 0.9262785965991257, 0.9262770129169688, 0.9262790887882684, 0.9262810253188535, 0.9262837526754287, 0.9262882010246991, 0.9262953005333688, 0.9263059813681425, 0.9263211736957245, 0.9263357732069591, 0.9263520938614184, 0.9263704936859293, 0.9263929992083918, 0.9264216369567053, 0.926458433458769, 0.9265054152424828, 0.9265646088357457, 0.9266230787178464, 0.9266767894666802, 0.9267379067390021, 0.9268114571435458, 0.9269024672890461, 0.9270159637842368, 0.927156973237852, 0.9273305222586254, 0.9275037923645666, 0.9276508394327425, 0.9278163501515885, 0.9280116353129007, 0.9282480057084759, 0.9285367721301107, 0.9288892453696015, 0.9293167362187446, 0.9297390285565406, 0.9300796431627797, 0.9304564758596675, 0.9308916244339538, 0.931407186672388, 0.9320252603617198, 0.9327679432886992, 0.9336573332400754, 0.9345197232155905, 0.9351871141534611, 0.9359113445550551, 0.936729572347771, 0.9376789554590079, 0.938796651816164, 0.9401198193466378, 0.9416856159778282, 0.9431717195548233, 0.9442791731397269, 0.9454571098467408, 0.9467591553454411, 0.9482389353054036, 0.9499500753962045, 0.9519462012874195, 0.9542809386486246, 0.9564471120310586, 0.9580036277552361, 0.9596256692979767, 0.9613794266448871, 0.9633310897815746, 0.9655468486936454, 0.9680928933667066, 0.9710354137863646, 0.9737011456622574, 0.975548711478632, 0.977433892921278, 0.9794263715307268, 0.981595828847509, 0.9840119464121547, 0.9867444057651953, 0.9898628884471613, 0.9926177796469225, 0.9944596726944991, 0.9962983057554188, 0.9981963498422443, 1.00021647596754, 1.0024213551438679, 1.0048736583837914, 1.0076360566998734, 1.0100118856541638, 1.0115449910619767, 1.0130407876223018, 1.014547557755557, 1.0161135838821598, 1.0177871484225283, 1.0196165337970795, 1.0216500224262317, 1.023345668591097, 1.024401175483799, 1.0254060649044061, 1.026391585123451, 1.0273889844114665, 1.0284295110389845, 1.0295444132765377, 1.0307649393946585, 1.031729609119972, 1.0322990661518499, 1.0328240590325202, 1.0333189488043637, 1.0337980965097606, 1.0342758631910907, 1.0347666098907349, 1.0352846976510726, 1.0356027663104128, 1.035737880077002, 1.0358455057233928, 1.0359221951879327, 1.03596450040897, 1.0359689733248514, 1.0359321658739256, 1.0358506299945391, 1.0355475113217838, 1.0352260004993263, 1.0349027467471335, 1.0345510311773574, 1.0341441349021512, 1.0336553390336671, 1.0330579246840579, 1.0323251729654759, 1.0312414322658359, 1.0302940092592725, 1.0293901350315517, 1.028469217000917, 1.0274706625856114, 
1.0263338792038779, 1.0249982742739592, 1.0234032552140988, 1.0212185843719244, 1.0193678625402984, 1.0176428681861933, 1.015937305374465, 1.0141448781699691, 1.0121592906375625, 1.0098742468421003, 1.0071834508484387, 1.0035966146812338, 1.0006101783647139, 0.9978766507858505, 0.9952390225868937, 0.992540284410094, 0.989623426897701, 0.986331440691965, 0.9825073164351354, 0.9775073186368425, 0.9734139893705875, 0.9697283434549595, 0.9662528863554937, 0.9627901235377251, 0.9591425604671886, 0.9551127026094197, 0.9505030554299534, 0.9445908204944983, 0.9398429859942153, 0.9356365673644992, 0.9317608728940528, 0.9280052108715797, 0.9241588895857823, 0.9200112173253636, 0.915351502379027, 0.9095013694092801, 0.9049093833585246, 0.9009082975934899, 0.8973089923546517, 0.893922347882486, 0.8905592444174683, 0.8870305622000738, 0.8831471814707786, 0.8783858375297338, 0.8747500813867359, 0.8716364297977798, 0.8689037082291574, 0.8664107421471605, 0.8640163570180811, 0.8615793783082113, 0.8589586314838429, 0.8558307217297251, 0.8535353740150098, 0.8516068878261187, 0.8499600609260357, 0.8485096910777453, 0.8471705760442311, 0.8458575135884776, 0.8444853014734683, 0.8429250100081845, 0.8419027373263602, 0.8410766792043883, 0.8404102954213456, 0.8398670457563098, 0.839410389988357, 0.8390037878965646, 0.8386106992600091, 0.838306717235338, 0.8383772679083935, 0.83850114226757, 0.8386794075027816, 0.8389131308039428, 0.839203379360967, 0.8395512203637683, 0.8399577210022605, 0.8407782167929525, 0.8419838902908519, 0.8431161881458304, 0.8442084923808415, 0.8452941850188388, 0.8464066480827744, 0.8475792635956021, 0.8488454135802748, 0.8509769682001657, 0.8536521630348438, 0.8561043948980428, 0.8584010661471521, 0.8606095791395609, 0.8627973362326581, 0.8650317397838335, 0.8673801921504758, 0.8711729740785568, 0.8757507397529919, 0.8799053132975682, 0.8837415326557287, 0.8873642357709157, 0.8908782605865716, 0.8943884450461388, 0.8979996270930598, 0.9036573665573882, 0.9103289248132267, 0.9163324022409288, 0.9218085586199571, 0.9268981537297746, 0.9317419473498434, 0.9364806992596262, 0.9412551692385851, 0.9485058030694745, 0.9568691940406471, 0.9643210717881451, 0.971028118226602, 0.9771570152706501, 0.9828744448349224, 0.9883470888340511, 0.993741629182669, 1.0016588573903562, 1.0105689587490976, 1.0184089851749214, 1.0253536975320083, 1.0315778566845397, 
1.0372562234966956, 1.042563558832657, 1.047674623556604, 1.0548998720880007, 1.0628070140600434, 1.069659708257757, 1.0756181433906002, 1.080842508168031, 1.0854929912995068, 1.0897297814944862, 1.0937130674624265, 1.099123195356145, 1.1048691412493985, 1.1097673572179698, 1.1139424403534586, 1.1175189877474643, 1.120621596491586, 1.1233748636774235, 1.1259033863965753, 1.1291989880520872, 1.1325970435342303, 1.1354471594222344, 
1.137829295908902, 1.1398234131870348, 1.1415094714494347, 1.1429674308889033, 1.144277251698242, 1.145914430703021, 1.1475575296264353, 1.1489148907641014, 1.15002850507272, 1.1509403635089925, 1.151692457029619, 1.1523267765913012, 1.1528853131507397, 1.1535530898649315, 1.1542087727666892, 1.154742509253275, 1.1551725579633247, 1.1555171775354758, 1.1557946266083636, 1.1560231638206244, 1.1562210478108943, 1.1564448553376578, 1.1566620405201713, 1.156835672223045, 1.156972559940984, 1.1570795131686928, 1.1571633414008764, 1.1572308541322398, 1.1572888608574876, 1.1573479723625189, 1.1574046003316214, 1.157447123717176, 1.1574780919660757, 1.1575000545252154, 1.1575155608414878, 1.1575271603617872, 1.1575374025330067, 1.157542179101623, 1.1575391146719811, 1.1575294787745498, 1.1575151214540864, 1.1574978927553474, 1.1574796427230893, 1.1574622214020682, 1.1574474788370412, 1.1574222583685134, 1.157365507209684, 1.1573001434448786, 1.1572296759562979, 1.157157613626142, 1.1570874653366108, 1.1570227399699047, 1.156966946408224, 1.1568889034858993, 1.1567178535114226, 1.1565303732411065, 1.1563345506762204, 1.1561384738180338, 1.1559502306678153, 1.1557779092268343, 1.1556295974963595, 1.1554332749659812, 1.1550134058739439, 1.1545659482771835, 1.1541077193518396, 1.1536555362740506, 1.1532262162199547, 1.1528365763656907, 1.152503433887397, 1.1520764515645732, 1.1511941068525242, 1.1502758916999412, 1.1493520213844723, 1.1484527111837683, 1.1476081763754764, 1.1468486322372464, 1.1462042940467272, 1.1453999812633913, 1.1437977202497243, 1.1421656306700885, 1.1405504305937901, 1.1389988380901364, 1.1375575712284318, 1.1362733480779834, 1.135192886708097, 1.1338769192960254, 1.1313498039379772, 1.1288267022819602, 1.1263695703988286, 1.1240403643594359, 1.1219010402346346, 1.1200135540952791, 1.118439862012223, 1.1165689315576273, 1.1131054102270623, 1.1097155296587038, 1.1064686419453573, 1.103434099179828, 1.1006812534549202, 1.0982794568634393, 1.09629806149819, 1.0939996479631007, 1.0899007540123127, 1.0859718932199929, 1.0822761354182502, 1.078876550439194, 1.0758362081149329, 1.0732181782775758, 1.0710855307592322, 1.0686740582393586, 1.0645365929493256, 1.0606578924561187, 1.057081247530084, 1.0538499489415665, 1.0510072874609115, 1.0485965538584643, 1.0466610389045703, 1.0445299862390103, 1.04101674514226, 1.037797958879503, 1.0348923917942534, 1.032318808230026, 1.0300959725303354, 1.0282426490386951, 1.0267776020986203, 1.0252082173385015, 1.022723690959704, 1.0204982100697113, 1.0185324122281871, 1.016826934994794, 1.0153824159291942, 1.0141994925910507, 1.0132788025400257, 1.012315538633775, 1.0108446831943074, 1.0095914722964465, 1.0085162750242151, 1.007579460461636, 1.006741397692731, 1.0059624558015234, 1.0052030038720356]

pd = PlotData1D(sol; solution_variables=cons2prim)


plot(pd.x, pd.data[:,1], xlims = (-1.1,1.1), label = "2D", title ="rho, t = 0.4", seriestype = :scatter, markersize=2)
plot!(pd.x,rho1d, label = "1D", markersize=4)
savefig("rho.png")

plot(pd.x, pd.data[:,2], xlims = (-1.1,1.1), label = "2D", title ="rho, t = 0.4", seriestype = :scatter, markersize=2)
plot!(pd.x,vx1d, label = "1D", markersize=4)
savefig("vx.png")

plot(pd.x, pd.data[:,4], xlims = (-1.1,1.1), label = "2D", title ="rho, t = 0.4", seriestype = :scatter, markersize=2)
plot!(pd.x,theta1d, label = "1D", markersize=4)
savefig("theta.png")