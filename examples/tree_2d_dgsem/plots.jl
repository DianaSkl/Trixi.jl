x = LinRange(-1,1,257)
y = LinRange(-1,1,257)
slope = 15
B = zeros(length(y))
rho = zeros(length(y))
vx = zeros(length(y))
vy = zeros(length(x))
theta = zeros(length(y))
tmp = zeros(length(y))
diffi = zeros(length(y))
dtheta = zeros(length(y)) 
global bla = 0.0



for i = 1:length(y)
    B[i] = tanh(slope * y[i] + 7.5) - tanh(slope * y[i] - 7.5)
    rho[i] = 0.5 + 0.75 * B[i]
    
    vx[i] = 0.5 * (B[i] - 1)
    vy[i] = 0.1 * sin(2 * pi * x[i])
   
    theta[i] =  1/rho[i]

    dtheta[i] = -(0.75*(15*sech(15*y[i]+7.5)^2-15*sech(15*y[i]-7.5)^2))/(0.75*(tanh(15*y[i]+7.5)-tanh(15*y[i]-7.5))+0.5)^2

        # a = 0.05
        # z1 = 0.5
        # z2 = 1.5
        # s=0.2
        # tmp[i] = tanh((y[i]-z1)/a)- tanh((y[i]-z2)/a)
        # rho[i] = 1 + 0.5*tmp[i]
        # vx[i] = tmp[i] -1
        # vy[i] = 0.01*sin(2 * pi * y[i])*(exp(-(y[i]-z1)^2/s^2)+ exp(-(y[i]-z2)^2/s^2))
        # local p = 10
        # theta[i] = p/rho[i]
        # diffi[i] = 0.01*((exp(-(-1.5 + y[i])^2)/25)*(-1.5 + y[i]) - (exp(-(-0.5 + y[i])^2)/25)*(-0.5 + y[i]))*sin(2*pi*x[i])/50
    global bla = bla + theta[i]
end
    

p1 = plot(y, rho, title="rho")
p2 = plot(y, vx, title = "v1")
p3 = plot(x, vy, title ="v2")
p4 = plot(y, theta, title ="theta")

plot(p1,p2,p3,p4)

plot(y,dtheta, title= "dtheta")
#plot(y, diffi, title = "diff")
#bla/257


a0 = [1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102271638	, 1.102269942	, 1.102270766	, 1.102270623	, 1.102270964	, 1.102269803	, 1.102270779	, 1.102271964	, 1.10226994	, 1.102269818	, 1.102270668	, 1.102273067	, 1.102268839	, 1.10227002	, 1.102270433	, 1.10227361	, 1.102268027	, 1.102270357	, 1.102270141	, 1.102273437	, 1.102267791	, 1.10227071	, 1.102269891	, 1.102272622	, 1.102268212	, 1.102270955	, 1.102269775	, 1.102271427	, 1.102269135	, 1.102271014	, 1.102269834	, 1.10227019	, 1.102270232	, 1.102270893	, 1.102270035	, 1.10226919	, 1.102271159	, 1.102270672	, 1.102270292	, 1.102268548	, 1.102271703	, 1.102270463	, 1.102270505	, 1.102268215	, 1.10227187	, 1.102270347	, 1.102270613	, 1.102268065	, 1.102271842	, 1.102270328	, 1.102270625	, 1.10226802	, 1.102271824	, 1.102270337	, 1.102270604	, 1.102268134	, 1.102271884	, 1.102270286	, 1.102270619	, 1.102268558	, 1.102271897	, 1.102270138	, 1.102270688	, 1.102269404	, 1.10227306	, 1.102269986	, 1.102270374	, 1.102269697	, 1.102271988	, 1.102270268	, 1.102270448	, 1.102269482	, 1.102270293	, 1.102270579	, 1.102270563	, 1.102269471	, 1.102268291	, 1.102270884	, 1.102270633	, 1.102269725	, 1.102266535	, 1.102271131	, 1.102270592	, 1.102270191	, 1.102265575	, 1.102271267	, 1.102270433	, 1.102270721	, 1.102265723	, 1.102271253	, 1.102270216	, 1.102271142	, 1.102266918	, 1.102271078	, 1.102270037	, 1.102271327	, 1.102268768	, 1.102270773	, 1.102269979	, 1.102271252	, 1.102270713	, 1.102270397	, 1.102270072	, 1.102270996	, 1.102272262	, 1.102270028	, 1.102270272	, 1.102270698	, 1.102273187	, 1.102269736	, 1.102270481	, 1.102270477	, 1.102273562	, 1.102269563	, 1.102270603	, 1.102270368	, 1.102273646	, 1.102269521	, 1.102270596	, 1.10227031	, 1.102273642	, 1.102269594	, 1.102270497	, 1.102270198	, 1.102273527	, 1.102269756	, 1.102270396	, 1.102269979	, 1.102271658	, 1.102270076	, 1.102270788	, 1.102269272	, 1.102272437	, 1.102269674	, 1.102270751	, 1.102270838	, 1.102273141	, 1.102269287	, 1.102270685	, 1.102272462	, 1.10227322	, 1.102269105	, 1.10227059	, 1.10227366	, 1.102272369	, 1.102269255	, 1.102270462	, 1.102274081	, 1.102270731	, 1.102269731	, 1.102270307	, 1.102273657	, 1.102268845	, 1.102270388	, 1.102270142	, 1.102272595	, 1.102267386	, 1.102271011	, 1.10227	, 1.102271271	, 1.102266854	, 1.102271412	, 1.102269918	, 1.102270051	, 1.102267353	, 1.102271503	, 1.102269925	, 1.102269152	, 1.102268563	, 1.102271329	, 1.102270026	, 1.102268587	, 1.102269912	, 1.102271029	, 1.1022702	, 1.102268223	, 1.102270872	, 1.102270756	, 1.102270405	, 1.10226792	, 1.102271236	, 1.10227059	, 1.10227059	, 1.10226768	, 1.102271209	, 1.102270495	, 1.102270721	, 1.10226768	, 1.102271235	, 1.102270355	, 1.102270783	, 1.102268169	, 1.102271852	, 1.102270498	, 1.10227043	, 1.10226836	, 1.102271808	, 1.102270379	, 1.102270571	, 1.102268755	, 1.102271872	, 1.102270064	, 1.102270782	, 1.102269644	, 1.102271777	, 1.10226969	, 1.102270972	, 1.102270833	, 1.102271256	, 1.102269464	, 1.102271031	, 1.102271968	, 1.10227025	, 1.102269538	, 1.1022709	, 1.102272703	, 1.102268989	, 1.102269921	, 1.102270602	, 1.102272844	, 1.102267894	, 1.102270472	, 1.102270233	, 1.102272419	, 1.102267383	, 1.102270977	, 1.102269921	, 1.102271641	, 1.102267673	, 1.102271246	, 1.102269765	, 1.102270796	, 1.102268675	, 1.102271204	, 1.102269797	, 1.102270111	, 1.102270031	, 1.102270924	, 1.102269964	, 1.102269661	, 1.10227127	, 1.10227058	, 1.102270167	, 1.102269366	, 1.102272031	, 1.102270355	, 1.102270313	, 1.102269083	, 1.102272229	, 1.102270329	, 1.10227037	, 1.102268739	, 1.102272061	, 1.102270432	, 1.102270382	, 1.102268425]
au0 = [1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102270384	, 1.102314139	, 1.102312814	, 1.102313323	, 1.102312318	, 1.102312665	, 1.102310234	, 1.102308055	, 1.102306591	, 1.102304609	, 1.102301908	, 1.102297384	, 1.102295794	, 1.10229164	, 1.102289377	, 1.102283047	, 1.102281505	, 1.102276014	, 1.102274497	, 1.102267112	, 1.102265647	, 1.102260087	, 1.102259212	, 1.102251735	, 1.102250331	, 1.102245982	, 1.10224543	, 1.102238979	, 1.102237694	, 1.102235427	, 1.10223496	, 1.10223065	, 1.102229687	, 1.10222972	, 1.102229389	, 1.102228092	, 1.10222777	, 1.102229706	, 1.102229864	, 1.10223196	, 1.102232569	, 1.102235678	, 1.102236763	, 1.102241975	, 1.10224358	, 1.102247185	, 1.102249381	, 1.102256785	, 1.102259102	, 1.102262828	, 1.102265814	, 1.102274047	, 1.102276491	, 1.102280245	, 1.10228321	, 1.102290827	, 1.102292737	, 1.102296438	, 1.10229842	, 1.102304237	, 1.102305157	, 1.102308454	, 1.102308799	, 1.10231209	, 1.10231193	, 1.102405044	, 1.102407045	, 1.102412067	, 1.102411866	, 1.102414131	, 1.1024111	, 1.102406038	, 1.102399829	, 1.102400565	, 1.102393708	, 1.102379981	, 1.102369111	, 1.102367818	, 1.102358854	, 1.102338895	, 1.102325298	, 1.102321982	, 1.102312496	, 1.102289215	, 1.102274968	, 1.102270248	, 1.102261342	, 1.102237791	, 1.102224819	, 1.102219761	, 1.10221209	, 1.102191278	, 1.102181199	, 1.10217697	, 1.102171012	, 1.102155756	, 1.102149823	, 1.102147303	, 1.102143648	, 1.102136332	, 1.102135391	, 1.102134915	, 1.102134353	, 1.102136546	, 1.102140948	, 1.102142284	, 1.102145562	, 1.102157556	, 1.102167006	, 1.10216956	, 1.102176902	, 1.10219731	, 1.102210703	, 1.102213847	, 1.102224473	, 1.102250161	, 1.102265537	, 1.10226887	, 1.102280864	, 1.102307406	, 1.102322178	, 1.102325564	, 1.102336313	, 1.102358977	, 1.102370467	, 1.102373838	, 1.102380908	, 1.102395823	, 1.102401947	, 1.102470546	, 1.102483354	, 1.102501961	, 1.102507802	, 1.102510966	, 1.10251253	, 1.102514027	, 1.102510536	, 1.102512886	, 1.102503183	, 1.102488433	, 1.102476893	, 1.102477743	, 1.102459192	, 1.102431498	, 1.102414139	, 1.102412963	, 1.102389449	, 1.102353436	, 1.102332832	, 1.102329591	, 1.102305259	, 1.10226599	, 1.10224474	, 1.102240005	, 1.102218353	, 1.102180847	, 1.102161494	, 1.102156317	, 1.102139806	, 1.102108819	, 1.102093829	, 1.102089404	, 1.102079545	, 1.102059343	, 1.102050981	, 1.102048247	, 1.102045898	, 1.10203985	, 1.102039838	, 1.102039199	, 1.102044793	, 1.102054718	, 1.102063739	, 1.102065009	, 1.102078477	, 1.102103901	, 1.102121114	, 1.102123705	, 1.102144077	, 1.102181712	, 1.102204545	, 1.102207799	, 1.102232712	, 1.102276564	, 1.102301034	, 1.102304498	, 1.102330067	, 1.102372446	, 1.102394041	, 1.102397536	, 1.102418946	, 1.102452248	, 1.102467097	, 1.102477415	, 1.102496247	, 1.102523359	, 1.102533873	, 1.102537278	, 1.1025446	, 1.102552404	, 1.102551034	, 1.10255406	, 1.102548604	, 1.102537019	, 1.102524803	, 1.102526811	, 1.102510035	, 1.102482227	, 1.10246189	, 1.102462182	, 1.102437616	, 1.10239866	, 1.102373682	, 1.102371857	, 1.102343972	, 1.102299632	, 1.102273533	, 1.102269757	, 1.10224289	, 1.10219891	, 1.102174914	, 1.102169955	, 1.102147633	, 1.102109461	, 1.102090431	, 1.102085431	, 1.102070158	, 1.102042787	, 1.102031203	, 1.102027301	, 1.10202065	, 1.102008287	, 1.102006084	, 1.102004043	, 1.102006815	, 1.102012227	, 1.102020415	, 1.102020417	, 1.102032653	, 1.10205629	, 1.102074451	, 1.102076139	, 1.102096884	, 1.102136112	, 1.102161988	, 1.102164727	, 1.102191665	, 1.102240567	, 1.102270069	, 1.102273278	, 1.102302555	, 1.102352729	, 1.102380596	, 1.10238396	, 1.102410561	, 1.102452934	, 1.102473982]

x = LinRange(0,2,320)

plot(x, a0, seriestype = :scatter)


w0_final = [0.9500027779720324, 0.9500782862688913, 0.9503132657728499, 0.9507056463348087, 0.9512533578056687, 0.9519543300363293, 0.9528064928776918, 0.9538077761806558, 0.9538089788089614, 0.9549513985600093, 0.9562377683284113, 0.9576628737680474, 0.9592215005327976, 0.9609084342765418, 0.96271846065316, 0.9646463653165319, 0.9646470400313475, 0.966682819933812, 0.9688248692073248, 0.9710656992914316, 0.973397821625678, 0.9758137476496094, 0.9783059888027716, 0.9808670565247101, 0.9808670423401935, 0.9834865968590986, 0.9861583104265872, 0.9888736485717298, 0.9916240768235964, 0.9944010607112557, 0.9971960657637783, 1.0000005575102335, 0.9999998474288323, 1.0028044871701873, 1.005599124118407, 1.0083755258301184, 1.011125459861948, 1.0138406937705227, 1.0165129951124683, 1.0191341314444118, 1.0191328788862348, 1.0216954406428702, 1.0241874550647407, 1.0266022256029514, 1.0289330557086078, 1.0311732488328145, 1.033316108426677, 1.0353549379413003, 1.035353406841413, 1.037283392067296, 1.0390932699803186, 1.0407788232691715, 1.042335834622545, 1.04376008672913, 1.0450473622776166, 1.0461934439566953, 1.046191925677801, 1.047195168116876, 1.04804727964235, 1.0487470759895028, 1.0492933728936145, 1.0496849860899646, 1.0499207313138337, 1.0499994243005009, 1.0499981591438163, 1.0499218101939523, 1.0496864258182688, 1.0492939864500053, 1.0487464725224007, 1.0480458644686934, 1.0471941427221227, 1.0461932877159275, 1.046192422973439, 1.0450482883008188, 1.0437613309265745, 1.042336413926849, 1.040778400377787, 1.039092153355531, 1.0372825359362254, 1.0353544111960136, 1.0353540052724877, 1.033316640757676, 1.0311741653557338, 1.0289336605722106, 1.0266022079126556, 1.0241868888826169, 1.0216947849876437, 1.0191329777332845, 1.0191330341602696, 1.0165129535826685, 1.013841224984419, 1.0111261584438604, 1.008376064039333, 1.0055992518491765, 1.0028040319517308, 0.9999987144253354, 0.99999921545532, 0.9971954163669712, 0.9944011842904759, 0.9916248413850681, 0.9888747098099827, 0.9861591117244537, 0.9834863692877156, 0.9808648046590026, 0.9808657193313636, 0.9783048724963034, 0.9758134456802766, 0.9733984867021552, 0.9710670433808106, 0.9688261635351142, 0.9666828949839376, 0.9646442855461519, 0.9646455478547515, 0.962717147241213, 0.960907695456618, 0.9592218168671811, 0.9576641358391175, 0.9562392767386411, 0.9549518639319667, 0.9538065217853088, 0.9538079978217334, 0.9528052814413563, 0.9519531849466449, 0.9512531169949096, 0.9507064862434605, 0.9503147013496078, 0.9500791709706617, 0.9500013037639325]
w0_prim = [1	, 1.005416318	, 1.014017549	, 1.019134172	, 1.019134172	, 1.0240256	, 1.031317371	, 1.035355339	, 1.035355339	, 1.038977202	, 1.043849408	, 1.046193977	, 1.046193977	, 1.047994878	, 1.049705769	, 1.05	, 1.05	, 1.049705769	, 1.047994878	, 1.046193977	, 1.046193977	, 1.043849408	, 1.038977202	, 1.035355339	, 1.035355339	, 1.031317371	, 1.0240256	, 1.019134172	, 1.019134172	, 1.014017549	, 1.005416318	,1	, 1	, 0.9945836816	, 0.9859824514	, 0.9808658284	, 0.9808658284	, 0.9759743999	, 0.968682629	, 0.9646446609	, 0.9646446609	, 0.961022798	, 0.9561505925	, 0.9538060234	, 0.9538060234	, 0.9520051218	, 0.9502942308	, 0.95	, 0.95	, 0.9502942308	, 0.9520051218	, 0.9538060234	, 0.9538060234	, 0.9561505925	, 0.961022798	, 0.9646446609	, 0.9646446609	, 0.968682629	, 0.9759743999	, 0.9808658284	, 0.9808658284	, 0.9859824514	, 0.9945836816	, 1	, 0.9784944412	, 0.9835117536	, 0.9920126527	, 0.9974053587	, 0.9974045266	, 1.002831682	, 1.011508284	, 1.016711184	, 1.016710112	, 1.021720491	, 1.029251869	, 1.033473064	, 1.033472053	, 1.037302383	, 1.042542279	, 1.045139029	, 1.045138265	, 1.047205105	, 1.04935625	, 1.04993288	, 1.049932393	, 1.049921136	, 1.048656355	, 1.0471247	, 1.047124404	, 1.045037147	, 1.040548985	, 1.03714203	, 1.037141833	, 1.03329683	, 1.026268243	, 1.021504768	, 1.021504666	, 1.016487594	, 1.007988163	, 1.002593705	, 1.002593802	, 0.9971684123	, 0.9884917801	, 0.9832879771	, 0.9832884176	, 0.9782802938	, 0.9707474059	, 0.9665266847	, 0.9665275391	, 0.9626986335	, 0.9574566312	, 0.9548614556	, 0.9548626278	, 0.9527955478	, 0.9506429349	, 0.9500680556	, 0.9500692787	, 0.9500787706	, 0.951343581	, 0.9528761387	, 0.9528770669	, 0.9549620683	, 0.9594517397	, 0.9628582206	, 0.9628585757	, 0.9667021531	, 0.9737328462	, 0.9784947473	, 0.9611722095	, 0.9648123763	, 0.9715612063	, 0.9761825904	, 0.9761828904	, 0.9810849885	, 0.9894632828	, 0.9948200249	, 0.9948197299	, 1.000237294	, 1.008969347	, 1.014246246	, 1.014245434	, 1.019353511	, 1.027109855	, 1.031503638	, 1.031502484	, 1.035523331	, 1.041123186	, 1.043964749	, 1.043963472	, 1.046285005	, 1.048876015	, 1.049732401	, 1.0497312	, 1.050000154	, 1.049188046	, 1.047928562	, 1.047927588	, 1.046103194	, 1.042011698	, 1.038828003	, 1.038827351	, 1.035187442	, 1.028439397	, 1.023816368	, 1.023816097	, 1.018914761	, 1.010537324	, 1.005179134	, 1.005179277	, 0.9997625328	, 0.9910309084	, 0.9857536051	, 0.9857541752	, 0.9806464946	, 0.9728898999	, 0.9684969933	, 0.9684979555	, 0.9644768508	, 0.9588762116	, 0.956036292	, 0.9560375412	, 0.9537152452	, 0.951123378	, 0.9502684409	, 0.9502697932	, 0.9500000196	, 0.9508116986	, 0.9520715864	, 0.9520728031	, 0.9538968002	, 0.9579885476	, 0.9611713662	, 0.9514004091	, 0.9529545723	, 0.9566386358	, 0.9595902174	, 0.9595912056	, 0.9630170329	, 0.9694663375	, 0.9739332074	, 0.9739335033	, 0.9787099506	, 0.9869424285	, 0.9922446476	, 0.9922441897	, 0.9976441671	, 1.006406283	, 1.011737081	, 1.011736001	, 1.016937018	, 1.024894734	, 1.029443074	, 1.029441638	, 1.033651251	, 1.039593173	, 1.042666912	, 1.042665425	, 1.045242251	, 1.048263994	, 1.049395083	, 1.049393787	, 1.049945447	, 1.049587193	, 1.048602988	, 1.048602019	, 1.047044921	, 1.043361297	, 1.040411107	, 1.040410508	, 1.036982342	, 1.03053405	, 1.026066713	, 1.026066493	, 1.021289672	, 1.013058188	, 1.007753916	, 1.00775409	, 1.002355925	, 0.9935942006	, 0.9882609672	, 0.9882615712	, 0.983063489	, 0.9751053338	, 0.9705556025	, 0.9705566476	, 0.9663493738	, 0.9604064395	, 0.9573331674	, 0.9573345791	, 0.9547581259	, 0.95173539	, 0.9506063536	, 0.9506079333	, 0.9500544614	, 0.9504123234	, 0.9513989634	, 0.9500025689	, 0.9502928402	, 0.9520058165	, 0.9538070031	, 0.9538082622	, 0.956149387	, 0.9610233678	, 0.9646451564	, 0.964645925	, 0.9686819851	, 0.9759746222	, 0.9808655958	, 0.9808656986	, 0.9859826762	, 0.9945833786	, 0.9999990674	, 0.9999984796	, 1.005417481	, 1.014016699	, 1.019132839	, 1.019131695	, 1.024027459	, 1.031316152	, 1.035354039	, 1.035352587	, 1.038979282	, 1.04384814	, 1.046193077	, 1.046191595	, 1.047996653	, 1.049704791	, 1.049999644	, 1.049998368	, 1.049706866	, 1.047994405	, 1.046194061	, 1.04619314	, 1.043849723	, 1.038977259	, 1.03535562	, 1.03535512	, 1.03131705	, 1.024026042	, 1.019134438	, 1.019134378	, 1.014016849	, 1.005416934	, 1.000000205	, 1.000000583	, 0.9945828128	, 0.9859830794	, 0.9808660973	, 0.980866903	, 0.9759734306	, 0.9686832219	, 0.964645184	, 0.9646463672	, 0.9610216829	, 0.9561511957	, 0.9538068892	, 0.9538083281	, 0.9520038214	, 0.9502948965	, 0.9500010843]
x2 = LinRange(0,2,128)

plot(x, w0_prim0, seriestype = :scatter)
plot!(x2, w0_final, seriestype = :scatter)